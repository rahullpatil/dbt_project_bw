{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.1", "generated_at": "2024-12-22T06:29:11.024102Z", "invocation_id": "01036c66-3c12-4961-8ae5-07af1087db4a", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-12-22T06:29:09.530944Z", "completed_at": "2024-12-22T06:29:09.543689Z"}, {"name": "execute", "started_at": "2024-12-22T06:29:09.544317Z", "completed_at": "2024-12-22T06:29:10.480901Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.9510211944580078, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b931e5-0002-4297-0007-02f200020032"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.snowflake.fct_leads", "compiled": true, "compiled_code": "\n\nWITH leads AS (\n    SELECT\n        id AS provider_id,\n        first_name,\n        last_name,\n        company,\n        street AS address1,\n        city,\n        state,\n        postal_code AS zip,\n        country,\n        email,\n        CASE \n            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE\n            ELSE FALSE\n        END AS is_converted,\n        Status, \n        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,\n        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,\n        last_activity_date,\n        last_viewed_date, \n        capacity_c,\n        lead_source,\n        title,\n        outreach_stage_c AS curriculum_type,\n        lead_source_last_updated_c AS certificate_expiration_date,\n        website,\n        brightwheel_school_uuid_c\n    FROM \"DBT_TEST\".stg.stg_salesforce_leads\n     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers\n),\n\nsource_s1 AS (\n    SELECT\n        Name AS company,\n        ADDRESS AS address2,\n         state,\n         county,\n         phone\n    FROM \"DBT_TEST\".stg.stg_source_s1\n     WHERE Name IS NOT NULL -- Validate non-null company names\n),\n\nsource_s2 AS (\n    SELECT\n        Company AS company,\n        TYPELICENSE AS license_number,\n        'Accepts Subsidy' AS accepts_financial_aid,\n        'Year Round' AS schedule,\n        'Star Level' AS facility_type,\n        'Total Cap' AS capacity,\n        'Monitoring since' AS license_issued,\n        'Monitoring since' AS license_renewed,\n        'Daytime Hours' AS operating_hours,\n        'Star Level' AS star_rating,\n        'Min Age' AS min_age,\n        'Max Age' AS max_age,\n        'Monitoring since' AS compliance_monitoring_date\n    FROM \"DBT_TEST\".stg.stg_source_s2\n    WHERE Company IS NOT NULL -- Validate non-null operation IDs\n    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values\n),\n\nsource_s3 AS (\n    SELECT  \n        Operation AS operator,\n        'Operation Name' AS company,\n        Address AS address1,\n        City AS city,\n        State AS state,\n        Zip AS zip,\n        Phone AS phone,\n        Capacity AS capacity,\n        Status AS license_status,\n        IssueDate AS license_issued_date,\n        Monitoringfrequency AS compliance_frequency,\n        'Audit Date' AS audit_date,\n        'Audit Notes' AS audit_notes\n    FROM \"DBT_TEST\".stg.stg_source_s3\n    WHERE Operation IS NOT NULL -- Validate non-null operation IDs\n)\n\n-- Final Join and Transformation\nSELECT\n    leads.provider_id,\n    leads.first_name,\n    leads.last_name,\n    leads.company,\n    leads.address1,\n    source_s1.address2,\n    leads.city,\n    leads.state,\n    leads.zip,\n    source_s1.county,\n    leads.country,\n    leads.email,\n    leads.is_converted,\n    leads.Status, \n    leads.created_date, \n    leads.last_modified_date, \n    leads.last_activity_date,\n    leads.last_viewed_date, \n    leads.capacity_c,\n    leads.lead_source,\n    leads.curriculum_type,\n    source_s2.capacity,\n    source_s2.accepts_financial_aid,\n    source_s2.schedule,\n    source_s3.phone,\n    source_s3.operator,\n    source_s3.license_status,\n    source_s2.license_number,\n    source_s2.license_issued,\n    source_s2.license_renewed,\n    source_s3.license_issued_date,\n    source_s3.compliance_frequency,\n    source_s2.operating_hours,\n    source_s2.star_rating,\n    source_s2.compliance_monitoring_date,\n    source_s2.facility_type,\n    source_s2.min_age,\n    source_s2.max_age,\n    source_s3.audit_date,\n    source_s3.audit_notes,\n    leads.certificate_expiration_date,\n    leads.website,\n    leads.brightwheel_school_uuid_c\nFROM leads\nLEFT JOIN source_s1\n    ON leads.company = source_s1.company\nLEFT JOIN source_s2\n    ON leads.company = source_s2.company\nLEFT JOIN source_s3\n    ON leads.company = source_s3.company\nWHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs", "relation_name": "DBT_TEST.STG.fct_leads", "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-22T06:29:10.486806Z", "completed_at": "2024-12-22T06:29:10.503413Z"}, {"name": "execute", "started_at": "2024-12-22T06:29:10.503865Z", "completed_at": "2024-12-22T06:29:10.695991Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.2103409767150879, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b931e5-0002-4297-0007-02f200020036"}, "message": null, "failures": 0, "unique_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect provider_id\nfrom DBT_TEST.STG.fct_leads\nwhere provider_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "pass", "timing": [{"name": "compile", "started_at": "2024-12-22T06:29:10.699695Z", "completed_at": "2024-12-22T06:29:10.727820Z"}, {"name": "execute", "started_at": "2024-12-22T06:29:10.728344Z", "completed_at": "2024-12-22T06:29:10.912959Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.21447277069091797, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b931e5-0002-429d-0007-02f200019d7a"}, "message": null, "failures": 0, "unique_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    provider_id as unique_field,\n    count(*) as n_records\n\nfrom DBT_TEST.STG.fct_leads\nwhere provider_id is not null\ngroup by provider_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 2.302212715148926, "args": {"partial_parse": true, "project_dir": "/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake", "show": false, "use_colors": true, "skip_nodes_if_on_run_start_fails": false, "log_format": "default", "vars": {}, "export_saved_queries": false, "favor_state": false, "printer_width": 80, "use_colors_file": true, "indirect_selection": "eager", "require_batched_execution_for_custom_microbatch_strategy": false, "log_format_file": "debug", "require_resource_names_without_spaces": false, "write_json": true, "log_path": "/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs", "resource_types": [], "require_explicit_package_overrides_for_builtin_materializations": true, "populate_cache": true, "select": ["fct_leads"], "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "which": "build", "macro_debugging": false, "print": true, "introspect": true, "exclude_resource_types": [], "exclude": [], "profiles_dir": "/Users/rahulpatil/.dbt", "source_freshness_run_project_hooks": false, "log_level": "info", "state_modified_compare_more_unrendered_values": false, "static_parser": true, "cache_selected_only": false, "log_level_file": "debug", "quiet": false, "log_file_max_bytes": 10485760, "invocation_command": "dbt build --select fct_leads", "strict_mode": false, "version_check": true, "empty": false, "state_modified_compare_vars": false, "show_resource_report": false, "defer": false, "require_yaml_configuration_for_mf_time_spines": false, "partial_parse_file_diff": true, "include_saved_query": false, "require_nested_cumulative_type_params": false}}