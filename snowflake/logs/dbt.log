[0m21:48:25.223512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10801b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddec00>]}


============================== 21:48:25.229851 | f42e7b21-8be5-41ff-b744-7147c5e355b3 ==============================
[0m21:48:25.229851 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:48:25.230820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m21:48:25.245726 [info ] [MainThread]: dbt version: 1.9.1
[0m21:48:25.246316 [info ] [MainThread]: python version: 3.12.5
[0m21:48:25.246819 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m21:48:25.247835 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m21:48:25.539704 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m21:48:25.540269 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m21:48:25.540787 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m21:48:25.541510 [info ] [MainThread]: adapter type: snowflake
[0m21:48:25.543540 [info ] [MainThread]: adapter version: 1.9.0
[0m21:48:25.680232 [info ] [MainThread]: Configuration:
[0m21:48:25.680899 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:48:25.681428 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:48:25.681903 [info ] [MainThread]: Required dependencies:
[0m21:48:25.682520 [debug] [MainThread]: Executing "git --help"
[0m21:48:25.741876 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:48:25.744982 [debug] [MainThread]: STDERR: "b''"
[0m21:48:25.745477 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:48:25.745917 [info ] [MainThread]: Connection:
[0m21:48:25.746478 [info ] [MainThread]:   account: ok29325.us-east-2.aws
[0m21:48:25.746918 [info ] [MainThread]:   user: rpatil
[0m21:48:25.747342 [info ] [MainThread]:   database: dbt_test
[0m21:48:25.747763 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:48:25.748194 [info ] [MainThread]:   role: accountadmin
[0m21:48:25.748645 [info ] [MainThread]:   schema: public
[0m21:48:25.749079 [info ] [MainThread]:   authenticator: None
[0m21:48:25.749492 [info ] [MainThread]:   oauth_client_id: None
[0m21:48:25.749918 [info ] [MainThread]:   query_tag: None
[0m21:48:25.750272 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:48:25.750624 [info ] [MainThread]:   host: None
[0m21:48:25.751209 [info ] [MainThread]:   port: None
[0m21:48:25.751674 [info ] [MainThread]:   proxy_host: None
[0m21:48:25.752128 [info ] [MainThread]:   proxy_port: None
[0m21:48:25.752649 [info ] [MainThread]:   protocol: None
[0m21:48:25.753074 [info ] [MainThread]:   connect_retries: 1
[0m21:48:25.753444 [info ] [MainThread]:   connect_timeout: None
[0m21:48:25.753813 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:48:25.754280 [info ] [MainThread]:   retry_all: False
[0m21:48:25.754685 [info ] [MainThread]:   insecure_mode: False
[0m21:48:25.755209 [info ] [MainThread]:   reuse_connections: True
[0m21:48:25.757204 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:48:26.103134 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:48:26.155920 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:48:26.156418 [debug] [MainThread]: On debug: select 1 as id
[0m21:48:26.156808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:26.939803 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m21:48:26.940358 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:48:26.940878 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:48:26.941380 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:48:26.941867 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ok29325.us-east-2.aws.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:48:26.944689 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.8686157, "process_in_blocks": "0", "process_kernel_time": 0.39668, "process_mem_max_rss": "123379712", "process_out_blocks": "0", "process_user_time": 2.414219}
[0m21:48:26.945904 [debug] [MainThread]: Command `dbt debug` failed at 21:48:26.945730 after 1.87 seconds
[0m21:48:26.946447 [debug] [MainThread]: Connection 'debug' was left open.
[0m21:48:26.946921 [debug] [MainThread]: On debug: No close available on handle
[0m21:48:26.947489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a88fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddee40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ddec00>]}
[0m21:48:26.948627 [debug] [MainThread]: Flushing usage events
[0m21:48:27.116705 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:53:52.003287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bb20c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680f080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680ecf0>]}


============================== 21:53:52.008198 | d1665f33-5d40-42a0-9557-ddf3e3bd241e ==============================
[0m21:53:52.008198 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:53:52.008984 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:53:52.023210 [info ] [MainThread]: Setting up your profile.
[0m21:56:05.239510 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m21:56:05.240947 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 133.37064, "process_in_blocks": "0", "process_kernel_time": 0.210949, "process_mem_max_rss": "105521152", "process_out_blocks": "0", "process_user_time": 1.689699}
[0m21:56:05.241773 [debug] [MainThread]: Command `dbt init` succeeded at 21:56:05.241561 after 133.37 seconds
[0m21:56:05.242400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10680ef30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076ba060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105bf7b30>]}
[0m21:56:05.242949 [debug] [MainThread]: Flushing usage events
[0m21:56:05.420101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:56:17.034141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642af30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10642ac90>]}


============================== 21:56:17.039308 | 56661b83-4a8b-4613-8e73-d2abb70c5d49 ==============================
[0m21:56:17.039308 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:56:17.040040 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:17.053007 [info ] [MainThread]: dbt version: 1.9.1
[0m21:56:17.053568 [info ] [MainThread]: python version: 3.12.5
[0m21:56:17.054029 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m21:56:17.054465 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m21:56:17.305122 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m21:56:17.305747 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m21:56:17.306246 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m21:56:17.306962 [info ] [MainThread]: adapter type: snowflake
[0m21:56:17.307412 [info ] [MainThread]: adapter version: 1.9.0
[0m21:56:17.424420 [info ] [MainThread]: Configuration:
[0m21:56:17.424984 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:56:17.425487 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:56:17.425922 [info ] [MainThread]: Required dependencies:
[0m21:56:17.426481 [debug] [MainThread]: Executing "git --help"
[0m21:56:17.438391 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:56:17.439565 [debug] [MainThread]: STDERR: "b''"
[0m21:56:17.440070 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:56:17.440580 [info ] [MainThread]: Connection:
[0m21:56:17.441126 [info ] [MainThread]:   account: ok29325.us-east-2.aws
[0m21:56:17.441595 [info ] [MainThread]:   user: rpatil
[0m21:56:17.442075 [info ] [MainThread]:   database: dbt_test
[0m21:56:17.442507 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:56:17.442922 [info ] [MainThread]:   role: accountadmin
[0m21:56:17.443325 [info ] [MainThread]:   schema: public
[0m21:56:17.443826 [info ] [MainThread]:   authenticator: None
[0m21:56:17.444233 [info ] [MainThread]:   oauth_client_id: None
[0m21:56:17.444626 [info ] [MainThread]:   query_tag: None
[0m21:56:17.445035 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:56:17.445411 [info ] [MainThread]:   host: None
[0m21:56:17.446004 [info ] [MainThread]:   port: None
[0m21:56:17.446620 [info ] [MainThread]:   proxy_host: None
[0m21:56:17.447048 [info ] [MainThread]:   proxy_port: None
[0m21:56:17.447469 [info ] [MainThread]:   protocol: None
[0m21:56:17.447887 [info ] [MainThread]:   connect_retries: 1
[0m21:56:17.448261 [info ] [MainThread]:   connect_timeout: None
[0m21:56:17.448652 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:56:17.449042 [info ] [MainThread]:   retry_all: False
[0m21:56:17.449432 [info ] [MainThread]:   insecure_mode: False
[0m21:56:17.449801 [info ] [MainThread]:   reuse_connections: True
[0m21:56:17.450590 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:56:17.630943 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:56:17.674021 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:56:17.674483 [debug] [MainThread]: On debug: select 1 as id
[0m21:56:17.674840 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:18.034487 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m21:56:18.034972 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m21:56:18.035426 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m21:56:18.035874 [info ] [MainThread]: [31m1 check failed:[0m
[0m21:56:18.036394 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ok29325.us-east-2.aws.snowflakecomputing.com:443. Incorrect username or password was specified.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m21:56:18.037653 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.1312362, "process_in_blocks": "0", "process_kernel_time": 0.330654, "process_mem_max_rss": "121335808", "process_out_blocks": "0", "process_user_time": 2.05797}
[0m21:56:18.038354 [debug] [MainThread]: Command `dbt debug` failed at 21:56:18.038213 after 1.13 seconds
[0m21:56:18.038769 [debug] [MainThread]: Connection 'debug' was left open.
[0m21:56:18.039125 [debug] [MainThread]: On debug: No close available on handle
[0m21:56:18.039528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107025d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a38800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d7d10>]}
[0m21:56:18.040018 [debug] [MainThread]: Flushing usage events
[0m21:56:18.193980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:58:35.963625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11168cf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116baff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116bac60>]}


============================== 21:58:35.968971 | 387d5c4a-e364-4103-84a3-4ccc4db818b9 ==============================
[0m21:58:35.968971 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:58:35.970069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:58:35.984769 [info ] [MainThread]: Setting up your profile.
[0m22:00:45.377610 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m22:00:45.378990 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 129.66473, "process_in_blocks": "0", "process_kernel_time": 0.207118, "process_mem_max_rss": "107298816", "process_out_blocks": "0", "process_user_time": 1.684012}
[0m22:00:45.379789 [debug] [MainThread]: Command `dbt init` succeeded at 22:00:45.379579 after 129.67 seconds
[0m22:00:45.380479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116baed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112869760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112762e40>]}
[0m22:00:45.381053 [debug] [MainThread]: Flushing usage events
[0m22:00:45.609715 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:00:56.716462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c57b230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d306f30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d306c90>]}


============================== 22:00:56.721735 | 736bafcc-9013-4014-a751-8431aa0b4db2 ==============================
[0m22:00:56.721735 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:00:56.722691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:00:56.736306 [info ] [MainThread]: dbt version: 1.9.1
[0m22:00:56.736932 [info ] [MainThread]: python version: 3.12.5
[0m22:00:56.737429 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m22:00:56.737890 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m22:00:56.991349 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m22:00:56.991945 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m22:00:56.992440 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m22:00:56.993255 [info ] [MainThread]: adapter type: snowflake
[0m22:00:56.993804 [info ] [MainThread]: adapter version: 1.9.0
[0m22:00:57.115756 [info ] [MainThread]: Configuration:
[0m22:00:57.116470 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:00:57.117009 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:00:57.117494 [info ] [MainThread]: Required dependencies:
[0m22:00:57.118066 [debug] [MainThread]: Executing "git --help"
[0m22:00:57.129104 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:00:57.130370 [debug] [MainThread]: STDERR: "b''"
[0m22:00:57.131098 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:00:57.131787 [info ] [MainThread]: Connection:
[0m22:00:57.132298 [info ] [MainThread]:   account: ok29325.us-east-2.aws
[0m22:00:57.132791 [info ] [MainThread]:   user: RPATIL
[0m22:00:57.133388 [info ] [MainThread]:   database: DBT_TEST
[0m22:00:57.133822 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m22:00:57.134283 [info ] [MainThread]:   role: accountadmin
[0m22:00:57.134675 [info ] [MainThread]:   schema: public
[0m22:00:57.135249 [info ] [MainThread]:   authenticator: None
[0m22:00:57.135684 [info ] [MainThread]:   oauth_client_id: None
[0m22:00:57.136068 [info ] [MainThread]:   query_tag: None
[0m22:00:57.136673 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:00:57.137182 [info ] [MainThread]:   host: None
[0m22:00:57.137793 [info ] [MainThread]:   port: None
[0m22:00:57.138375 [info ] [MainThread]:   proxy_host: None
[0m22:00:57.138848 [info ] [MainThread]:   proxy_port: None
[0m22:00:57.139261 [info ] [MainThread]:   protocol: None
[0m22:00:57.140384 [info ] [MainThread]:   connect_retries: 1
[0m22:00:57.142255 [info ] [MainThread]:   connect_timeout: None
[0m22:00:57.142905 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:00:57.143438 [info ] [MainThread]:   retry_all: False
[0m22:00:57.143933 [info ] [MainThread]:   insecure_mode: False
[0m22:00:57.146192 [info ] [MainThread]:   reuse_connections: True
[0m22:00:57.176418 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:00:57.409527 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:00:57.454409 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:00:57.454903 [debug] [MainThread]: On debug: select 1 as id
[0m22:00:57.455281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:58.043831 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:00:58.044299 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:00:58.044736 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:00:58.045186 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:00:58.045716 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ok29325.us-east-2.aws.snowflakecomputing.com:443. Duo Push is not enabled for your MFA. Provide a passcode as part of the connection string.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:00:58.046967 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.4571674, "process_in_blocks": "0", "process_kernel_time": 0.344564, "process_mem_max_rss": "122290176", "process_out_blocks": "0", "process_user_time": 2.064155}
[0m22:00:58.047671 [debug] [MainThread]: Command `dbt debug` failed at 22:00:58.047531 after 1.46 seconds
[0m22:00:58.048100 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:00:58.048462 [debug] [MainThread]: On debug: No close available on handle
[0m22:00:58.048870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d306db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d306b70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecb4350>]}
[0m22:00:58.049370 [debug] [MainThread]: Flushing usage events
[0m22:00:58.205430 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:06:45.866888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111317980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114b6db0>]}


============================== 22:06:45.871883 | 73588619-3715-4219-a3c1-f9097cf7e531 ==============================
[0m22:06:45.871883 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:06:45.872881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:06:45.887549 [info ] [MainThread]: Setting up your profile.
[0m22:08:30.996543 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m22:08:30.997955 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 105.31974, "process_in_blocks": "0", "process_kernel_time": 0.214165, "process_mem_max_rss": "105607168", "process_out_blocks": "0", "process_user_time": 1.67214}
[0m22:08:30.998812 [debug] [MainThread]: Command `dbt init` succeeded at 22:08:30.998573 after 105.32 seconds
[0m22:08:30.999400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c78470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1125d5cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114ed280>]}
[0m22:08:30.999967 [debug] [MainThread]: Flushing usage events
[0m22:08:31.240240 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:37.503363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8255b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f852ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f852d50>]}


============================== 22:08:37.508958 | 938acab0-8920-4c0e-af69-f033f0e4bae1 ==============================
[0m22:08:37.508958 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:08:37.509787 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:08:37.521893 [info ] [MainThread]: dbt version: 1.9.1
[0m22:08:37.523610 [info ] [MainThread]: python version: 3.12.5
[0m22:08:37.524907 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m22:08:37.525665 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m22:08:37.776474 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m22:08:37.777109 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m22:08:37.777612 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m22:08:37.778326 [info ] [MainThread]: adapter type: snowflake
[0m22:08:37.778789 [info ] [MainThread]: adapter version: 1.9.0
[0m22:08:37.897717 [info ] [MainThread]: Configuration:
[0m22:08:37.898351 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:08:37.898873 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:08:37.899334 [info ] [MainThread]: Required dependencies:
[0m22:08:37.899894 [debug] [MainThread]: Executing "git --help"
[0m22:08:38.044189 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:08:38.045370 [debug] [MainThread]: STDERR: "b''"
[0m22:08:38.045875 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:08:38.046332 [info ] [MainThread]: Connection:
[0m22:08:38.046893 [info ] [MainThread]:   account: ok29325.us-east-2.aws
[0m22:08:38.047335 [info ] [MainThread]:   user: dbt_user
[0m22:08:38.047771 [info ] [MainThread]:   database: dbt_test
[0m22:08:38.048180 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m22:08:38.048586 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m22:08:38.048989 [info ] [MainThread]:   schema: public
[0m22:08:38.049394 [info ] [MainThread]:   authenticator: None
[0m22:08:38.049815 [info ] [MainThread]:   oauth_client_id: None
[0m22:08:38.050234 [info ] [MainThread]:   query_tag: None
[0m22:08:38.050617 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:08:38.051058 [info ] [MainThread]:   host: None
[0m22:08:38.051611 [info ] [MainThread]:   port: None
[0m22:08:38.052157 [info ] [MainThread]:   proxy_host: None
[0m22:08:38.052640 [info ] [MainThread]:   proxy_port: None
[0m22:08:38.053088 [info ] [MainThread]:   protocol: None
[0m22:08:38.053571 [info ] [MainThread]:   connect_retries: 1
[0m22:08:38.054006 [info ] [MainThread]:   connect_timeout: None
[0m22:08:38.054437 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:08:38.054886 [info ] [MainThread]:   retry_all: False
[0m22:08:38.055334 [info ] [MainThread]:   insecure_mode: False
[0m22:08:38.055758 [info ] [MainThread]:   reuse_connections: True
[0m22:08:38.056644 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:08:38.240899 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:08:38.284573 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:08:38.285069 [debug] [MainThread]: On debug: select 1 as id
[0m22:08:38.285449 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:08:38.681706 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:08:38.682187 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:08:38.682625 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:08:38.683074 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:08:38.683601 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ok29325.us-east-2.aws.snowflakecomputing.com:443. Multi-factor authentication is required for this account. Log in to Snowsight to enroll.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:08:38.684870 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.3103247, "process_in_blocks": "0", "process_kernel_time": 0.33795, "process_mem_max_rss": "122462208", "process_out_blocks": "0", "process_user_time": 2.064951}
[0m22:08:38.685574 [debug] [MainThread]: Command `dbt debug` failed at 22:08:38.685434 after 1.31 seconds
[0m22:08:38.686003 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:08:38.686367 [debug] [MainThread]: On debug: No close available on handle
[0m22:08:38.686780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b194f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11085b740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103ae8a0>]}
[0m22:08:38.687272 [debug] [MainThread]: Flushing usage events
[0m22:08:38.849960 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:10:16.307171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb0b4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf370e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf36e70>]}


============================== 22:10:16.314301 | 1a2b9307-011d-4253-9dd9-b462eac49b0c ==============================
[0m22:10:16.314301 [info ] [MainThread]: Running with dbt=1.9.1
[0m22:10:16.315321 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m22:10:16.328591 [info ] [MainThread]: dbt version: 1.9.1
[0m22:10:16.329150 [info ] [MainThread]: python version: 3.12.5
[0m22:10:16.329682 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m22:10:16.330146 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m22:10:16.587761 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m22:10:16.588436 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m22:10:16.588985 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m22:10:16.589698 [info ] [MainThread]: adapter type: snowflake
[0m22:10:16.590163 [info ] [MainThread]: adapter version: 1.9.0
[0m22:10:16.709027 [info ] [MainThread]: Configuration:
[0m22:10:16.709676 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m22:10:16.710209 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m22:10:16.710679 [info ] [MainThread]: Required dependencies:
[0m22:10:16.711264 [debug] [MainThread]: Executing "git --help"
[0m22:10:16.722558 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m22:10:16.723661 [debug] [MainThread]: STDERR: "b''"
[0m22:10:16.724238 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m22:10:16.724742 [info ] [MainThread]: Connection:
[0m22:10:16.725302 [info ] [MainThread]:   account: ok29325.us-east-2.aws
[0m22:10:16.725756 [info ] [MainThread]:   user: dbt_user
[0m22:10:16.726193 [info ] [MainThread]:   database: dbt_test
[0m22:10:16.726637 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m22:10:16.727065 [info ] [MainThread]:   role: ACCOUNTADMIN
[0m22:10:16.727484 [info ] [MainThread]:   schema: public
[0m22:10:16.727886 [info ] [MainThread]:   authenticator: None
[0m22:10:16.728306 [info ] [MainThread]:   oauth_client_id: None
[0m22:10:16.728839 [info ] [MainThread]:   query_tag: None
[0m22:10:16.729250 [info ] [MainThread]:   client_session_keep_alive: False
[0m22:10:16.729792 [info ] [MainThread]:   host: None
[0m22:10:16.730256 [info ] [MainThread]:   port: None
[0m22:10:16.730751 [info ] [MainThread]:   proxy_host: None
[0m22:10:16.731205 [info ] [MainThread]:   proxy_port: None
[0m22:10:16.731602 [info ] [MainThread]:   protocol: None
[0m22:10:16.731991 [info ] [MainThread]:   connect_retries: 1
[0m22:10:16.732439 [info ] [MainThread]:   connect_timeout: None
[0m22:10:16.732833 [info ] [MainThread]:   retry_on_database_errors: False
[0m22:10:16.733201 [info ] [MainThread]:   retry_all: False
[0m22:10:16.733576 [info ] [MainThread]:   insecure_mode: False
[0m22:10:16.733944 [info ] [MainThread]:   reuse_connections: True
[0m22:10:16.734767 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m22:10:16.914197 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m22:10:16.959203 [debug] [MainThread]: Using snowflake connection "debug"
[0m22:10:16.959709 [debug] [MainThread]: On debug: select 1 as id
[0m22:10:16.960094 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:17.373868 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m22:10:17.374342 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m22:10:17.374785 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m22:10:17.375246 [info ] [MainThread]: [31m1 check failed:[0m
[0m22:10:17.375788 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: ok29325.us-east-2.aws.snowflakecomputing.com:443. Multi-factor authentication is required for this account. Log in to Snowsight to enroll.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m22:10:17.377068 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.2086711, "process_in_blocks": "0", "process_kernel_time": 0.34721, "process_mem_max_rss": "121094144", "process_out_blocks": "0", "process_user_time": 2.086701}
[0m22:10:17.377757 [debug] [MainThread]: Command `dbt debug` failed at 22:10:17.377618 after 1.21 seconds
[0m22:10:17.378188 [debug] [MainThread]: Connection 'debug' was left open.
[0m22:10:17.378549 [debug] [MainThread]: On debug: No close available on handle
[0m22:10:17.378969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c610800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6c4aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de39160>]}
[0m22:10:17.379460 [debug] [MainThread]: Flushing usage events
[0m22:10:17.547211 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:17:11.406768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc3cb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5b110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5aea0>]}


============================== 12:17:11.479863 | b75e9585-afcc-45fe-b2e8-6770e983647f ==============================
[0m12:17:11.479863 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:17:11.480751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt init', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:17:11.650926 [info ] [MainThread]: Setting up your profile.
[0m12:18:52.500420 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:18:52.517836 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 101.51924, "process_in_blocks": "0", "process_kernel_time": 0.454026, "process_mem_max_rss": "106565632", "process_out_blocks": "0", "process_user_time": 1.863794}
[0m12:18:52.518801 [debug] [MainThread]: Command `dbt init` succeeded at 12:18:52.518638 after 101.52 seconds
[0m12:18:52.519296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cc5afc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0b4da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dad8b90>]}
[0m12:18:52.519894 [debug] [MainThread]: Flushing usage events
[0m12:18:52.809199 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:19:21.903825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111889ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11324ad20>]}


============================== 12:19:21.908948 | 31bf65f4-e4c7-4b6b-9b1e-fe6058efcabb ==============================
[0m12:19:21.908948 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:19:21.909854 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:19:21.931509 [info ] [MainThread]: dbt version: 1.9.1
[0m12:19:21.932156 [info ] [MainThread]: python version: 3.12.5
[0m12:19:21.932674 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m12:19:21.933149 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m12:19:22.194700 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m12:19:22.195320 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m12:19:22.195856 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m12:19:22.211690 [info ] [MainThread]: adapter type: snowflake
[0m12:19:22.212346 [info ] [MainThread]: adapter version: 1.9.0
[0m12:19:22.330971 [info ] [MainThread]: Configuration:
[0m12:19:22.331604 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:19:22.332134 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:19:22.332599 [info ] [MainThread]: Required dependencies:
[0m12:19:22.333145 [debug] [MainThread]: Executing "git --help"
[0m12:19:22.724574 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:19:22.725699 [debug] [MainThread]: STDERR: "b''"
[0m12:19:22.726115 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:19:22.726564 [info ] [MainThread]: Connection:
[0m12:19:22.727207 [info ] [MainThread]:   account: rjsnibx-ig91818
[0m12:19:22.727649 [info ] [MainThread]:   user: dbt_user
[0m12:19:22.728090 [info ] [MainThread]:   database: dbt_test
[0m12:19:22.728528 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:19:22.728990 [info ] [MainThread]:   role: accountadmin
[0m12:19:22.729419 [info ] [MainThread]:   schema: dbt
[0m12:19:22.729850 [info ] [MainThread]:   authenticator: None
[0m12:19:22.730248 [info ] [MainThread]:   oauth_client_id: None
[0m12:19:22.730649 [info ] [MainThread]:   query_tag: None
[0m12:19:22.731227 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:19:22.731760 [info ] [MainThread]:   host: None
[0m12:19:22.732243 [info ] [MainThread]:   port: None
[0m12:19:22.732641 [info ] [MainThread]:   proxy_host: None
[0m12:19:22.733011 [info ] [MainThread]:   proxy_port: None
[0m12:19:22.733387 [info ] [MainThread]:   protocol: None
[0m12:19:22.733775 [info ] [MainThread]:   connect_retries: 1
[0m12:19:22.734168 [info ] [MainThread]:   connect_timeout: None
[0m12:19:22.734553 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:19:22.734939 [info ] [MainThread]:   retry_all: False
[0m12:19:22.735323 [info ] [MainThread]:   insecure_mode: False
[0m12:19:22.735973 [info ] [MainThread]:   reuse_connections: True
[0m12:19:22.736824 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m12:19:23.003893 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:19:23.190393 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:19:23.190878 [debug] [MainThread]: On debug: select 1 as id
[0m12:19:23.191238 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:19:23.730328 [debug] [MainThread]: Snowflake adapter: Error running SQL: select 1 as id
[0m12:19:23.730831 [debug] [MainThread]: Snowflake adapter: Rolling back transaction.
[0m12:19:23.731291 [info ] [MainThread]:   Connection test: [[31mERROR[0m]

[0m12:19:23.731768 [info ] [MainThread]: [31m1 check failed:[0m
[0m12:19:23.732285 [info ] [MainThread]: dbt was unable to connect to the specified database.
The database returned the following error:

  >Database Error
  250001 (08001): Failed to connect to DB: rjsnibx-ig91818.snowflakecomputing.com:443. Specified password has expired.  Password must be changed using the Snowflake web console.

Check your database credentials and try again. For more information, visit:
https://docs.getdbt.com/docs/configure-your-profile


[0m12:19:23.733677 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 1.954111, "process_in_blocks": "0", "process_kernel_time": 0.359337, "process_mem_max_rss": "121774080", "process_out_blocks": "0", "process_user_time": 2.076661}
[0m12:19:23.734384 [debug] [MainThread]: Command `dbt debug` failed at 12:19:23.734239 after 1.95 seconds
[0m12:19:23.734863 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:19:23.735255 [debug] [MainThread]: On debug: No close available on handle
[0m12:19:23.735675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a1d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145ebd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114166f00>]}
[0m12:19:23.736199 [debug] [MainThread]: Flushing usage events
[0m12:19:23.887194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:49:52.980627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105643860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753b0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10753ae40>]}


============================== 12:49:53.001295 | 8c957f79-0cb5-4c8b-987c-79c5583e834e ==============================
[0m12:49:53.001295 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:49:53.002222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt init', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:49:53.018214 [info ] [MainThread]: Setting up your profile.
[0m12:51:49.384167 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m12:51:49.385574 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 116.691, "process_in_blocks": "0", "process_kernel_time": 0.234944, "process_mem_max_rss": "105750528", "process_out_blocks": "0", "process_user_time": 1.728355}
[0m12:51:49.386287 [debug] [MainThread]: Command `dbt init` succeeded at 12:51:49.386146 after 116.69 seconds
[0m12:51:49.386742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1070c2d20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080d4c50>]}
[0m12:51:49.387201 [debug] [MainThread]: Flushing usage events
[0m12:51:49.591207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:52:15.313438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f84500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2bd0>]}


============================== 12:52:15.318743 | bb7fee9b-e355-4d6e-99e3-75348978f351 ==============================
[0m12:52:15.318743 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:52:15.319560 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m12:52:15.332835 [info ] [MainThread]: dbt version: 1.9.1
[0m12:52:15.333641 [info ] [MainThread]: python version: 3.12.5
[0m12:52:15.334171 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m12:52:15.334646 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m12:52:15.586412 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m12:52:15.587059 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m12:52:15.587594 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m12:52:15.588369 [info ] [MainThread]: adapter type: snowflake
[0m12:52:15.588835 [info ] [MainThread]: adapter version: 1.9.0
[0m12:52:15.705148 [info ] [MainThread]: Configuration:
[0m12:52:15.705755 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:52:15.706278 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:52:15.706749 [info ] [MainThread]: Required dependencies:
[0m12:52:15.707274 [debug] [MainThread]: Executing "git --help"
[0m12:52:15.763329 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:52:15.764524 [debug] [MainThread]: STDERR: "b''"
[0m12:52:15.764941 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:52:15.765493 [info ] [MainThread]: Connection:
[0m12:52:15.765985 [info ] [MainThread]:   account: rjsnibx-ig91818
[0m12:52:15.766423 [info ] [MainThread]:   user: dbt_user
[0m12:52:15.766861 [info ] [MainThread]:   database: dbt_test
[0m12:52:15.767303 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:52:15.767718 [info ] [MainThread]:   role: accountadmin
[0m12:52:15.768133 [info ] [MainThread]:   schema: dbt
[0m12:52:15.768561 [info ] [MainThread]:   authenticator: None
[0m12:52:15.769006 [info ] [MainThread]:   oauth_client_id: None
[0m12:52:15.769509 [info ] [MainThread]:   query_tag: None
[0m12:52:15.769958 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:52:15.770334 [info ] [MainThread]:   host: None
[0m12:52:15.770958 [info ] [MainThread]:   port: None
[0m12:52:15.771360 [info ] [MainThread]:   proxy_host: None
[0m12:52:15.771891 [info ] [MainThread]:   proxy_port: None
[0m12:52:15.772395 [info ] [MainThread]:   protocol: None
[0m12:52:15.772887 [info ] [MainThread]:   connect_retries: 1
[0m12:52:15.773383 [info ] [MainThread]:   connect_timeout: None
[0m12:52:15.773807 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:52:15.774223 [info ] [MainThread]:   retry_all: False
[0m12:52:15.774627 [info ] [MainThread]:   insecure_mode: False
[0m12:52:15.774994 [info ] [MainThread]:   reuse_connections: True
[0m12:52:15.775961 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m12:52:15.964326 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:52:16.065008 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:52:16.065493 [debug] [MainThread]: On debug: select 1 as id
[0m12:52:16.065859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:52:16.586892 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.521 seconds
[0m12:52:16.588088 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:52:16.588526 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:52:16.589887 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.4042873, "process_in_blocks": "0", "process_kernel_time": 0.341117, "process_mem_max_rss": "121327616", "process_out_blocks": "0", "process_user_time": 2.066293}
[0m12:52:16.590588 [debug] [MainThread]: Command `dbt debug` succeeded at 12:52:16.590446 after 1.41 seconds
[0m12:52:16.591016 [debug] [MainThread]: Connection 'debug' was left open.
[0m12:52:16.591378 [debug] [MainThread]: On debug: Close
[0m12:52:16.688528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10871c800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a07d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a841a60>]}
[0m12:52:16.689160 [debug] [MainThread]: Flushing usage events
[0m12:52:16.843403 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:56:21.423472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb30e0>]}


============================== 12:56:21.429186 | 17135df9-df66-4fb7-ad5a-8052c6380443 ==============================
[0m12:56:21.429186 [info ] [MainThread]: Running with dbt=1.9.1
[0m12:56:21.430035 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:56:22.126128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed8890>]}
[0m12:56:22.208706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bb2000>]}
[0m12:56:22.209826 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m12:56:22.516924 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m12:56:22.518299 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m12:56:22.518969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d2e70>]}
[0m12:56:24.863114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a5760>]}
[0m12:56:24.958178 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m12:56:25.010412 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m12:56:25.387247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085692b0>]}
[0m12:56:25.388314 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m12:56:25.388848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084a5d00>]}
[0m12:56:25.391120 [info ] [MainThread]: 
[0m12:56:25.391711 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:56:25.392201 [info ] [MainThread]: 
[0m12:56:25.392982 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:56:25.405832 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m12:56:25.480705 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m12:56:25.481248 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m12:56:25.481678 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:56:26.115064 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.633 seconds
[0m12:56:26.119411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_dbt)
[0m12:56:26.131772 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m12:56:26.132280 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m12:56:26.276796 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.144 seconds
[0m12:56:26.278949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10844c530>]}
[0m12:56:26.280839 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m12:56:26.281504 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m12:56:26.282185 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m12:56:26.282625 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m12:56:26.293168 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m12:56:26.323870 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m12:56:26.364912 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m12:56:26.388435 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m12:56:26.389297 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m12:56:27.227344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.838 seconds
[0m12:56:27.282503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10515f890>]}
[0m12:56:27.283600 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.98s]
[0m12:56:27.284444 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m12:56:27.286906 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m12:56:27.287965 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m12:56:27.288843 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m12:56:27.289334 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m12:56:27.292727 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m12:56:27.293506 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m12:56:27.330695 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m12:56:27.375384 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m12:56:27.376082 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m12:56:27.601028 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.224 seconds
[0m12:56:27.606370 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17135df9-df66-4fb7-ad5a-8052c6380443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109616270>]}
[0m12:56:27.607152 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m12:56:27.607911 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m12:56:27.609354 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:56:27.609707 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m12:56:27.610065 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m12:56:27.710473 [info ] [MainThread]: 
[0m12:56:27.711152 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.32 seconds (2.32s).
[0m12:56:27.712294 [debug] [MainThread]: Command end result
[0m12:56:27.774412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m12:56:27.776356 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m12:56:27.782928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m12:56:27.783423 [info ] [MainThread]: 
[0m12:56:27.783981 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:56:27.784401 [info ] [MainThread]: 
[0m12:56:27.784884 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m12:56:27.802373 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.5261474, "process_in_blocks": "0", "process_kernel_time": 0.489678, "process_mem_max_rss": "133488640", "process_out_blocks": "0", "process_user_time": 4.427727}
[0m12:56:27.803169 [debug] [MainThread]: Command `dbt run` succeeded at 12:56:27.803035 after 6.53 seconds
[0m12:56:27.806442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb2fc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106eb3260>]}
[0m12:56:27.807142 [debug] [MainThread]: Flushing usage events
[0m12:56:28.021924 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:43:15.177760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dc19310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e92b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e92b1a0>]}


============================== 14:43:15.229160 | abc12f71-36c9-4019-8113-382229c94e25 ==============================
[0m14:43:15.229160 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:43:15.230138 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m14:43:15.734157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbb07d0>]}
[0m14:43:15.806777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5f5970>]}
[0m14:43:15.807781 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:43:16.009519 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:43:16.174689 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:43:16.175156 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:43:16.219878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc73590>]}
[0m14:43:16.296713 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m14:43:16.299898 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m14:43:16.317726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdc7b00>]}
[0m14:43:16.318297 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m14:43:16.318759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc78cb0>]}
[0m14:43:16.320859 [info ] [MainThread]: 
[0m14:43:16.321367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:43:16.321842 [info ] [MainThread]: 
[0m14:43:16.322514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:43:16.328225 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m14:43:16.394204 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m14:43:16.394787 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m14:43:16.395386 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:43:17.154496 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.759 seconds
[0m14:43:17.157177 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_dbt)
[0m14:43:17.169699 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m14:43:17.170198 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m14:43:17.313708 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.143 seconds
[0m14:43:17.316950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110362060>]}
[0m14:43:17.318824 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m14:43:17.319569 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m14:43:17.320191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m14:43:17.320774 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m14:43:17.334842 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m14:43:17.379117 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m14:43:17.417955 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m14:43:17.419485 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m14:43:17.419950 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m14:43:19.589146 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.169 seconds
[0m14:43:19.616321 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dda55e0>]}
[0m14:43:19.617080 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.29s]
[0m14:43:19.617887 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m14:43:19.618854 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m14:43:19.619418 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m14:43:19.620017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m14:43:19.620427 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m14:43:19.624107 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m14:43:19.625065 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m14:43:19.650996 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m14:43:19.652466 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m14:43:19.653196 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m14:43:19.929854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.276 seconds
[0m14:43:19.932841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'abc12f71-36c9-4019-8113-382229c94e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ebef00>]}
[0m14:43:19.933521 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m14:43:19.934306 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m14:43:19.935651 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:43:19.936003 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m14:43:19.936363 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m14:43:20.091240 [info ] [MainThread]: 
[0m14:43:20.091878 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m14:43:20.092989 [debug] [MainThread]: Command end result
[0m14:43:20.118632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m14:43:20.121319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m14:43:20.128885 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m14:43:20.129357 [info ] [MainThread]: 
[0m14:43:20.130006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:43:20.130604 [info ] [MainThread]: 
[0m14:43:20.131125 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:43:20.150938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.2886133, "process_in_blocks": "0", "process_kernel_time": 0.41381, "process_mem_max_rss": "129761280", "process_out_blocks": "0", "process_user_time": 2.603494}
[0m14:43:20.151866 [debug] [MainThread]: Command `dbt run` succeeded at 14:43:20.151690 after 5.29 seconds
[0m14:43:20.152339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfeeab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104ff200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff99ac0>]}
[0m14:43:20.152781 [debug] [MainThread]: Flushing usage events
[0m14:43:20.357697 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:45:37.567440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002fd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0f2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0f080>]}


============================== 21:45:37.585304 | 0c952530-bab6-49c6-b685-50dff129d0de ==============================
[0m21:45:37.585304 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:45:37.586262 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:45:38.986143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0da30>]}
[0m21:45:39.057940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113178b00>]}
[0m21:45:39.059302 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:45:39.445540 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:45:39.643743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m21:45:39.644439 [debug] [MainThread]: Partial parsing: added file: snowflake://models/source.yml
[0m21:45:39.749687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113584aa0>]}
[0m21:45:39.843516 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m21:45:39.846956 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m21:45:39.957975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f4d10>]}
[0m21:45:39.958608 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m21:45:39.959066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c09d30>]}
[0m21:45:39.961098 [info ] [MainThread]: 
[0m21:45:39.961603 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:45:39.962018 [info ] [MainThread]: 
[0m21:45:39.962685 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:39.968843 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m21:45:40.172605 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m21:45:40.173097 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m21:45:40.173459 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:41.493927 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.320 seconds
[0m21:45:41.496731 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_dbt)
[0m21:45:41.508652 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m21:45:41.509178 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m21:45:41.778941 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.269 seconds
[0m21:45:41.782153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102699d0>]}
[0m21:45:41.783966 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m21:45:41.784589 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m21:45:41.785289 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m21:45:41.785801 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m21:45:41.795212 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m21:45:41.796300 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m21:45:41.838823 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m21:45:41.840368 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m21:45:41.840999 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:45:44.085708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.244 seconds
[0m21:45:44.120162 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101b7f20>]}
[0m21:45:44.121068 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.33s]
[0m21:45:44.121877 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m21:45:44.122819 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m21:45:44.123390 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m21:45:44.123979 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m21:45:44.124397 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m21:45:44.127499 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m21:45:44.128586 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m21:45:44.156329 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m21:45:44.157499 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m21:45:44.157925 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m21:45:44.395954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.238 seconds
[0m21:45:44.398669 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c952530-bab6-49c6-b685-50dff129d0de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145f0b00>]}
[0m21:45:44.399385 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.27s]
[0m21:45:44.400190 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m21:45:44.401594 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:44.401946 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m21:45:44.402309 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m21:45:44.558246 [info ] [MainThread]: 
[0m21:45:44.558866 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 4.60 seconds (4.60s).
[0m21:45:44.559993 [debug] [MainThread]: Command end result
[0m21:45:44.659934 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m21:45:44.661740 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m21:45:44.668133 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m21:45:44.668496 [info ] [MainThread]: 
[0m21:45:44.669040 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:45:44.669527 [info ] [MainThread]: 
[0m21:45:44.670015 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:45:44.671327 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 7.2474637, "process_in_blocks": "0", "process_kernel_time": 0.45719, "process_mem_max_rss": "130039808", "process_out_blocks": "0", "process_user_time": 2.88167}
[0m21:45:44.671984 [debug] [MainThread]: Command `dbt run` succeeded at 21:45:44.671836 after 7.25 seconds
[0m21:45:44.672466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c0e300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c24560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112da29f0>]}
[0m21:45:44.672890 [debug] [MainThread]: Flushing usage events
[0m21:45:44.863237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:22.062308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebde270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f22f530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f22f2c0>]}


============================== 21:50:22.067595 | ab72f084-f535-4176-bebb-b3fc54180eab ==============================
[0m21:50:22.067595 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:50:22.068345 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:50:22.823176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab72f084-f535-4176-bebb-b3fc54180eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11050cd40>]}
[0m21:50:22.895209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab72f084-f535-4176-bebb-b3fc54180eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d696960>]}
[0m21:50:22.896625 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:50:23.217366 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:50:23.402655 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:23.414393 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:23.457783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab72f084-f535-4176-bebb-b3fc54180eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106dc500>]}
[0m21:50:23.533820 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m21:50:23.537012 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m21:50:23.644895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab72f084-f535-4176-bebb-b3fc54180eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110aad520>]}
[0m21:50:23.645464 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m21:50:23.645906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab72f084-f535-4176-bebb-b3fc54180eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110578cb0>]}
[0m21:50:23.648222 [info ] [MainThread]: 
[0m21:50:23.648733 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:23.649181 [info ] [MainThread]: 
[0m21:50:23.649857 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:23.655415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test_dbt'
[0m21:50:23.787252 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m21:50:23.787745 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m21:50:23.788109 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:24.669673 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.882 seconds
[0m21:50:24.672608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab72f084-f535-4176-bebb-b3fc54180eab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d93a0>]}
[0m21:50:24.674107 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:24.674590 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:50:24.675221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710)
[0m21:50:24.675639 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:24.697752 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:24.698868 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:24.722398 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:24.723853 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:24.724404 [debug] [Thread-1 (]: On test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dbt_test.dbt.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:50:26.093231 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.368 seconds
[0m21:50:26.103122 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.43s]
[0m21:50:26.103918 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:26.104526 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_my_second_dbt_model_id.151b76d778
[0m21:50:26.105084 [info ] [Thread-1 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m21:50:26.105772 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_my_first_dbt_model_id.5fb22c2710, now test.snowflake.not_null_my_second_dbt_model_id.151b76d778)
[0m21:50:26.106204 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_my_second_dbt_model_id.151b76d778
[0m21:50:26.112002 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_my_second_dbt_model_id.151b76d778"
[0m21:50:26.112960 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_my_second_dbt_model_id.151b76d778
[0m21:50:26.119101 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_my_second_dbt_model_id.151b76d778"
[0m21:50:26.120480 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_my_second_dbt_model_id.151b76d778"
[0m21:50:26.121034 [debug] [Thread-1 (]: On test.snowflake.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dbt_test.dbt.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:50:27.495525 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.374 seconds
[0m21:50:27.497966 [info ] [Thread-1 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.39s]
[0m21:50:27.498754 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_my_second_dbt_model_id.151b76d778
[0m21:50:27.499213 [debug] [Thread-1 (]: Began running node test.snowflake.unique_my_first_dbt_model_id.16e066b321
[0m21:50:27.499698 [info ] [Thread-1 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:50:27.500278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_my_second_dbt_model_id.151b76d778, now test.snowflake.unique_my_first_dbt_model_id.16e066b321)
[0m21:50:27.500689 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_my_first_dbt_model_id.16e066b321
[0m21:50:27.508614 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:27.509569 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_my_first_dbt_model_id.16e066b321
[0m21:50:27.512911 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:27.514206 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:27.514642 [debug] [Thread-1 (]: On test.snowflake.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dbt_test.dbt.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:27.611139 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m21:50:27.613455 [info ] [Thread-1 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.11s]
[0m21:50:27.614235 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_my_first_dbt_model_id.16e066b321
[0m21:50:27.614690 [debug] [Thread-1 (]: Began running node test.snowflake.unique_my_second_dbt_model_id.57a0f8c493
[0m21:50:27.615156 [info ] [Thread-1 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m21:50:27.615777 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.unique_my_first_dbt_model_id.16e066b321, now test.snowflake.unique_my_second_dbt_model_id.57a0f8c493)
[0m21:50:27.616185 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_my_second_dbt_model_id.57a0f8c493
[0m21:50:27.620805 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:50:27.621967 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_my_second_dbt_model_id.57a0f8c493
[0m21:50:27.625483 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:50:27.627759 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_my_second_dbt_model_id.57a0f8c493"
[0m21:50:27.628466 [debug] [Thread-1 (]: On test.snowflake.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dbt_test.dbt.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:27.756266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.127 seconds
[0m21:50:27.758717 [info ] [Thread-1 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.14s]
[0m21:50:27.759479 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_my_second_dbt_model_id.57a0f8c493
[0m21:50:27.760898 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:27.761247 [debug] [MainThread]: Connection 'test.snowflake.unique_my_second_dbt_model_id.57a0f8c493' was left open.
[0m21:50:27.761603 [debug] [MainThread]: On test.snowflake.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m21:50:27.854136 [info ] [MainThread]: 
[0m21:50:27.854769 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m21:50:27.856224 [debug] [MainThread]: Command end result
[0m21:50:27.958998 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m21:50:27.961350 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m21:50:27.969072 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m21:50:27.969591 [info ] [MainThread]: 
[0m21:50:27.970115 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m21:50:27.970627 [info ] [MainThread]: 
[0m21:50:27.971216 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m21:50:27.971857 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:50:27.972298 [info ] [MainThread]: 
[0m21:50:27.972808 [info ] [MainThread]:   compiled code at target/compiled/snowflake/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m21:50:27.973261 [info ] [MainThread]: 
[0m21:50:27.973737 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m21:50:27.994942 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.0798697, "process_in_blocks": "0", "process_kernel_time": 0.413832, "process_mem_max_rss": "130224128", "process_out_blocks": "0", "process_user_time": 2.71364}
[0m21:50:27.995716 [debug] [MainThread]: Command `dbt test` failed at 21:50:27.995582 after 6.08 seconds
[0m21:50:27.996188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6cc110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cfc0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d543ce0>]}
[0m21:50:27.996618 [debug] [MainThread]: Flushing usage events
[0m21:50:28.207661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:50:37.564736 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d0fd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11b440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11b1d0>]}


============================== 21:50:37.569883 | df2d027b-799a-4ca2-b6b0-120621a6c10b ==============================
[0m21:50:37.569883 [info ] [MainThread]: Running with dbt=1.9.1
[0m21:50:37.570671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:37.949303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c77d970>]}
[0m21:50:38.020816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0c71a0>]}
[0m21:50:38.021943 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m21:50:38.210795 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m21:50:38.407807 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:50:38.408279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:50:38.452302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df5de80>]}
[0m21:50:38.530207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m21:50:38.533451 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m21:50:38.645080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e58a4b0>]}
[0m21:50:38.645669 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m21:50:38.646147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4c11f0>]}
[0m21:50:38.648203 [info ] [MainThread]: 
[0m21:50:38.648700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m21:50:38.649139 [info ] [MainThread]: 
[0m21:50:38.649804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:38.655473 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m21:50:38.751097 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m21:50:38.751615 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m21:50:38.751976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:39.387203 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.635 seconds
[0m21:50:39.389903 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_dbt)
[0m21:50:39.400960 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m21:50:39.401365 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m21:50:39.486972 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.085 seconds
[0m21:50:39.489745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3a4ce0>]}
[0m21:50:39.491102 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m21:50:39.491666 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m21:50:39.492246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m21:50:39.492656 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m21:50:39.501836 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m21:50:39.502767 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m21:50:39.540345 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m21:50:39.541670 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m21:50:39.542101 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m21:50:41.406313 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.864 seconds
[0m21:50:41.441678 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b26fbc0>]}
[0m21:50:41.442512 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.95s]
[0m21:50:41.443434 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m21:50:41.444333 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m21:50:41.445112 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m21:50:41.445825 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m21:50:41.446254 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m21:50:41.450202 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m21:50:41.451296 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m21:50:41.478394 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m21:50:41.479799 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m21:50:41.480537 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m21:50:41.762053 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.281 seconds
[0m21:50:41.764865 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df2d027b-799a-4ca2-b6b0-120621a6c10b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5f7020>]}
[0m21:50:41.765534 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.32s]
[0m21:50:41.766315 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m21:50:41.767643 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:41.767986 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m21:50:41.768337 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m21:50:41.875761 [info ] [MainThread]: 
[0m21:50:41.876381 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.23 seconds (3.23s).
[0m21:50:41.877465 [debug] [MainThread]: Command end result
[0m21:50:41.902935 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m21:50:41.905485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m21:50:41.912205 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m21:50:41.912633 [info ] [MainThread]: 
[0m21:50:41.913162 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:50:41.913723 [info ] [MainThread]: 
[0m21:50:41.914221 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m21:50:41.935995 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4956284, "process_in_blocks": "0", "process_kernel_time": 0.387795, "process_mem_max_rss": "130383872", "process_out_blocks": "0", "process_user_time": 2.588051}
[0m21:50:41.936807 [debug] [MainThread]: Command `dbt run` succeeded at 21:50:41.936676 after 4.50 seconds
[0m21:50:41.937269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d11ad50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e764230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bce1b20>]}
[0m21:50:41.937799 [debug] [MainThread]: Flushing usage events
[0m21:50:42.134925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:25.800589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef1e1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3f260>]}


============================== 16:43:25.839933 | 14c2ff39-6221-465e-89d3-2dadb8dda15d ==============================
[0m16:43:25.839933 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:43:25.840834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:26.894242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e3182c0>]}
[0m16:43:26.966884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2d7ad0>]}
[0m16:43:26.968171 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:43:27.216349 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:43:27.426208 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:27.426668 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:27.471758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11028d640>]}
[0m16:43:27.549159 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:43:27.573059 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:43:27.657270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c4ec0>]}
[0m16:43:27.657853 [info ] [MainThread]: Found 2 models, 4 data tests, 468 macros
[0m16:43:27.658328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104173e0>]}
[0m16:43:27.660508 [info ] [MainThread]: 
[0m16:43:27.661042 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:27.661481 [info ] [MainThread]: 
[0m16:43:27.662168 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:27.668157 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m16:43:27.872200 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m16:43:27.872690 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m16:43:27.873052 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:28.643867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 0.771 seconds
[0m16:43:28.646159 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now create_dbt_test_dbt)
[0m16:43:28.646690 [debug] [ThreadPool]: Creating schema "database: "dbt_test"
schema: "dbt"
"
[0m16:43:28.651823 [debug] [ThreadPool]: Using snowflake connection "create_dbt_test_dbt"
[0m16:43:28.652196 [debug] [ThreadPool]: On create_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "create_dbt_test_dbt"} */
create schema if not exists dbt_test.dbt
[0m16:43:28.807732 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.155 seconds
[0m16:43:28.810218 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_dbt_test_dbt, now list_dbt_test_dbt)
[0m16:43:28.822177 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m16:43:28.822814 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m16:43:28.905030 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.082 seconds
[0m16:43:28.907689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11063fdd0>]}
[0m16:43:28.909735 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m16:43:28.910402 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m16:43:28.911032 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m16:43:28.911453 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m16:43:28.921654 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m16:43:28.922636 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m16:43:28.966016 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m16:43:28.967559 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m16:43:28.968151 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:43:29.420900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.452 seconds
[0m16:43:29.461527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114093d0>]}
[0m16:43:29.462606 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.54s]
[0m16:43:29.463507 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m16:43:29.465181 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m16:43:29.465831 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m16:43:29.466454 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m16:43:29.466932 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m16:43:29.471600 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m16:43:29.472711 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m16:43:29.516235 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m16:43:29.517740 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m16:43:29.518299 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m16:43:29.769266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.250 seconds
[0m16:43:29.771828 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14c2ff39-6221-465e-89d3-2dadb8dda15d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114167b0>]}
[0m16:43:29.772497 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m16:43:29.773275 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m16:43:29.774673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:29.775018 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m16:43:29.775369 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m16:43:29.875723 [info ] [MainThread]: 
[0m16:43:29.876360 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.21 seconds (2.21s).
[0m16:43:29.877914 [debug] [MainThread]: Command end result
[0m16:43:29.913497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:43:29.915703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:43:29.922751 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:43:29.923231 [info ] [MainThread]: 
[0m16:43:29.923825 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:29.924318 [info ] [MainThread]: 
[0m16:43:29.924847 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:43:29.956586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.4390774, "process_in_blocks": "0", "process_kernel_time": 0.535095, "process_mem_max_rss": "128978944", "process_out_blocks": "0", "process_user_time": 2.825474}
[0m16:43:29.957409 [debug] [MainThread]: Command `dbt run` succeeded at 16:43:29.957273 after 4.44 seconds
[0m16:43:29.957876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef3f3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105ad7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105acf20>]}
[0m16:43:29.958304 [debug] [MainThread]: Flushing usage events
[0m16:43:30.164462 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:49:44.732030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a00e7e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02b0e0>]}


============================== 16:49:44.737235 | 9ae6b7aa-d7a8-4a7a-bb74-b9993a0e4673 ==============================
[0m16:49:44.737235 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:49:44.738011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_leads.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:49:45.247877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9ae6b7aa-d7a8-4a7a-bb74-b9993a0e4673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1b39b0>]}
[0m16:49:45.320544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9ae6b7aa-d7a8-4a7a-bb74-b9993a0e4673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109618a70>]}
[0m16:49:45.321567 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:49:45.504627 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:49:45.631988 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:49:45.632644 [debug] [MainThread]: Partial parsing: added file: snowflake://models/example/fct_leads.sql
[0m16:49:45.633150 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/source.yml
[0m16:49:46.072389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9ae6b7aa-d7a8-4a7a-bb74-b9993a0e4673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9396d0>]}
[0m16:49:46.161539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:49:46.164735 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:49:46.180945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9ae6b7aa-d7a8-4a7a-bb74-b9993a0e4673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8fab40>]}
[0m16:49:46.181515 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m16:49:46.181961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9ae6b7aa-d7a8-4a7a-bb74-b9993a0e4673', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b27e960>]}
[0m16:49:46.183942 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:49:46.184641 [debug] [MainThread]: Command end result
[0m16:49:46.207883 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:49:46.210305 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:49:46.214153 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:49:46.215462 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6064129, "process_in_blocks": "0", "process_kernel_time": 0.336042, "process_mem_max_rss": "121679872", "process_out_blocks": "0", "process_user_time": 2.65895}
[0m16:49:46.216200 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:46.216055 after 1.61 seconds
[0m16:49:46.216688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b68f590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02b3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a02aed0>]}
[0m16:49:46.217126 [debug] [MainThread]: Flushing usage events
[0m16:49:46.483575 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:09.432812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aafec60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd3470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd30e0>]}


============================== 16:50:09.437712 | 486524bc-e692-449e-9c4d-ce916b7a3c9b ==============================
[0m16:50:09.437712 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:50:09.438485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select fct_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:09.822901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '486524bc-e692-449e-9c4d-ce916b7a3c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a43e0>]}
[0m16:50:09.894441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '486524bc-e692-449e-9c4d-ce916b7a3c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109648380>]}
[0m16:50:09.895433 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:50:10.071741 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:50:10.213342 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:10.213826 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:10.267983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '486524bc-e692-449e-9c4d-ce916b7a3c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc75280>]}
[0m16:50:10.363254 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:50:10.366500 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:50:10.387382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '486524bc-e692-449e-9c4d-ce916b7a3c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6a2210>]}
[0m16:50:10.387976 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m16:50:10.388425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '486524bc-e692-449e-9c4d-ce916b7a3c9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c48c1d0>]}
[0m16:50:10.390195 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:50:10.392324 [debug] [MainThread]: Command end result
[0m16:50:10.418047 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:50:10.419967 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:50:10.423900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:50:10.425094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1188657, "process_in_blocks": "0", "process_kernel_time": 0.324414, "process_mem_max_rss": "117784576", "process_out_blocks": "0", "process_user_time": 2.308224}
[0m16:50:10.425776 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:10.425642 after 1.12 seconds
[0m16:50:10.426240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c347ec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd3320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd0b90>]}
[0m16:50:10.426663 [debug] [MainThread]: Flushing usage events
[0m16:50:10.621416 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:26.008449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100ccb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f3080>]}


============================== 16:50:26.013563 | 206345ea-d64a-49d1-b314-8b1880170be8 ==============================
[0m16:50:26.013563 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:50:26.014374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:50:26.413415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100a7680>]}
[0m16:50:26.484280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc11f0>]}
[0m16:50:26.485287 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:50:26.665573 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:50:26.803458 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:50:26.803920 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:50:26.856082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11145f770>]}
[0m16:50:26.948548 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:50:26.951761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:50:26.967628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117ba1e0>]}
[0m16:50:26.968203 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m16:50:26.968684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117afb00>]}
[0m16:50:26.970774 [info ] [MainThread]: 
[0m16:50:26.971273 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:50:26.971715 [info ] [MainThread]: 
[0m16:50:26.972394 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:50:26.978209 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m16:50:27.047635 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m16:50:27.048162 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m16:50:27.048566 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:50:27.684749 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.636 seconds
[0m16:50:27.687550 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_dbt)
[0m16:50:27.698828 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m16:50:27.699240 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m16:50:27.817178 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.117 seconds
[0m16:50:27.820016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112f3230>]}
[0m16:50:27.821405 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m16:50:27.821973 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m16:50:27.822605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m16:50:27.823033 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m16:50:27.831985 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m16:50:27.832890 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m16:50:27.871470 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m16:50:27.872905 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m16:50:27.873350 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:50:28.593401 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.720 seconds
[0m16:50:28.619841 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f52d5b0>]}
[0m16:50:28.620576 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.80s]
[0m16:50:28.621407 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m16:50:28.622315 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m16:50:28.622874 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m16:50:28.623465 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m16:50:28.623879 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m16:50:28.626803 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m16:50:28.627667 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m16:50:28.657447 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m16:50:28.659059 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m16:50:28.659722 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m16:50:28.865262 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m16:50:28.868040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '206345ea-d64a-49d1-b314-8b1880170be8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127c4fe0>]}
[0m16:50:28.868718 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.24s]
[0m16:50:28.869508 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m16:50:28.870847 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:50:28.871197 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m16:50:28.871562 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m16:50:29.031491 [info ] [MainThread]: 
[0m16:50:29.032061 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.06 seconds (2.06s).
[0m16:50:29.033245 [debug] [MainThread]: Command end result
[0m16:50:29.062131 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:50:29.064086 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:50:29.071193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:50:29.071662 [info ] [MainThread]: 
[0m16:50:29.072238 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:50:29.072746 [info ] [MainThread]: 
[0m16:50:29.073245 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:50:29.074507 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1927993, "process_in_blocks": "0", "process_kernel_time": 0.365006, "process_mem_max_rss": "127926272", "process_out_blocks": "0", "process_user_time": 2.614336}
[0m16:50:29.075259 [debug] [MainThread]: Command `dbt run` succeeded at 16:50:29.075112 after 3.19 seconds
[0m16:50:29.075766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100f2c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111206030>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111206120>]}
[0m16:50:29.076196 [debug] [MainThread]: Flushing usage events
[0m16:50:29.266330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:20.545146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0c6ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c17f260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c17ef90>]}


============================== 16:52:20.550319 | 80715411-4eff-4f20-aa69-23e18b2dfe3c ==============================
[0m16:52:20.550319 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:52:20.551046 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:52:20.950876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d3680>]}
[0m16:52:21.022704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a9730>]}
[0m16:52:21.023835 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:52:21.204779 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:52:21.343450 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:21.343910 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:21.395774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4e7f20>]}
[0m16:52:21.489543 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:52:21.492766 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:52:21.509280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d84e210>]}
[0m16:52:21.509867 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m16:52:21.510328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d838380>]}
[0m16:52:21.512462 [info ] [MainThread]: 
[0m16:52:21.512939 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:52:21.513383 [info ] [MainThread]: 
[0m16:52:21.514064 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:52:21.520109 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_test'
[0m16:52:21.581305 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test"
[0m16:52:21.581826 [debug] [ThreadPool]: On list_dbt_test: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test"} */
show terse schemas in database dbt_test
    limit 10000
[0m16:52:21.582207 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:22.118909 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m16:52:22.121681 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dbt_test, now list_dbt_test_dbt)
[0m16:52:22.133055 [debug] [ThreadPool]: Using snowflake connection "list_dbt_test_dbt"
[0m16:52:22.133483 [debug] [ThreadPool]: On list_dbt_test_dbt: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_test_dbt"} */
show objects in dbt_test.dbt limit 10000;
[0m16:52:22.261934 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.128 seconds
[0m16:52:22.264645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1f8620>]}
[0m16:52:22.266039 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m16:52:22.266599 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt.my_first_dbt_model ............................ [RUN]
[0m16:52:22.267203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dbt_test_dbt, now model.snowflake.my_first_dbt_model)
[0m16:52:22.267618 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m16:52:22.276831 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m16:52:22.277852 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m16:52:22.315585 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m16:52:22.316986 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m16:52:22.317434 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table dbt_test.dbt.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:52:22.901218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m16:52:22.927901 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a427c20>]}
[0m16:52:22.928689 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.66s]
[0m16:52:22.929499 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m16:52:22.930299 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m16:52:22.931227 [info ] [Thread-1 (]: 2 of 2 START sql view model dbt.my_second_dbt_model ............................ [RUN]
[0m16:52:22.931974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m16:52:22.932405 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m16:52:22.935884 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m16:52:22.936863 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m16:52:22.965643 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m16:52:22.966949 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m16:52:22.967419 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view dbt_test.dbt.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from dbt_test.dbt.my_first_dbt_model
where id = 1
  );
[0m16:52:23.167142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.199 seconds
[0m16:52:23.169954 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '80715411-4eff-4f20-aa69-23e18b2dfe3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e713f80>]}
[0m16:52:23.170633 [info ] [Thread-1 (]: 2 of 2 OK created sql view model dbt.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.24s]
[0m16:52:23.171418 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m16:52:23.172781 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:23.173129 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m16:52:23.173490 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m16:52:23.288740 [info ] [MainThread]: 
[0m16:52:23.289380 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.77 seconds (1.77s).
[0m16:52:23.290472 [debug] [MainThread]: Command end result
[0m16:52:23.317108 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:52:23.319558 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:52:23.326646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:52:23.327205 [info ] [MainThread]: 
[0m16:52:23.327867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:23.328430 [info ] [MainThread]: 
[0m16:52:23.328991 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:52:23.330243 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.9116347, "process_in_blocks": "0", "process_kernel_time": 0.364229, "process_mem_max_rss": "129384448", "process_out_blocks": "0", "process_user_time": 2.598248}
[0m16:52:23.330925 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:23.330793 after 2.91 seconds
[0m16:52:23.331465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c17ef60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c17ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d29e210>]}
[0m16:52:23.331910 [debug] [MainThread]: Flushing usage events
[0m16:52:23.534573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:37.965762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10614ce60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061773b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106177140>]}


============================== 16:52:37.970855 | ad74cb28-99d9-4884-b01b-452d88a0b022 ==============================
[0m16:52:37.970855 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:52:37.971637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select fct_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:52:38.345802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad74cb28-99d9-4884-b01b-452d88a0b022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107197a70>]}
[0m16:52:38.416128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad74cb28-99d9-4884-b01b-452d88a0b022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072323f0>]}
[0m16:52:38.417112 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:52:38.595825 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:52:38.736613 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:38.737099 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:38.790065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad74cb28-99d9-4884-b01b-452d88a0b022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074deba0>]}
[0m16:52:38.883182 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:52:38.886507 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:52:38.902638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad74cb28-99d9-4884-b01b-452d88a0b022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10783a300>]}
[0m16:52:38.903202 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m16:52:38.903661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad74cb28-99d9-4884-b01b-452d88a0b022', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107167c80>]}
[0m16:52:38.905355 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:52:38.907430 [debug] [MainThread]: Command end result
[0m16:52:38.932312 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:52:38.934304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:52:38.937932 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:52:38.939315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1009637, "process_in_blocks": "0", "process_kernel_time": 0.326273, "process_mem_max_rss": "117239808", "process_out_blocks": "0", "process_user_time": 2.311373}
[0m16:52:38.940176 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:38.939994 after 1.10 seconds
[0m16:52:38.940787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061252b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077fbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055b3020>]}
[0m16:52:38.941299 [debug] [MainThread]: Flushing usage events
[0m16:52:39.144765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:08.418741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103bbe060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1033389b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458ac90>]}


============================== 16:54:08.423697 | f83e98e4-46c0-4d68-bb96-83c99d81ebc9 ==============================
[0m16:54:08.423697 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:54:08.424447 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt init', 'send_anonymous_usage_stats': 'True'}
[0m16:54:08.460184 [info ] [MainThread]: Setting up your profile.
[0m16:57:35.902180 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m16:57:35.903630 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 207.61784, "process_in_blocks": "0", "process_kernel_time": 0.207645, "process_mem_max_rss": "106016768", "process_out_blocks": "0", "process_user_time": 1.688209}
[0m16:57:35.904349 [debug] [MainThread]: Command `dbt init` succeeded at 16:57:35.904206 after 207.62 seconds
[0m16:57:35.904823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057f5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103da8740>]}
[0m16:57:35.905301 [debug] [MainThread]: Flushing usage events
[0m16:57:36.124442 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:44.935981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11007d970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110707140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110706ed0>]}


============================== 16:57:44.940966 | f2c9b1d6-9856-4463-a25a-6e9118c11be9 ==============================
[0m16:57:44.940966 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:57:44.941709 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m16:57:44.976690 [info ] [MainThread]: dbt version: 1.9.1
[0m16:57:44.977218 [info ] [MainThread]: python version: 3.12.5
[0m16:57:44.977731 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m16:57:44.978165 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m16:57:45.221997 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m16:57:45.222580 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m16:57:45.223057 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m16:57:45.223757 [info ] [MainThread]: adapter type: snowflake
[0m16:57:45.224198 [info ] [MainThread]: adapter version: 1.9.0
[0m16:57:45.339870 [info ] [MainThread]: Configuration:
[0m16:57:45.340535 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:57:45.341005 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:57:45.341468 [info ] [MainThread]: Required dependencies:
[0m16:57:45.342017 [debug] [MainThread]: Executing "git --help"
[0m16:57:45.369354 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:57:45.370569 [debug] [MainThread]: STDERR: "b''"
[0m16:57:45.370985 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:57:45.371436 [info ] [MainThread]: Connection:
[0m16:57:45.372017 [info ] [MainThread]:   account: rjsnibx-ig91818
[0m16:57:45.372459 [info ] [MainThread]:   user: dbt_user
[0m16:57:45.372898 [info ] [MainThread]:   database: DBT_TEST
[0m16:57:45.373408 [info ] [MainThread]:   warehouse: CUSTOM_WH
[0m16:57:45.373985 [info ] [MainThread]:   role: accountadmin
[0m16:57:45.374446 [info ] [MainThread]:   schema: STG
[0m16:57:45.374877 [info ] [MainThread]:   authenticator: None
[0m16:57:45.375290 [info ] [MainThread]:   oauth_client_id: None
[0m16:57:45.375697 [info ] [MainThread]:   query_tag: None
[0m16:57:45.376126 [info ] [MainThread]:   client_session_keep_alive: False
[0m16:57:45.376503 [info ] [MainThread]:   host: None
[0m16:57:45.377085 [info ] [MainThread]:   port: None
[0m16:57:45.377524 [info ] [MainThread]:   proxy_host: None
[0m16:57:45.378023 [info ] [MainThread]:   proxy_port: None
[0m16:57:45.378457 [info ] [MainThread]:   protocol: None
[0m16:57:45.378909 [info ] [MainThread]:   connect_retries: 1
[0m16:57:45.379396 [info ] [MainThread]:   connect_timeout: None
[0m16:57:45.379826 [info ] [MainThread]:   retry_on_database_errors: False
[0m16:57:45.380198 [info ] [MainThread]:   retry_all: False
[0m16:57:45.380640 [info ] [MainThread]:   insecure_mode: False
[0m16:57:45.381165 [info ] [MainThread]:   reuse_connections: True
[0m16:57:45.382094 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:57:45.584196 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m16:57:45.627107 [debug] [MainThread]: Using snowflake connection "debug"
[0m16:57:45.627594 [debug] [MainThread]: On debug: select 1 as id
[0m16:57:45.627964 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:46.098313 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.470 seconds
[0m16:57:46.099570 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:57:46.100039 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:57:46.101380 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.3226053, "process_in_blocks": "0", "process_kernel_time": 0.333783, "process_mem_max_rss": "121503744", "process_out_blocks": "0", "process_user_time": 2.033933}
[0m16:57:46.102074 [debug] [MainThread]: Command `dbt debug` succeeded at 16:57:46.101935 after 1.32 seconds
[0m16:57:46.102497 [debug] [MainThread]: Connection 'debug' was left open.
[0m16:57:46.102867 [debug] [MainThread]: On debug: Close
[0m16:57:46.221870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdb4080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105c44d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11035fb00>]}
[0m16:57:46.222503 [debug] [MainThread]: Flushing usage events
[0m16:57:46.375183 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:54.226383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622dac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dab380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dab110>]}


============================== 16:57:54.231722 | 5d721331-aa92-42b0-9f98-e8da32d8825a ==============================
[0m16:57:54.231722 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:57:54.232489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:57:54.698047 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e8be30>]}
[0m16:57:54.769225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dc0470>]}
[0m16:57:54.770224 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:57:54.949854 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:57:55.059052 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m16:57:55.059733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068e0200>]}
[0m16:57:56.655299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e86cf0>]}
[0m16:57:56.743017 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:57:56.746113 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:57:56.761382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085d9eb0>]}
[0m16:57:56.761945 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m16:57:56.762382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108289280>]}
[0m16:57:56.764591 [info ] [MainThread]: 
[0m16:57:56.765103 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:57:56.765550 [info ] [MainThread]: 
[0m16:57:56.766199 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:57:56.772091 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m16:57:56.833617 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m16:57:56.834107 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m16:57:56.834460 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:57.308961 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.474 seconds
[0m16:57:57.311723 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m16:57:57.322946 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m16:57:57.323381 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m16:57:57.416530 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.093 seconds
[0m16:57:57.420090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804cce0>]}
[0m16:57:57.421409 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m16:57:57.421999 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m16:57:57.422599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m16:57:57.423010 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m16:57:57.432182 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m16:57:57.433177 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m16:57:57.472306 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m16:57:57.473651 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m16:57:57.474110 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:57:57.741898 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92a81-0002-4299-0007-02f200013d0e
[0m16:57:57.742455 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.

[0m16:57:57.757153 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/snowflake/models/example/my_first_dbt_model.sql
[0m16:57:57.759154 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5d721331-aa92-42b0-9f98-e8da32d8825a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084fba40>]}
[0m16:57:57.759865 [error] [Thread-1 (]: 1 of 2 ERROR creating sql table model STG.my_first_dbt_model ................... [[31mERROR[0m in 0.34s]
[0m16:57:57.760752 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m16:57:57.761387 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.my_first_dbt_model' to be skipped because of status 'error'.  Reason: Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/snowflake/models/example/my_first_dbt_model.sql.
[0m16:57:57.762960 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m16:57:57.763462 [info ] [Thread-1 (]: 2 of 2 SKIP relation STG.my_second_dbt_model ................................... [[33mSKIP[0m]
[0m16:57:57.764028 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m16:57:57.765359 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:57.765878 [debug] [MainThread]: Connection 'model.snowflake.my_first_dbt_model' was left open.
[0m16:57:57.766277 [debug] [MainThread]: On model.snowflake.my_first_dbt_model: Close
[0m16:57:57.871775 [info ] [MainThread]: 
[0m16:57:57.872385 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m16:57:57.873431 [debug] [MainThread]: Command end result
[0m16:57:57.912703 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:57:57.914771 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:57:57.921261 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:57:57.921703 [info ] [MainThread]: 
[0m16:57:57.922248 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:57.922769 [info ] [MainThread]: 
[0m16:57:57.923303 [error] [MainThread]:   Database Error in model my_first_dbt_model (models/example/my_first_dbt_model.sql)
  000606 (57P03): No active warehouse selected in the current session.  Select an active warehouse with the 'use warehouse' command.
  
  compiled code at target/run/snowflake/models/example/my_first_dbt_model.sql
[0m16:57:57.923850 [info ] [MainThread]: 
[0m16:57:57.924345 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=1 TOTAL=2
[0m16:57:57.925665 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.826886, "process_in_blocks": "0", "process_kernel_time": 0.373873, "process_mem_max_rss": "135864320", "process_out_blocks": "0", "process_user_time": 4.029903}
[0m16:57:57.926329 [debug] [MainThread]: Command `dbt run` failed at 16:57:57.926194 after 3.83 seconds
[0m16:57:57.926797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108294ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b655b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109573e00>]}
[0m16:57:57.927228 [debug] [MainThread]: Flushing usage events
[0m16:57:58.113058 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:47.340785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afd1dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeb8680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afeede0>]}


============================== 17:05:47.345942 | ec200f5c-b627-4f05-9295-9280dabf5904 ==============================
[0m17:05:47.345942 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:05:47.346901 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt init', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:47.362497 [info ] [MainThread]: Setting up your profile.
[0m17:07:34.890445 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m17:07:34.891857 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 107.681564, "process_in_blocks": "0", "process_kernel_time": 0.227581, "process_mem_max_rss": "106487808", "process_out_blocks": "0", "process_user_time": 1.691182}
[0m17:07:34.892591 [debug] [MainThread]: Command `dbt init` succeeded at 17:07:34.892421 after 107.68 seconds
[0m17:07:34.893099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aca4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a917fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa52330>]}
[0m17:07:34.893620 [debug] [MainThread]: Flushing usage events
[0m17:07:35.080409 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:42.370691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10840fd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1084e7bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c66c00>]}


============================== 17:07:42.376157 | 7cb6bf25-04a9-42b8-a581-930ff6964541 ==============================
[0m17:07:42.376157 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:07:42.377072 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m17:07:42.391559 [info ] [MainThread]: dbt version: 1.9.1
[0m17:07:42.392282 [info ] [MainThread]: python version: 3.12.5
[0m17:07:42.392780 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m17:07:42.393243 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m17:07:42.641302 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m17:07:42.641901 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m17:07:42.642371 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m17:07:42.643075 [info ] [MainThread]: adapter type: snowflake
[0m17:07:42.643518 [info ] [MainThread]: adapter version: 1.9.0
[0m17:07:42.759663 [info ] [MainThread]: Configuration:
[0m17:07:42.760207 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:07:42.760718 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:07:42.761162 [info ] [MainThread]: Required dependencies:
[0m17:07:42.761709 [debug] [MainThread]: Executing "git --help"
[0m17:07:42.771987 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:07:42.773438 [debug] [MainThread]: STDERR: "b''"
[0m17:07:42.773961 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:07:42.774489 [info ] [MainThread]: Connection:
[0m17:07:42.775038 [info ] [MainThread]:   account: rjsnibx-ig91818
[0m17:07:42.775472 [info ] [MainThread]:   user: dbt_user
[0m17:07:42.775923 [info ] [MainThread]:   database: dbt_tes
[0m17:07:42.776366 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:07:42.776833 [info ] [MainThread]:   role: accountadmin
[0m17:07:42.777274 [info ] [MainThread]:   schema: stg
[0m17:07:42.777690 [info ] [MainThread]:   authenticator: None
[0m17:07:42.778123 [info ] [MainThread]:   oauth_client_id: None
[0m17:07:42.778556 [info ] [MainThread]:   query_tag: None
[0m17:07:42.778972 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:07:42.779399 [info ] [MainThread]:   host: None
[0m17:07:42.779853 [info ] [MainThread]:   port: None
[0m17:07:42.780295 [info ] [MainThread]:   proxy_host: None
[0m17:07:42.780681 [info ] [MainThread]:   proxy_port: None
[0m17:07:42.781140 [info ] [MainThread]:   protocol: None
[0m17:07:42.781624 [info ] [MainThread]:   connect_retries: 1
[0m17:07:42.782156 [info ] [MainThread]:   connect_timeout: None
[0m17:07:42.782579 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:07:42.782959 [info ] [MainThread]:   retry_all: False
[0m17:07:42.783337 [info ] [MainThread]:   insecure_mode: False
[0m17:07:42.783713 [info ] [MainThread]:   reuse_connections: True
[0m17:07:42.784554 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:07:42.967553 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:07:43.011115 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:07:43.011629 [debug] [MainThread]: On debug: select 1 as id
[0m17:07:43.012033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:43.503916 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.492 seconds
[0m17:07:43.505125 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:07:43.505589 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:07:43.506944 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2607492, "process_in_blocks": "0", "process_kernel_time": 0.33326, "process_mem_max_rss": "121798656", "process_out_blocks": "0", "process_user_time": 2.052897}
[0m17:07:43.507649 [debug] [MainThread]: Command `dbt debug` succeeded at 17:07:43.507506 after 1.26 seconds
[0m17:07:43.508082 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:07:43.508453 [debug] [MainThread]: On debug: Close
[0m17:07:43.621007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108812990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dbe900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a8bf0>]}
[0m17:07:43.621656 [debug] [MainThread]: Flushing usage events
[0m17:07:43.774237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:50.517367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc88c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecf260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ecee40>]}


============================== 17:07:50.522399 | 1f96e9f1-36c5-47dc-a05c-e411c93516ed ==============================
[0m17:07:50.522399 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:07:50.523157 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:07:50.932555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1f96e9f1-36c5-47dc-a05c-e411c93516ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f9a120>]}
[0m17:07:51.003449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1f96e9f1-36c5-47dc-a05c-e411c93516ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d49820>]}
[0m17:07:51.004465 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:07:51.192919 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:07:51.305407 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:07:51.306050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1f96e9f1-36c5-47dc-a05c-e411c93516ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11215a120>]}
[0m17:07:52.864465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f96e9f1-36c5-47dc-a05c-e411c93516ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112581b50>]}
[0m17:07:52.952531 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:07:52.955584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:07:52.970938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1f96e9f1-36c5-47dc-a05c-e411c93516ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271e1b0>]}
[0m17:07:52.971491 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m17:07:52.971933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1f96e9f1-36c5-47dc-a05c-e411c93516ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d0590>]}
[0m17:07:52.974105 [info ] [MainThread]: 
[0m17:07:52.974591 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:52.975036 [info ] [MainThread]: 
[0m17:07:52.975682 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:52.981210 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dbt_tes'
[0m17:07:53.043230 [debug] [ThreadPool]: Using snowflake connection "list_dbt_tes"
[0m17:07:53.043715 [debug] [ThreadPool]: On list_dbt_tes: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_dbt_tes"} */
show terse schemas in database dbt_tes
    limit 10000
[0m17:07:53.044072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:53.652107 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01b92a8b-0002-431d-0007-02f2000182ae
[0m17:07:53.652607 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m17:07:53.653093 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_schemas
[0m17:07:53.653450 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m17:07:53.654261 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:53.654610 [debug] [MainThread]: Connection 'list_dbt_tes' was left open.
[0m17:07:53.654962 [debug] [MainThread]: On list_dbt_tes: Close
[0m17:07:53.746282 [info ] [MainThread]: 
[0m17:07:53.746867 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m17:07:53.747469 [error] [MainThread]: Encountered an error:
Runtime Error
  Database error while listing schemas in database "dbt_tes"
  Database Error
    002043 (02000): SQL compilation error:
    Object does not exist, or operation cannot be performed.
[0m17:07:53.748698 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 3.362434, "process_in_blocks": "0", "process_kernel_time": 0.368493, "process_mem_max_rss": "133033984", "process_out_blocks": "0", "process_user_time": 3.885843}
[0m17:07:53.749576 [debug] [MainThread]: Command `dbt run` failed at 17:07:53.749420 after 3.36 seconds
[0m17:07:53.750084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fed2f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11271d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111cee2a0>]}
[0m17:07:53.750553 [debug] [MainThread]: Flushing usage events
[0m17:07:53.942101 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:08:21.159559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10949fb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b30ecc0>]}


============================== 17:08:21.165008 | 108d3762-c2c8-45af-b113-d346a2727afe ==============================
[0m17:08:21.165008 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:08:21.166207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt init', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:08:21.181861 [info ] [MainThread]: Setting up your profile.
[0m17:09:38.702610 [info ] [MainThread]: Profile snowflake written to /Users/rahulpatil/.dbt/profiles.yml using target's profile_template.yml and your supplied values. Run 'dbt debug' to validate the connection.
[0m17:09:38.703953 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 77.70379, "process_in_blocks": "0", "process_kernel_time": 0.207696, "process_mem_max_rss": "103809024", "process_out_blocks": "0", "process_user_time": 1.686872}
[0m17:09:38.704743 [debug] [MainThread]: Command `dbt init` succeeded at 17:09:38.704545 after 77.70 seconds
[0m17:09:38.705388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a927a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c399ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0855b0>]}
[0m17:09:38.705895 [debug] [MainThread]: Flushing usage events
[0m17:09:38.877574 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:46.316878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f0d400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644b050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644ade0>]}


============================== 17:09:46.322137 | 3d02a3a1-8df0-4cdd-a172-6f919b288812 ==============================
[0m17:09:46.322137 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:09:46.322967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:09:46.336093 [info ] [MainThread]: dbt version: 1.9.1
[0m17:09:46.337187 [info ] [MainThread]: python version: 3.12.5
[0m17:09:46.337781 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m17:09:46.338271 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m17:09:46.592910 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m17:09:46.593520 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m17:09:46.594043 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m17:09:46.594751 [info ] [MainThread]: adapter type: snowflake
[0m17:09:46.595212 [info ] [MainThread]: adapter version: 1.9.0
[0m17:09:46.717754 [info ] [MainThread]: Configuration:
[0m17:09:46.718385 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:09:46.718883 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:09:46.719352 [info ] [MainThread]: Required dependencies:
[0m17:09:46.719939 [debug] [MainThread]: Executing "git --help"
[0m17:09:46.731668 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:09:46.733540 [debug] [MainThread]: STDERR: "b''"
[0m17:09:46.734255 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:09:46.735056 [info ] [MainThread]: Connection:
[0m17:09:46.735701 [info ] [MainThread]:   account: rjsnibx-ig91818
[0m17:09:46.736181 [info ] [MainThread]:   user: DBT_USER
[0m17:09:46.736639 [info ] [MainThread]:   database: DBT_TEST
[0m17:09:46.737078 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:09:46.737524 [info ] [MainThread]:   role: accountadmin
[0m17:09:46.737990 [info ] [MainThread]:   schema: STG
[0m17:09:46.738511 [info ] [MainThread]:   authenticator: None
[0m17:09:46.738926 [info ] [MainThread]:   oauth_client_id: None
[0m17:09:46.739329 [info ] [MainThread]:   query_tag: None
[0m17:09:46.739740 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:09:46.740332 [info ] [MainThread]:   host: None
[0m17:09:46.740802 [info ] [MainThread]:   port: None
[0m17:09:46.741299 [info ] [MainThread]:   proxy_host: None
[0m17:09:46.741830 [info ] [MainThread]:   proxy_port: None
[0m17:09:46.742267 [info ] [MainThread]:   protocol: None
[0m17:09:46.742673 [info ] [MainThread]:   connect_retries: 1
[0m17:09:46.743142 [info ] [MainThread]:   connect_timeout: None
[0m17:09:46.743558 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:09:46.743971 [info ] [MainThread]:   retry_all: False
[0m17:09:46.744495 [info ] [MainThread]:   insecure_mode: False
[0m17:09:46.745045 [info ] [MainThread]:   reuse_connections: True
[0m17:09:46.745974 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:09:46.931890 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:09:46.974900 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:09:46.975398 [debug] [MainThread]: On debug: select 1 as id
[0m17:09:46.975789 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:47.844405 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.869 seconds
[0m17:09:47.845611 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:09:47.846077 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:09:47.847477 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.6611648, "process_in_blocks": "0", "process_kernel_time": 0.339308, "process_mem_max_rss": "122028032", "process_out_blocks": "0", "process_user_time": 2.095935}
[0m17:09:47.848223 [debug] [MainThread]: Command `dbt debug` succeeded at 17:09:47.848081 after 1.66 seconds
[0m17:09:47.848659 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:09:47.849034 [debug] [MainThread]: On debug: Close
[0m17:09:47.961333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077908c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644ae70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10644b050>]}
[0m17:09:47.961971 [debug] [MainThread]: Flushing usage events
[0m17:09:48.114661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:31.335752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f063c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4ee40>]}


============================== 17:10:31.342875 | be4e995b-7e29-4db2-b918-edec68ce9718 ==============================
[0m17:10:31.342875 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:10:31.343830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:10:31.808267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107da74a0>]}
[0m17:10:31.881345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e6f0b0>]}
[0m17:10:31.882457 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:10:32.076640 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:10:32.188869 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:10:32.189588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081161e0>]}
[0m17:10:33.747666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081bf620>]}
[0m17:10:33.836834 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:10:33.839923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:10:33.855669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d95b0>]}
[0m17:10:33.856229 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m17:10:33.856704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ffbe30>]}
[0m17:10:33.859034 [info ] [MainThread]: 
[0m17:10:33.859505 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:33.859915 [info ] [MainThread]: 
[0m17:10:33.860553 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:10:33.866605 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:10:33.930465 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:10:33.930953 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:10:33.931303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:34.401619 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.470 seconds
[0m17:10:34.404397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:10:34.415442 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:10:34.415854 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:10:34.531055 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.115 seconds
[0m17:10:34.534593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f42f0>]}
[0m17:10:34.535951 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:10:34.536508 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:10:34.537114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:10:34.537530 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:10:34.546550 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:10:34.565830 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:10:34.602499 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:10:34.603847 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:10:34.604292 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:10:35.299447 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.695 seconds
[0m17:10:35.327052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fb9550>]}
[0m17:10:35.327800 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.79s]
[0m17:10:35.328593 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:10:35.329494 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:10:35.330059 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:10:35.330652 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:10:35.331065 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:10:35.334049 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:10:35.334981 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:10:35.361527 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:10:35.370287 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:10:35.371033 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:10:35.547961 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.176 seconds
[0m17:10:35.550790 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be4e995b-7e29-4db2-b918-edec68ce9718', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109255250>]}
[0m17:10:35.551490 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.22s]
[0m17:10:35.552284 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:10:35.553727 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:35.554083 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:10:35.554436 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:10:35.682477 [info ] [MainThread]: 
[0m17:10:35.683086 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 1.82 seconds (1.82s).
[0m17:10:35.684356 [debug] [MainThread]: Command end result
[0m17:10:35.709041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:10:35.711376 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:10:35.718807 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:10:35.719416 [info ] [MainThread]: 
[0m17:10:35.719985 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:35.720493 [info ] [MainThread]: 
[0m17:10:35.720954 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:10:35.722220 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.5204797, "process_in_blocks": "0", "process_kernel_time": 0.397988, "process_mem_max_rss": "134660096", "process_out_blocks": "0", "process_user_time": 4.119776}
[0m17:10:35.722947 [debug] [MainThread]: Command `dbt run` succeeded at 17:10:35.722797 after 4.52 seconds
[0m17:10:35.723460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081d4440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e9e5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083de330>]}
[0m17:10:35.723904 [debug] [MainThread]: Flushing usage events
[0m17:10:35.910675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:22:01.794551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d50b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d28fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d77140>]}


============================== 17:22:01.834121 | d4f718b8-fddb-4203-9296-37da049a0a87 ==============================
[0m17:22:01.834121 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:22:01.835073 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:22:02.429642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111838b60>]}
[0m17:22:02.500375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d751c0>]}
[0m17:22:02.501385 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:22:02.682065 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:22:02.848319 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m17:22:02.848989 [debug] [MainThread]: Partial parsing: added file: snowflake://models/fct_leads.sql
[0m17:22:02.849385 [debug] [MainThread]: Partial parsing: deleted file: snowflake://models/example/fct_leads.sql
[0m17:22:03.170390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11347b350>]}
[0m17:22:03.262025 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:22:03.265351 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:22:03.281478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113574a40>]}
[0m17:22:03.282052 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m17:22:03.282554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11355dd30>]}
[0m17:22:03.284707 [info ] [MainThread]: 
[0m17:22:03.285222 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:22:03.285672 [info ] [MainThread]: 
[0m17:22:03.286345 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:22:03.293396 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:22:03.353797 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:22:03.354316 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:22:03.354712 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:22:03.979145 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.624 seconds
[0m17:22:03.981976 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:22:03.993209 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:22:03.993630 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:22:04.109012 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.115 seconds
[0m17:22:04.112888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130bc290>]}
[0m17:22:04.114288 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:22:04.114859 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:22:04.115461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:22:04.115880 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:22:04.124934 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:22:04.125898 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:22:04.242176 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:22:04.243575 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:22:04.244027 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:22:06.072625 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.828 seconds
[0m17:22:06.101193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e8e1b0>]}
[0m17:22:06.102035 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.98s]
[0m17:22:06.102968 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:22:06.104126 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:22:06.104703 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:22:06.105345 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:22:06.105775 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:22:06.109029 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:22:06.110382 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:22:06.140208 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:22:06.141459 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:22:06.141965 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:22:06.371376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m17:22:06.374149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4f718b8-fddb-4203-9296-37da049a0a87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bff1d0>]}
[0m17:22:06.374836 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.27s]
[0m17:22:06.375638 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:22:06.376983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:22:06.377333 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:22:06.377688 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:22:06.479883 [info ] [MainThread]: 
[0m17:22:06.480518 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.19 seconds (3.19s).
[0m17:22:06.481615 [debug] [MainThread]: Command end result
[0m17:22:06.508056 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:22:06.510159 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:22:06.517191 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:22:06.517617 [info ] [MainThread]: 
[0m17:22:06.518234 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:22:06.518709 [info ] [MainThread]: 
[0m17:22:06.519246 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:22:06.543761 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.9141483, "process_in_blocks": "0", "process_kernel_time": 0.384579, "process_mem_max_rss": "133156864", "process_out_blocks": "0", "process_user_time": 2.948554}
[0m17:22:06.544629 [debug] [MainThread]: Command `dbt run` succeeded at 17:22:06.544478 after 4.92 seconds
[0m17:22:06.545150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111708a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1132ca3f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c452b0>]}
[0m17:22:06.545702 [debug] [MainThread]: Flushing usage events
[0m17:22:06.755250 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:29:49.463972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105784c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d32f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069d3080>]}


============================== 17:29:49.522957 | 4e1adb0c-675f-4efb-952d-4eb6dddd960e ==============================
[0m17:29:49.522957 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:29:49.523923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:29:51.502843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4e1adb0c-675f-4efb-952d-4eb6dddd960e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c94f20>]}
[0m17:29:51.574325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4e1adb0c-675f-4efb-952d-4eb6dddd960e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bc3770>]}
[0m17:29:51.575639 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:29:52.004890 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:29:52.302325 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:29:52.303048 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:29:52.355557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e1adb0c-675f-4efb-952d-4eb6dddd960e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d1c590>]}
[0m17:29:52.457443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:29:52.490584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:29:52.554472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e1adb0c-675f-4efb-952d-4eb6dddd960e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10806e4e0>]}
[0m17:29:52.555050 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m17:29:52.555523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e1adb0c-675f-4efb-952d-4eb6dddd960e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10685bbc0>]}
[0m17:29:52.557323 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:29:52.559493 [debug] [MainThread]: Command end result
[0m17:29:52.584969 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:29:52.586811 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:29:52.611966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:29:52.632626 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.5642219, "process_in_blocks": "0", "process_kernel_time": 0.527393, "process_mem_max_rss": "115425280", "process_out_blocks": "0", "process_user_time": 2.516606}
[0m17:29:52.633602 [debug] [MainThread]: Command `dbt run` succeeded at 17:29:52.633391 after 3.57 seconds
[0m17:29:52.634178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107862900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cfb8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10610e8a0>]}
[0m17:29:52.634708 [debug] [MainThread]: Flushing usage events
[0m17:29:52.957209 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:30:47.815966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c065a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0832f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c083080>]}


============================== 17:30:47.870546 | 876ef896-a5cd-4c8c-b94a-058aa123642d ==============================
[0m17:30:47.870546 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:30:47.871482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:30:48.846018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2d9340>]}
[0m17:30:48.918456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab63fb0>]}
[0m17:30:48.919728 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:30:49.175056 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:30:49.360991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:49.361471 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:49.415308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbbea80>]}
[0m17:30:49.509033 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:30:49.521307 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:30:49.584379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d74a750>]}
[0m17:30:49.585011 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m17:30:49.585480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3d65d0>]}
[0m17:30:49.587825 [info ] [MainThread]: 
[0m17:30:49.588361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:30:49.588806 [info ] [MainThread]: 
[0m17:30:49.589490 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:30:49.595306 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:30:49.804023 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:30:49.804546 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:30:49.804917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:50.567350 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.762 seconds
[0m17:30:50.570294 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:30:50.581687 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:30:50.582142 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:30:50.717237 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.135 seconds
[0m17:30:50.720905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5351f0>]}
[0m17:30:50.722397 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:30:50.722975 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:30:50.723588 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:30:50.724282 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:30:50.734498 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:30:50.736432 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:30:50.774901 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:30:50.776196 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:30:50.776637 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:30:52.706614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.929 seconds
[0m17:30:52.743306 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4f5490>]}
[0m17:30:52.744205 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.01s]
[0m17:30:52.745026 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:30:52.746076 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:30:52.746643 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:30:52.747255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:30:52.747667 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:30:52.750729 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:30:52.751765 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:30:52.780402 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:30:52.781770 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:30:52.782298 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:30:52.944496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.162 seconds
[0m17:30:52.947403 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '876ef896-a5cd-4c8c-b94a-058aa123642d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e56f440>]}
[0m17:30:52.948079 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.20s]
[0m17:30:52.948863 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:30:52.950222 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:52.950574 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:30:52.950934 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:30:53.074911 [info ] [MainThread]: 
[0m17:30:53.075555 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m17:30:53.076695 [debug] [MainThread]: Command end result
[0m17:30:53.103436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:30:53.105996 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:30:53.112966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:30:53.113444 [info ] [MainThread]: 
[0m17:30:53.114133 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:30:53.114684 [info ] [MainThread]: 
[0m17:30:53.115166 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:30:53.130024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.5415373, "process_in_blocks": "0", "process_kernel_time": 0.537417, "process_mem_max_rss": "129495040", "process_out_blocks": "0", "process_user_time": 2.854854}
[0m17:30:53.130874 [debug] [MainThread]: Command `dbt run` succeeded at 17:30:53.130738 after 5.54 seconds
[0m17:30:53.131347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c066e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0831a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0832f0>]}
[0m17:30:53.131779 [debug] [MainThread]: Flushing usage events
[0m17:30:53.324159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:42:58.551477 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffe7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be2e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110be2c00>]}


============================== 17:42:58.637670 | 7cf1f01e-2b4a-46a2-9411-776c2cd8a47c ==============================
[0m17:42:58.637670 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:42:58.638724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:58.774422 [info ] [MainThread]: dbt version: 1.9.1
[0m17:42:58.775005 [info ] [MainThread]: python version: 3.12.5
[0m17:42:58.775482 [info ] [MainThread]: python path: /Users/rahulpatil/Rahul/Projects/dbt-env/dbt-venv/bin/python3.12
[0m17:42:58.775902 [info ] [MainThread]: os info: macOS-10.15.7-x86_64-i386-64bit
[0m17:42:59.952757 [info ] [MainThread]: Using profiles dir at /Users/rahulpatil/.dbt
[0m17:42:59.953365 [info ] [MainThread]: Using profiles.yml file at /Users/rahulpatil/.dbt/profiles.yml
[0m17:42:59.953845 [info ] [MainThread]: Using dbt_project.yml file at /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/dbt_project.yml
[0m17:42:59.954780 [info ] [MainThread]: adapter type: snowflake
[0m17:42:59.955245 [info ] [MainThread]: adapter version: 1.9.0
[0m17:43:00.082197 [info ] [MainThread]: Configuration:
[0m17:43:00.082751 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:43:00.083572 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:43:00.084212 [info ] [MainThread]: Required dependencies:
[0m17:43:00.084858 [debug] [MainThread]: Executing "git --help"
[0m17:43:00.208906 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--no-lazy-fetch]\n           [--no-optional-locks] [--no-advice] [--bare] [--git-dir=<path>]\n           [--work-tree=<path>] [--namespace=<name>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:43:00.210021 [debug] [MainThread]: STDERR: "b''"
[0m17:43:00.210630 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:43:00.211105 [info ] [MainThread]: Connection:
[0m17:43:00.211700 [info ] [MainThread]:   account: rjsnibx-ig91818
[0m17:43:00.212204 [info ] [MainThread]:   user: DBT_USER
[0m17:43:00.212624 [info ] [MainThread]:   database: DBT_TEST
[0m17:43:00.213053 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m17:43:00.213466 [info ] [MainThread]:   role: accountadmin
[0m17:43:00.213905 [info ] [MainThread]:   schema: STG
[0m17:43:00.214336 [info ] [MainThread]:   authenticator: None
[0m17:43:00.214755 [info ] [MainThread]:   oauth_client_id: None
[0m17:43:00.215112 [info ] [MainThread]:   query_tag: None
[0m17:43:00.215505 [info ] [MainThread]:   client_session_keep_alive: False
[0m17:43:00.216238 [info ] [MainThread]:   host: None
[0m17:43:00.217561 [info ] [MainThread]:   port: None
[0m17:43:00.218362 [info ] [MainThread]:   proxy_host: None
[0m17:43:00.218949 [info ] [MainThread]:   proxy_port: None
[0m17:43:00.219357 [info ] [MainThread]:   protocol: None
[0m17:43:00.219895 [info ] [MainThread]:   connect_retries: 1
[0m17:43:00.220355 [info ] [MainThread]:   connect_timeout: None
[0m17:43:00.220758 [info ] [MainThread]:   retry_on_database_errors: False
[0m17:43:00.221149 [info ] [MainThread]:   retry_all: False
[0m17:43:00.221533 [info ] [MainThread]:   insecure_mode: False
[0m17:43:00.221907 [info ] [MainThread]:   reuse_connections: True
[0m17:43:00.224514 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:43:00.478585 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m17:43:00.640260 [debug] [MainThread]: Using snowflake connection "debug"
[0m17:43:00.640759 [debug] [MainThread]: On debug: select 1 as id
[0m17:43:00.641121 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:01.363756 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.723 seconds
[0m17:43:01.365024 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:43:01.365482 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:43:01.374802 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 3.071458, "process_in_blocks": "0", "process_kernel_time": 0.543496, "process_mem_max_rss": "122638336", "process_out_blocks": "0", "process_user_time": 2.350895}
[0m17:43:01.375856 [debug] [MainThread]: Command `dbt debug` succeeded at 17:43:01.375636 after 3.07 seconds
[0m17:43:01.376410 [debug] [MainThread]: Connection 'debug' was left open.
[0m17:43:01.376874 [debug] [MainThread]: On debug: Close
[0m17:43:01.482818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110406ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ea7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123b3290>]}
[0m17:43:01.483449 [debug] [MainThread]: Flushing usage events
[0m17:43:01.662719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:43:12.416162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a0ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a372f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a37080>]}


============================== 17:43:12.422356 | 3c175964-eafe-4e72-b4be-cefcbd6a45c0 ==============================
[0m17:43:12.422356 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:43:12.423131 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:43:12.930585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c86ba0>]}
[0m17:43:13.025104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a251f0>]}
[0m17:43:13.026731 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:43:13.280870 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:43:13.536497 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:13.537101 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:13.603061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ceaa80>]}
[0m17:43:13.720166 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:43:13.740332 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:43:13.825114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080fdf40>]}
[0m17:43:13.825822 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m17:43:13.826308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cea120>]}
[0m17:43:13.829435 [info ] [MainThread]: 
[0m17:43:13.830040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:43:13.830485 [info ] [MainThread]: 
[0m17:43:13.831184 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:43:13.837615 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:43:13.909482 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:43:13.909982 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:43:13.910358 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:14.653398 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.743 seconds
[0m17:43:14.656773 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:43:14.669664 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:43:14.670177 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:43:14.772386 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m17:43:14.776487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d73920>]}
[0m17:43:14.780213 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:43:14.781013 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:43:14.781643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:43:14.782109 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:43:14.795656 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:43:14.796918 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:43:14.845859 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:43:14.847817 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:43:14.848410 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:43:16.616282 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.767 seconds
[0m17:43:16.649224 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e65580>]}
[0m17:43:16.650105 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.87s]
[0m17:43:16.650932 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:43:16.652059 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:43:16.652709 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:43:16.653350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:43:16.653987 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:43:16.657799 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:43:16.658792 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:43:16.692985 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:43:16.694194 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:43:16.694634 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:43:16.859374 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m17:43:16.863084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c175964-eafe-4e72-b4be-cefcbd6a45c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f78dd0>]}
[0m17:43:16.865123 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.21s]
[0m17:43:16.866161 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:43:16.868375 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:16.868829 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:43:16.869262 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:43:16.981917 [info ] [MainThread]: 
[0m17:43:16.982691 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.15 seconds (3.15s).
[0m17:43:16.983987 [debug] [MainThread]: Command end result
[0m17:43:17.012725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:43:17.015649 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:43:17.022489 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:43:17.022998 [info ] [MainThread]: 
[0m17:43:17.023572 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:43:17.024044 [info ] [MainThread]: 
[0m17:43:17.024585 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:43:17.057365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.796903, "process_in_blocks": "0", "process_kernel_time": 0.455253, "process_mem_max_rss": "128815104", "process_out_blocks": "0", "process_user_time": 2.939137}
[0m17:43:17.058242 [debug] [MainThread]: Command `dbt run` succeeded at 17:43:17.058105 after 4.80 seconds
[0m17:43:17.058716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c36db0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c845c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f281d0>]}
[0m17:43:17.059142 [debug] [MainThread]: Flushing usage events
[0m17:43:17.248063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:54.286174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112d3b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e74fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ec70e0>]}


============================== 17:45:54.380584 | 237f6cc5-e7ad-4eee-94b8-e202245488a6 ==============================
[0m17:45:54.380584 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:45:54.381582 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select fct_leads', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:45:55.936636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '237f6cc5-e7ad-4eee-94b8-e202245488a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d2cb60>]}
[0m17:45:56.008069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '237f6cc5-e7ad-4eee-94b8-e202245488a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd5e80>]}
[0m17:45:56.009309 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:45:56.295710 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:45:56.604278 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m17:45:56.731139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '237f6cc5-e7ad-4eee-94b8-e202245488a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cd54f0>]}
[0m17:45:56.809874 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:45:56.825201 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:45:56.887632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '237f6cc5-e7ad-4eee-94b8-e202245488a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11358cd70>]}
[0m17:45:56.888225 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:45:56.888701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '237f6cc5-e7ad-4eee-94b8-e202245488a6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113569be0>]}
[0m17:45:56.890468 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:45:56.892673 [debug] [MainThread]: Command end result
[0m17:45:56.917594 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:45:56.919389 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:45:56.923200 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:45:56.942418 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.039143, "process_in_blocks": "0", "process_kernel_time": 0.484798, "process_mem_max_rss": "117522432", "process_out_blocks": "0", "process_user_time": 2.487156}
[0m17:45:56.943239 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:56.943105 after 3.04 seconds
[0m17:45:56.943708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e74fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132fe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11132e9c0>]}
[0m17:45:56.944140 [debug] [MainThread]: Flushing usage events
[0m17:45:57.311252 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:29.113458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091af2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091af050>]}


============================== 17:47:29.118644 | 3eae28bd-a6f0-4bc0-be2f-b8568732259a ==============================
[0m17:47:29.118644 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:47:29.119426 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --full-refresh', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:47:29.498986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e71580>]}
[0m17:47:29.570951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d21c40>]}
[0m17:47:29.571992 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:47:29.753949 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:47:29.880730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:47:29.881330 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:47:29.926660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a187f20>]}
[0m17:47:30.003157 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:47:30.006441 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:47:30.023673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6b1130>]}
[0m17:47:30.024277 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:47:30.024791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a64e330>]}
[0m17:47:30.027062 [info ] [MainThread]: 
[0m17:47:30.027592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:47:30.028049 [info ] [MainThread]: 
[0m17:47:30.028740 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:47:30.035164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:47:30.354119 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:47:30.354701 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:47:30.355105 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:47:31.142037 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.787 seconds
[0m17:47:31.145176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:47:31.157225 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:47:31.157708 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:47:31.317697 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.160 seconds
[0m17:47:31.321388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3ce8d0>]}
[0m17:47:31.323065 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:47:31.323633 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:47:31.324291 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:47:31.324708 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:47:31.334300 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:47:31.335342 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:47:31.378499 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:47:31.380004 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:47:31.380579 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:47:33.138780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.758 seconds
[0m17:47:33.184962 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074c39b0>]}
[0m17:47:33.185872 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.84s]
[0m17:47:33.186701 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:47:33.187605 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:47:33.188181 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:47:33.188863 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:47:33.189287 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:47:33.192336 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:47:33.193269 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:47:33.220969 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:47:33.222124 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:47:33.222552 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:47:33.439354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.216 seconds
[0m17:47:33.442075 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3eae28bd-a6f0-4bc0-be2f-b8568732259a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6a8fe0>]}
[0m17:47:33.442746 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.25s]
[0m17:47:33.443520 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:47:33.444952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:47:33.445300 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:47:33.445654 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:47:33.561916 [info ] [MainThread]: 
[0m17:47:33.562529 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.53 seconds (3.53s).
[0m17:47:33.563627 [debug] [MainThread]: Command end result
[0m17:47:33.588939 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:47:33.591027 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:47:33.598139 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:47:33.598572 [info ] [MainThread]: 
[0m17:47:33.599207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:47:33.599671 [info ] [MainThread]: 
[0m17:47:33.600313 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:47:33.601569 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.6755075, "process_in_blocks": "0", "process_kernel_time": 0.439453, "process_mem_max_rss": "129953792", "process_out_blocks": "0", "process_user_time": 2.682836}
[0m17:47:33.602243 [debug] [MainThread]: Command `dbt run` succeeded at 17:47:33.602114 after 4.68 seconds
[0m17:47:33.602726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10861c5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081ddbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a811820>]}
[0m17:47:33.603151 [debug] [MainThread]: Flushing usage events
[0m17:47:33.814159 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:28.863286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec5010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10feef260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10feeef00>]}


============================== 17:49:29.029961 | a907274d-bc7f-49bc-9f39-fc8fcfce3611 ==============================
[0m17:49:29.029961 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:49:29.030842 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:49:31.528952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111256e40>]}
[0m17:49:31.600964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1110f2c00>]}
[0m17:49:31.611859 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:49:31.936415 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:49:32.351780 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:49:32.352255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:49:32.396222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11134c620>]}
[0m17:49:32.473436 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:49:32.516156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:49:33.425570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11149b980>]}
[0m17:49:33.426171 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:49:33.426625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114f12e0>]}
[0m17:49:33.428743 [info ] [MainThread]: 
[0m17:49:33.429252 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:49:33.429695 [info ] [MainThread]: 
[0m17:49:33.430364 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:49:33.436051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:49:34.098419 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:49:34.098918 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:49:34.099286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:49:36.870776 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.771 seconds
[0m17:49:36.898760 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:49:36.910576 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:49:36.911049 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:49:37.103615 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.192 seconds
[0m17:49:37.107320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116719d0>]}
[0m17:49:37.108707 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:49:37.109269 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:49:37.109873 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:49:37.110289 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:49:37.119532 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:49:37.120470 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:49:37.158409 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:49:37.159894 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:49:37.160354 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:49:38.910968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.750 seconds
[0m17:49:38.963034 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3292b0>]}
[0m17:49:38.964010 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.84s]
[0m17:49:38.964846 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:49:38.965668 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:49:38.966335 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:49:38.967044 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:49:38.967470 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:49:38.970545 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:49:38.971653 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:49:38.999107 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:49:39.000386 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:49:39.000840 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:49:39.231027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.230 seconds
[0m17:49:39.233775 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a907274d-bc7f-49bc-9f39-fc8fcfce3611', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112584350>]}
[0m17:49:39.234445 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.27s]
[0m17:49:39.235234 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:49:39.236580 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:39.236925 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:49:39.237280 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:49:39.349929 [info ] [MainThread]: 
[0m17:49:39.350563 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.92 seconds (5.92s).
[0m17:49:39.351657 [debug] [MainThread]: Command end result
[0m17:49:39.376742 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:49:39.399215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:49:39.406305 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:49:39.406734 [info ] [MainThread]: 
[0m17:49:39.407316 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:49:39.407773 [info ] [MainThread]: 
[0m17:49:39.408266 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:49:39.424574 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.172202, "process_in_blocks": "0", "process_kernel_time": 0.56834, "process_mem_max_rss": "128339968", "process_out_blocks": "0", "process_user_time": 2.776989}
[0m17:49:39.425475 [debug] [MainThread]: Command `dbt run` succeeded at 17:49:39.425322 after 11.17 seconds
[0m17:49:39.426012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb14d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fda8c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111289730>]}
[0m17:49:39.426517 [debug] [MainThread]: Flushing usage events
[0m17:49:39.636308 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:49:59.527888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063e4bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3b080>]}


============================== 17:49:59.587051 | 74fa1d8f-235c-4e0e-a844-a36391d7cdc5 ==============================
[0m17:49:59.587051 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:49:59.587970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:50:00.342260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e048c0>]}
[0m17:50:00.415935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c0c170>]}
[0m17:50:00.417251 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:50:00.657021 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:50:00.834628 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:50:00.835111 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:50:00.878816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ce5640>]}
[0m17:50:00.977616 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:50:00.981146 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:50:01.082584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819ccb0>]}
[0m17:50:01.083168 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:50:01.083613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10819b950>]}
[0m17:50:01.085749 [info ] [MainThread]: 
[0m17:50:01.086250 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:01.086698 [info ] [MainThread]: 
[0m17:50:01.087381 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:50:01.093105 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:50:01.280993 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:50:01.281480 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:50:01.281843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:02.016958 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.735 seconds
[0m17:50:02.019791 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:50:02.031159 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:50:02.031593 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:50:02.180011 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.148 seconds
[0m17:50:02.183644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108199f40>]}
[0m17:50:02.185177 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:50:02.185755 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:50:02.186372 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:50:02.186793 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:50:02.195980 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:50:02.196932 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:50:02.235833 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:50:02.237302 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:50:02.237753 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:50:03.942471 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.704 seconds
[0m17:50:03.978657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f714f0>]}
[0m17:50:03.979735 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.78s]
[0m17:50:03.980545 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:50:03.981471 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:50:03.982033 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:50:03.982647 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:50:03.983065 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:50:03.986651 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:50:03.987666 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:50:04.013817 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:50:04.015180 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:50:04.015610 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:50:04.285442 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.269 seconds
[0m17:50:04.288265 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74fa1d8f-235c-4e0e-a844-a36391d7cdc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fec3e0>]}
[0m17:50:04.288944 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m17:50:04.289750 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:50:04.291311 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:04.291672 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:50:04.292035 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:50:04.390732 [info ] [MainThread]: 
[0m17:50:04.391364 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m17:50:04.392471 [debug] [MainThread]: Command end result
[0m17:50:04.418021 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:50:04.420239 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:50:04.426697 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:50:04.427067 [info ] [MainThread]: 
[0m17:50:04.427678 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:04.428255 [info ] [MainThread]: 
[0m17:50:04.428825 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:50:04.456949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.1559153, "process_in_blocks": "0", "process_kernel_time": 0.506291, "process_mem_max_rss": "128933888", "process_out_blocks": "0", "process_user_time": 2.728857}
[0m17:50:04.457774 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:04.457640 after 5.16 seconds
[0m17:50:04.458246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d70c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b3af60>]}
[0m17:50:04.458680 [debug] [MainThread]: Flushing usage events
[0m17:50:04.651495 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:07.979803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f0309b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110283560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102832c0>]}


============================== 17:51:07.985354 | 26dffe72-6a87-4dbb-8286-6b3812812630 ==============================
[0m17:51:07.985354 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:51:07.986239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build -m fct_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:51:08.373326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26dffe72-6a87-4dbb-8286-6b3812812630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114eb3e0>]}
[0m17:51:08.445085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26dffe72-6a87-4dbb-8286-6b3812812630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148cf80>]}
[0m17:51:08.446166 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:51:08.646180 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:51:08.776349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:51:08.776833 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:51:08.823296 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26dffe72-6a87-4dbb-8286-6b3812812630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148c0e0>]}
[0m17:51:08.902112 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:51:08.905498 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:51:08.985787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26dffe72-6a87-4dbb-8286-6b3812812630', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115b2450>]}
[0m17:51:08.986415 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:51:08.988309 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:51:08.990613 [debug] [MainThread]: Command end result
[0m17:51:09.017347 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:51:09.019161 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:51:09.022771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:51:09.023978 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 1.1703126, "process_in_blocks": "0", "process_kernel_time": 0.339609, "process_mem_max_rss": "119267328", "process_out_blocks": "0", "process_user_time": 2.33246}
[0m17:51:09.024684 [debug] [MainThread]: Command `dbt build` succeeded at 17:51:09.024543 after 1.17 seconds
[0m17:51:09.025170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100754f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11148db50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118c57f0>]}
[0m17:51:09.025606 [debug] [MainThread]: Flushing usage events
[0m17:51:09.243857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:45.338484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10faa4cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cb3590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110cb3320>]}


============================== 17:58:45.358320 | 7cad8360-282c-45ef-8796-41f43d4646f5 ==============================
[0m17:58:45.358320 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:58:45.359326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build -m fct_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:58:46.492344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7cad8360-282c-45ef-8796-41f43d4646f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8cfe0>]}
[0m17:58:46.563817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7cad8360-282c-45ef-8796-41f43d4646f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fce61b0>]}
[0m17:58:46.565148 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:58:46.882548 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:58:47.151349 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:47.151968 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:47.196369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7cad8360-282c-45ef-8796-41f43d4646f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11201b350>]}
[0m17:58:47.273539 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:58:47.326512 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:58:47.666879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7cad8360-282c-45ef-8796-41f43d4646f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11217bbc0>]}
[0m17:58:47.667478 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:58:47.669406 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:58:47.671499 [debug] [MainThread]: Command end result
[0m17:58:47.697953 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:58:47.699716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:58:47.703276 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:58:47.751901 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 2.5559046, "process_in_blocks": "0", "process_kernel_time": 0.364017, "process_mem_max_rss": "119517184", "process_out_blocks": "0", "process_user_time": 2.33751}
[0m17:58:47.752793 [debug] [MainThread]: Command `dbt build` succeeded at 17:58:47.752644 after 2.56 seconds
[0m17:58:47.753274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118f54f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110116b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c8e510>]}
[0m17:58:47.753709 [debug] [MainThread]: Flushing usage events
[0m17:58:48.079667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:58:53.175086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11192bd40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bdb530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bdb1a0>]}


============================== 17:58:53.180158 | 4b06c843-5138-4e99-8ab2-ae7baef90b92 ==============================
[0m17:58:53.180158 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:58:53.180912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:58:53.622561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc0110>]}
[0m17:58:53.695266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c930e0>]}
[0m17:58:53.696293 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:58:53.889749 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:58:54.114200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:58:54.114683 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:58:54.159120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cbe870>]}
[0m17:58:54.236725 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:58:54.239944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:58:54.452175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113234dd0>]}
[0m17:58:54.452759 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m17:58:54.453212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ef8470>]}
[0m17:58:54.455314 [info ] [MainThread]: 
[0m17:58:54.455816 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:58:54.456258 [info ] [MainThread]: 
[0m17:58:54.456932 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:58:54.462637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:58:54.567420 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:58:54.567922 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:58:54.568323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:58:55.447084 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.879 seconds
[0m17:58:55.459082 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:58:55.470593 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:58:55.471037 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:58:55.593798 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.122 seconds
[0m17:58:55.597430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a195b0>]}
[0m17:58:55.598886 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m17:58:55.599448 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m17:58:55.600054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m17:58:55.600554 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m17:58:55.610116 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m17:58:55.611080 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m17:58:55.649589 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m17:58:55.651131 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m17:58:55.651701 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:58:57.174381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.522 seconds
[0m17:58:57.223121 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fdafa70>]}
[0m17:58:57.224107 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.60s]
[0m17:58:57.224917 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m17:58:57.225867 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m17:58:57.226428 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m17:58:57.227037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m17:58:57.227449 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m17:58:57.230491 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m17:58:57.231813 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m17:58:57.260182 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m17:58:57.291756 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m17:58:57.292289 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m17:58:57.498045 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m17:58:57.518231 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b06c843-5138-4e99-8ab2-ae7baef90b92', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114162120>]}
[0m17:58:57.518969 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.29s]
[0m17:58:57.519755 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m17:58:57.521143 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:58:57.521495 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m17:58:57.521857 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m17:58:57.653382 [info ] [MainThread]: 
[0m17:58:57.653989 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m17:58:57.655149 [debug] [MainThread]: Command end result
[0m17:58:57.680656 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:58:57.682694 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:58:57.689892 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:58:57.690330 [info ] [MainThread]: 
[0m17:58:57.691056 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:58:57.691545 [info ] [MainThread]: 
[0m17:58:57.692047 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m17:58:57.743079 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7087297, "process_in_blocks": "0", "process_kernel_time": 0.410876, "process_mem_max_rss": "127881216", "process_out_blocks": "0", "process_user_time": 2.636779}
[0m17:58:57.743951 [debug] [MainThread]: Command `dbt run` succeeded at 17:58:57.743817 after 4.71 seconds
[0m17:58:57.744483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111960fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe6d700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f0adb0>]}
[0m17:58:57.744961 [debug] [MainThread]: Flushing usage events
[0m17:58:58.042800 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:06:01.333608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074f2660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751f2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751ef30>]}


============================== 18:06:01.338745 | 58ef7283-2040-486e-9080-13923dac72fb ==============================
[0m18:06:01.338745 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:06:01.339504 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:06:01.842230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086e5610>]}
[0m18:06:01.913620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10647a7e0>]}
[0m18:06:01.914720 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:06:02.095805 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:06:02.221510 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:06:02.221976 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:06:02.265800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088838c0>]}
[0m18:06:02.342786 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:06:02.346000 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:06:02.362697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba0ef0>]}
[0m18:06:02.363281 [info ] [MainThread]: Found 3 models, 4 data tests, 468 macros
[0m18:06:02.363744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4a4b0>]}
[0m18:06:02.365926 [info ] [MainThread]: 
[0m18:06:02.366449 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:06:02.366887 [info ] [MainThread]: 
[0m18:06:02.367563 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:06:02.373076 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m18:06:02.435443 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m18:06:02.435998 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m18:06:02.436427 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:06:02.920687 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.484 seconds
[0m18:06:02.923484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m18:06:02.934976 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m18:06:02.935425 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m18:06:03.069503 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.134 seconds
[0m18:06:03.073260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a4b620>]}
[0m18:06:03.074628 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m18:06:03.075187 [info ] [Thread-1 (]: 1 of 2 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m18:06:03.075771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.my_first_dbt_model)
[0m18:06:03.076185 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m18:06:03.085424 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m18:06:03.086386 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m18:06:03.125211 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m18:06:03.126578 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m18:06:03.127023 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:06:04.903280 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.776 seconds
[0m18:06:04.932853 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069515e0>]}
[0m18:06:04.933720 [info ] [Thread-1 (]: 1 of 2 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.86s]
[0m18:06:04.934718 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m18:06:04.935762 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m18:06:04.936393 [info ] [Thread-1 (]: 2 of 2 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m18:06:04.937029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m18:06:04.937449 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m18:06:04.941371 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m18:06:04.942321 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m18:06:04.972680 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m18:06:04.973938 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m18:06:04.974573 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m18:06:05.158660 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m18:06:05.161628 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '58ef7283-2040-486e-9080-13923dac72fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109212db0>]}
[0m18:06:05.162299 [info ] [Thread-1 (]: 2 of 2 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.22s]
[0m18:06:05.163030 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m18:06:05.164333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:06:05.164681 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m18:06:05.165033 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m18:06:05.277356 [info ] [MainThread]: 
[0m18:06:05.278087 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m18:06:05.279182 [debug] [MainThread]: Command end result
[0m18:06:05.305867 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:06:05.307857 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:06:05.315082 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m18:06:05.315512 [info ] [MainThread]: 
[0m18:06:05.316006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:06:05.316615 [info ] [MainThread]: 
[0m18:06:05.317197 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:06:05.318480 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1152935, "process_in_blocks": "0", "process_kernel_time": 0.36953, "process_mem_max_rss": "129110016", "process_out_blocks": "0", "process_user_time": 2.576292}
[0m18:06:05.319155 [debug] [MainThread]: Command `dbt run` succeeded at 18:06:05.319020 after 4.12 seconds
[0m18:06:05.319627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10751f170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089bc4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b819d0>]}
[0m18:06:05.320059 [debug] [MainThread]: Flushing usage events
[0m18:06:05.527135 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:13:15.152589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fad3d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc53320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc530b0>]}


============================== 18:13:15.157656 | 65bdc444-5526-42eb-adb6-9278e3e15190 ==============================
[0m18:13:15.157656 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:13:15.158428 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:13:15.761770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eb4d10>]}
[0m18:13:15.834015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c846de0>]}
[0m18:13:15.835035 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:13:16.018250 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:13:16.206952 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:13:16.207668 [debug] [MainThread]: Partial parsing: added file: snowflake://models/sources/source.yml
[0m18:13:16.208181 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m18:13:16.685709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111501880>]}
[0m18:13:16.797383 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:13:16.800584 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:13:16.850423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111522cc0>]}
[0m18:13:16.851020 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m18:13:16.851514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112e7470>]}
[0m18:13:16.853866 [info ] [MainThread]: 
[0m18:13:16.854371 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:13:16.854836 [info ] [MainThread]: 
[0m18:13:16.855495 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:13:16.862223 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m18:13:16.945792 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m18:13:16.946355 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m18:13:16.946833 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:13:17.573517 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.627 seconds
[0m18:13:17.597865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m18:13:17.609501 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m18:13:17.609961 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m18:13:17.747897 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.137 seconds
[0m18:13:17.751507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113662d0>]}
[0m18:13:17.752885 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m18:13:17.753441 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m18:13:17.754043 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m18:13:17.754452 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m18:13:17.765053 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m18:13:17.779892 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m18:13:17.818295 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m18:13:17.819474 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m18:13:17.819899 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (


select 
id 

from 
"DBT_TEST".stg.stg_sf_leads
        );
[0m18:13:18.463057 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m18:13:18.487381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10def3c50>]}
[0m18:13:18.488126 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.73s]
[0m18:13:18.488899 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m18:13:18.489367 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m18:13:18.489966 [info ] [Thread-1 (]: 2 of 3 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m18:13:18.490563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now model.snowflake.my_first_dbt_model)
[0m18:13:18.490982 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m18:13:18.493970 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m18:13:18.495026 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m18:13:18.498738 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m18:13:18.500474 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m18:13:18.501052 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:13:20.443641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.942 seconds
[0m18:13:20.449316 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112972f0>]}
[0m18:13:20.450088 [info ] [Thread-1 (]: 2 of 3 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.96s]
[0m18:13:20.450922 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m18:13:20.451777 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m18:13:20.452516 [info ] [Thread-1 (]: 3 of 3 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m18:13:20.453227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m18:13:20.453659 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m18:13:20.456969 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m18:13:20.458478 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m18:13:20.489623 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m18:13:20.491070 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m18:13:20.491663 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m18:13:20.807775 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.316 seconds
[0m18:13:20.810674 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '65bdc444-5526-42eb-adb6-9278e3e15190', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e59a90>]}
[0m18:13:20.811432 [info ] [Thread-1 (]: 3 of 3 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.36s]
[0m18:13:20.812307 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m18:13:20.813977 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:13:20.814423 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m18:13:20.814818 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m18:13:20.941562 [info ] [MainThread]: 
[0m18:13:20.942264 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m18:13:20.943667 [debug] [MainThread]: Command end result
[0m18:13:20.972831 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:13:20.976434 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:13:20.984419 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m18:13:20.984959 [info ] [MainThread]: 
[0m18:13:20.985518 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:13:20.986112 [info ] [MainThread]: 
[0m18:13:20.986611 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:13:21.007087 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0110493, "process_in_blocks": "0", "process_kernel_time": 0.395206, "process_mem_max_rss": "131551232", "process_out_blocks": "0", "process_user_time": 3.107858}
[0m18:13:21.008968 [debug] [MainThread]: Command `dbt run` succeeded at 18:13:21.008744 after 6.01 seconds
[0m18:13:21.009770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155c2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11155c260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b02ed0>]}
[0m18:13:21.010327 [debug] [MainThread]: Flushing usage events
[0m18:13:21.242558 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:14:15.246863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105a0080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11217f350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11217f0e0>]}


============================== 18:14:15.251896 | 55a3fff1-a753-48d2-950d-02da21b0359f ==============================
[0m18:14:15.251896 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:14:15.252682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:14:15.823777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133e8830>]}
[0m18:14:15.894414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112dc5670>]}
[0m18:14:15.895419 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:14:16.084722 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:14:16.263460 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:14:16.263946 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:14:16.317019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134b1e80>]}
[0m18:14:16.411124 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:14:16.414442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:14:16.430347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11381a6c0>]}
[0m18:14:16.431005 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m18:14:16.431457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134cfbf0>]}
[0m18:14:16.433611 [info ] [MainThread]: 
[0m18:14:16.434110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:14:16.434550 [info ] [MainThread]: 
[0m18:14:16.435225 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:14:16.441569 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m18:14:16.504660 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m18:14:16.505161 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m18:14:16.505530 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:17.072079 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.566 seconds
[0m18:14:17.074887 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m18:14:17.085964 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m18:14:17.086383 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m18:14:17.199566 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.113 seconds
[0m18:14:17.203473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104d9a60>]}
[0m18:14:17.204924 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m18:14:17.205487 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m18:14:17.206124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m18:14:17.206544 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m18:14:17.216319 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m18:14:17.217248 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m18:14:17.254193 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m18:14:17.255313 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m18:14:17.255740 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (


select 
id 

from 
"DBT_TEST".stg.stg_sf_leads
        );
[0m18:14:17.797894 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.542 seconds
[0m18:14:17.824389 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110427e00>]}
[0m18:14:17.825140 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.62s]
[0m18:14:17.825944 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m18:14:17.826415 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m18:14:17.827013 [info ] [Thread-1 (]: 2 of 3 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m18:14:17.827612 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now model.snowflake.my_first_dbt_model)
[0m18:14:17.828031 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m18:14:17.830965 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m18:14:17.831871 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m18:14:17.835484 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m18:14:17.836974 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m18:14:17.837853 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:14:18.602069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.763 seconds
[0m18:14:18.604716 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147a2cc0>]}
[0m18:14:18.605392 [info ] [Thread-1 (]: 2 of 3 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.78s]
[0m18:14:18.606180 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m18:14:18.607083 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m18:14:18.607646 [info ] [Thread-1 (]: 3 of 3 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m18:14:18.608224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m18:14:18.608638 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m18:14:18.611976 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m18:14:18.612951 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m18:14:18.641493 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m18:14:18.642900 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m18:14:18.643476 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m18:14:18.916033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.272 seconds
[0m18:14:18.918776 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55a3fff1-a753-48d2-950d-02da21b0359f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114889bb0>]}
[0m18:14:18.919468 [info ] [Thread-1 (]: 3 of 3 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.31s]
[0m18:14:18.920254 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m18:14:18.921693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:18.922045 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m18:14:18.922405 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m18:14:19.016697 [info ] [MainThread]: 
[0m18:14:19.017333 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.58 seconds (2.58s).
[0m18:14:19.018619 [debug] [MainThread]: Command end result
[0m18:14:19.045916 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:14:19.047923 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:14:19.055091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m18:14:19.055509 [info ] [MainThread]: 
[0m18:14:19.056112 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:19.056583 [info ] [MainThread]: 
[0m18:14:19.057125 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:14:19.079805 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.017084, "process_in_blocks": "0", "process_kernel_time": 0.37881, "process_mem_max_rss": "129445888", "process_out_blocks": "0", "process_user_time": 2.630992}
[0m18:14:19.080630 [debug] [MainThread]: Command `dbt run` succeeded at 18:14:19.080496 after 4.02 seconds
[0m18:14:19.081103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c43020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1118b4a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11217f2f0>]}
[0m18:14:19.081531 [debug] [MainThread]: Flushing usage events
[0m18:14:19.274472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:40.380395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11268ade0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113977350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139770e0>]}


============================== 18:15:40.385585 | 5882b2cd-8c32-45cb-812c-67e67ecacb3f ==============================
[0m18:15:40.385585 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:15:40.386654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:15:40.772487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d57230>]}
[0m18:15:40.846789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f0b380>]}
[0m18:15:40.847793 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m18:15:41.029191 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:15:41.176071 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:15:41.177012 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m18:15:41.629003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11512b230>]}
[0m18:15:41.738258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:15:41.742523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:15:41.762114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114e7cb00>]}
[0m18:15:41.763291 [info ] [MainThread]: Found 3 models, 4 data tests, 1 source, 468 macros
[0m18:15:41.763869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ff7f50>]}
[0m18:15:41.766290 [info ] [MainThread]: 
[0m18:15:41.766983 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:15:41.768075 [info ] [MainThread]: 
[0m18:15:41.768931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:15:41.776540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m18:15:41.847890 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m18:15:41.848497 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m18:15:41.848969 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:15:42.380296 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.531 seconds
[0m18:15:42.383561 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m18:15:42.398193 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m18:15:42.398709 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m18:15:42.498413 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.099 seconds
[0m18:15:42.502636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b7b0b0>]}
[0m18:15:42.504253 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m18:15:42.504970 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m18:15:42.505752 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m18:15:42.506271 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m18:15:42.517603 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m18:15:42.518642 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m18:15:42.642776 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m18:15:42.644092 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m18:15:42.644540 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (


select 
* 
from 
"DBT_TEST".stg.stg_sf_leads
        );
[0m18:15:43.450354 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.805 seconds
[0m18:15:43.486477 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110417800>]}
[0m18:15:43.487507 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.98s]
[0m18:15:43.488284 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m18:15:43.488870 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m18:15:43.489489 [info ] [Thread-1 (]: 2 of 3 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m18:15:43.490069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now model.snowflake.my_first_dbt_model)
[0m18:15:43.490501 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m18:15:43.495298 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m18:15:43.496505 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m18:15:43.500348 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m18:15:43.501823 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m18:15:43.502353 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:15:43.995103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m18:15:43.999084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11399e060>]}
[0m18:15:44.000167 [info ] [Thread-1 (]: 2 of 3 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 0.51s]
[0m18:15:44.001020 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m18:15:44.002152 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m18:15:44.002947 [info ] [Thread-1 (]: 3 of 3 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m18:15:44.003629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m18:15:44.004166 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m18:15:44.007729 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m18:15:44.008623 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m18:15:44.042759 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m18:15:44.044024 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m18:15:44.044742 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m18:15:44.192203 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m18:15:44.195570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5882b2cd-8c32-45cb-812c-67e67ecacb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b988c0>]}
[0m18:15:44.196513 [info ] [Thread-1 (]: 3 of 3 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.19s]
[0m18:15:44.197339 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m18:15:44.199203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:15:44.199635 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m18:15:44.200004 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m18:15:44.308714 [info ] [MainThread]: 
[0m18:15:44.309364 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 2.54 seconds (2.54s).
[0m18:15:44.310714 [debug] [MainThread]: Command end result
[0m18:15:44.344486 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m18:15:44.347149 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m18:15:44.355329 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m18:15:44.355855 [info ] [MainThread]: 
[0m18:15:44.356351 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:15:44.356764 [info ] [MainThread]: 
[0m18:15:44.357177 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:15:44.358393 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.107283, "process_in_blocks": "0", "process_kernel_time": 0.391169, "process_mem_max_rss": "132866048", "process_out_blocks": "0", "process_user_time": 3.129462}
[0m18:15:44.359047 [debug] [MainThread]: Command `dbt run` succeeded at 18:15:44.358915 after 4.11 seconds
[0m18:15:44.359507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135ec800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113432870>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11601cd10>]}
[0m18:15:44.359940 [debug] [MainThread]: Flushing usage events
[0m18:15:44.570450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m06:47:10.875557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108834b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109227440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092271a0>]}


============================== 06:47:10.902452 | a633b7a4-d599-419b-a74c-a74ddd54d698 ==============================
[0m06:47:10.902452 [info ] [MainThread]: Running with dbt=1.9.1
[0m06:47:10.903417 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m06:47:11.822819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4e3b00>]}
[0m06:47:11.894108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109de0d40>]}
[0m06:47:11.895391 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m06:47:12.180583 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m06:47:12.496131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:47:12.497007 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/sources/source.yml
[0m06:47:12.915926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab6af90>]}
[0m06:47:13.004309 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m06:47:13.007782 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m06:47:13.110821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a732bd0>]}
[0m06:47:13.111414 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m06:47:13.111876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e50d0>]}
[0m06:47:13.114200 [info ] [MainThread]: 
[0m06:47:13.114700 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m06:47:13.115143 [info ] [MainThread]: 
[0m06:47:13.115802 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m06:47:13.121513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m06:47:13.326024 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m06:47:13.326586 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m06:47:13.326954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:47:14.397427 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.070 seconds
[0m06:47:14.400891 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m06:47:14.414349 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m06:47:14.414833 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m06:47:14.532002 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.117 seconds
[0m06:47:14.535964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a06da00>]}
[0m06:47:14.537942 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m06:47:14.538547 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m06:47:14.539198 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m06:47:14.539616 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m06:47:14.550753 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m06:47:14.551707 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m06:47:14.594814 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m06:47:14.596125 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m06:47:14.596598 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (


select 
* 
from 
"DBT_TEST".stg.stg_sf_leads
        );
[0m06:47:16.900764 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.304 seconds
[0m06:47:16.928067 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cfdd0>]}
[0m06:47:16.928840 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.39s]
[0m06:47:16.929643 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m06:47:16.930117 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m06:47:16.930707 [info ] [Thread-1 (]: 2 of 3 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m06:47:16.931303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now model.snowflake.my_first_dbt_model)
[0m06:47:16.931719 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m06:47:16.934791 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m06:47:16.935881 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m06:47:16.939518 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m06:47:16.940898 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m06:47:16.941359 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m06:47:18.660434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.719 seconds
[0m06:47:18.663149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8bffe0>]}
[0m06:47:18.663844 [info ] [Thread-1 (]: 2 of 3 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.73s]
[0m06:47:18.664648 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m06:47:18.665551 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m06:47:18.666118 [info ] [Thread-1 (]: 3 of 3 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m06:47:18.666698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m06:47:18.667110 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m06:47:18.670122 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m06:47:18.671281 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m06:47:18.700473 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m06:47:18.701657 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m06:47:18.702101 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m06:47:18.892552 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m06:47:18.895250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a633b7a4-d599-419b-a74c-a74ddd54d698', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b120ad0>]}
[0m06:47:18.895912 [info ] [Thread-1 (]: 3 of 3 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.23s]
[0m06:47:18.896688 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m06:47:18.898045 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:47:18.898395 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m06:47:18.898752 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m06:47:19.013772 [info ] [MainThread]: 
[0m06:47:19.014434 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 5.90 seconds (5.90s).
[0m06:47:19.015900 [debug] [MainThread]: Command end result
[0m06:47:19.043301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m06:47:19.045302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m06:47:19.051903 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m06:47:19.052290 [info ] [MainThread]: 
[0m06:47:19.052810 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:47:19.053282 [info ] [MainThread]: 
[0m06:47:19.053791 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m06:47:19.055131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.307256, "process_in_blocks": "0", "process_kernel_time": 0.455401, "process_mem_max_rss": "132427776", "process_out_blocks": "0", "process_user_time": 3.264588}
[0m06:47:19.055776 [debug] [MainThread]: Command `dbt run` succeeded at 06:47:19.055647 after 8.31 seconds
[0m06:47:19.056228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afbf6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a732570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a733950>]}
[0m06:47:19.056661 [debug] [MainThread]: Flushing usage events
[0m06:47:19.275762 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:34:45.546749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10acf3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc7080>]}


============================== 07:34:45.604101 | 55c529e6-773e-4ec9-b178-7cc445c273a7 ==============================
[0m07:34:45.604101 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:34:45.605570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:34:47.083467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55c529e6-773e-4ec9-b178-7cc445c273a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce16360>]}
[0m07:34:47.155300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55c529e6-773e-4ec9-b178-7cc445c273a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cdc6150>]}
[0m07:34:47.156637 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:34:47.464710 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:34:47.879108 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:34:47.879578 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:34:47.932666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55c529e6-773e-4ec9-b178-7cc445c273a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2484a0>]}
[0m07:34:48.030675 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:34:48.069716 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:34:48.277000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55c529e6-773e-4ec9-b178-7cc445c273a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d23ede0>]}
[0m07:34:48.277599 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m07:34:48.279634 [info ] [MainThread]: 
[0m07:34:48.280140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:34:48.280556 [info ] [MainThread]: 
[0m07:34:48.281240 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:34:48.282185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m07:34:48.421312 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m07:34:48.421805 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m07:34:48.422171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:34:49.158194 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.736 seconds
[0m07:34:49.164893 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m07:34:49.176231 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m07:34:49.176730 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m07:34:49.307874 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.131 seconds
[0m07:34:49.311718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55c529e6-773e-4ec9-b178-7cc445c273a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3b7aa0>]}
[0m07:34:49.313314 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m07:34:49.313891 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m07:34:49.314542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m07:34:49.314967 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m07:34:49.324661 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m07:34:49.326428 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m07:34:49.363561 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m07:34:49.364999 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m07:34:49.365442 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (


select 
* 
from 
"DBT_TEST".stg.stg_sf_leads
        );
[0m07:34:51.310145 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.944 seconds
[0m07:34:51.358245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55c529e6-773e-4ec9-b178-7cc445c273a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e6be00>]}
[0m07:34:51.359210 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.02s]
[0m07:34:51.360020 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m07:34:51.361626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:34:51.361977 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m07:34:51.362340 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m07:34:51.477108 [info ] [MainThread]: 
[0m07:34:51.477769 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.20 seconds (3.20s).
[0m07:34:51.478824 [debug] [MainThread]: Command end result
[0m07:34:51.504438 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:34:51.506496 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:34:51.513940 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m07:34:51.514577 [info ] [MainThread]: 
[0m07:34:51.515193 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:34:51.515702 [info ] [MainThread]: 
[0m07:34:51.516284 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:34:51.536637 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.29714, "process_in_blocks": "0", "process_kernel_time": 0.581104, "process_mem_max_rss": "130572288", "process_out_blocks": "0", "process_user_time": 2.776194}
[0m07:34:51.537478 [debug] [MainThread]: Command `dbt build` succeeded at 07:34:51.537336 after 6.30 seconds
[0m07:34:51.537964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7b6660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc72c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbc73e0>]}
[0m07:34:51.538478 [debug] [MainThread]: Flushing usage events
[0m07:34:51.743867 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:35:46.100627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b54140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112053740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120534a0>]}


============================== 07:35:46.105606 | d600dfa7-9edc-4c44-a294-86ebd7fb2f98 ==============================
[0m07:35:46.105606 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:35:46.106367 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:35:46.484177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd600dfa7-9edc-4c44-a294-86ebd7fb2f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1120c84a0>]}
[0m07:35:46.555217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd600dfa7-9edc-4c44-a294-86ebd7fb2f98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11073cbc0>]}
[0m07:35:46.556262 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:35:46.741133 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:35:46.887730 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:35:46.888496 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:35:47.113558 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snowflake.fct_leads' (models/fct_leads.sql) depends on a source named 'stg_source_s1.source_s1' which was not found
[0m07:35:47.115158 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1412123, "process_in_blocks": "0", "process_kernel_time": 0.326934, "process_mem_max_rss": "117452800", "process_out_blocks": "0", "process_user_time": 2.358092}
[0m07:35:47.115914 [debug] [MainThread]: Command `dbt build` failed at 07:35:47.115764 after 1.14 seconds
[0m07:35:47.116428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112053560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d4dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112186b40>]}
[0m07:35:47.116902 [debug] [MainThread]: Flushing usage events
[0m07:35:47.277237 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:37:56.837466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105450f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a32c0>]}


============================== 07:37:56.843698 | c14fcbe5-3869-472b-9e0d-fd681636105f ==============================
[0m07:37:56.843698 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:37:56.844440 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:37:57.248126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c14fcbe5-3869-472b-9e0d-fd681636105f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10671a210>]}
[0m07:37:57.320930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c14fcbe5-3869-472b-9e0d-fd681636105f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10733ecc0>]}
[0m07:37:57.322002 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:37:57.509642 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:37:57.656514 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:37:57.657371 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:37:57.891025 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snowflake.fct_leads' (models/fct_leads.sql) depends on a source named 'stg_sf_leads.leads' which was not found
[0m07:37:57.892612 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2000315, "process_in_blocks": "0", "process_kernel_time": 0.345074, "process_mem_max_rss": "118636544", "process_out_blocks": "0", "process_user_time": 2.482189}
[0m07:37:57.893395 [debug] [MainThread]: Command `dbt build` failed at 07:37:57.893207 after 1.20 seconds
[0m07:37:57.893908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066a33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10794d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c666c0>]}
[0m07:37:57.894382 [debug] [MainThread]: Flushing usage events
[0m07:37:58.076417 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:41:55.892029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102fc830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103236b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110323440>]}


============================== 07:41:55.897002 | ae2feaa1-999a-44db-b480-5dbc30e71a8f ==============================
[0m07:41:55.897002 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:41:55.897791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:41:56.300984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae2feaa1-999a-44db-b480-5dbc30e71a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101e1070>]}
[0m07:41:56.377332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae2feaa1-999a-44db-b480-5dbc30e71a8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffcde20>]}
[0m07:41:56.378409 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:41:56.581297 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:41:56.733337 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:41:56.734114 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:41:56.973209 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snowflake.fct_leads' (models/fct_leads.sql) depends on a source named 'stg_source_s2.source_s2' which was not found
[0m07:41:56.975050 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.2175736, "process_in_blocks": "0", "process_kernel_time": 0.354509, "process_mem_max_rss": "117428224", "process_out_blocks": "0", "process_user_time": 2.493141}
[0m07:41:56.975835 [debug] [MainThread]: Command `dbt build` failed at 07:41:56.975678 after 1.22 seconds
[0m07:41:56.976364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff9ea80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111a111f0>]}
[0m07:41:56.976854 [debug] [MainThread]: Flushing usage events
[0m07:41:57.152054 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:42:13.649566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eb587a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd67710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd67380>]}


============================== 07:42:13.655691 | 2e66d468-5bce-48d3-a264-7ada76eaa2c6 ==============================
[0m07:42:13.655691 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:42:13.656529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:42:14.056782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e66d468-5bce-48d3-a264-7ada76eaa2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd1a630>]}
[0m07:42:14.131346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e66d468-5bce-48d3-a264-7ada76eaa2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e7e810>]}
[0m07:42:14.132362 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:42:14.332779 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:42:14.482758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:42:14.483541 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:42:14.816304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e66d468-5bce-48d3-a264-7ada76eaa2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110eada30>]}
[0m07:42:14.943356 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:42:14.946568 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:42:14.979777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e66d468-5bce-48d3-a264-7ada76eaa2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111687fb0>]}
[0m07:42:14.980425 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m07:42:14.982442 [info ] [MainThread]: 
[0m07:42:14.982909 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:14.983316 [info ] [MainThread]: 
[0m07:42:14.984044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:42:14.985028 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m07:42:15.049504 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m07:42:15.050014 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m07:42:15.050407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:15.758452 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.708 seconds
[0m07:42:15.765214 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m07:42:15.776914 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m07:42:15.777391 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m07:42:15.896147 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.118 seconds
[0m07:42:15.900465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e66d468-5bce-48d3-a264-7ada76eaa2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110deb2f0>]}
[0m07:42:15.902072 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m07:42:15.902643 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m07:42:15.903276 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m07:42:15.903924 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m07:42:15.917607 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m07:42:15.918490 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m07:42:15.957444 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m07:42:15.959077 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m07:42:15.959528 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads

    select * from leads
        );
[0m07:42:16.205968 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92df6-0002-429c-0007-02f200012c8a
[0m07:42:16.206518 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 4 unexpected 'select'.
[0m07:42:16.246234 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'select'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:42:16.248218 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e66d468-5bce-48d3-a264-7ada76eaa2c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fe4b00>]}
[0m07:42:16.248937 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.34s]
[0m07:42:16.249745 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m07:42:16.250380 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'select'.
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m07:42:16.252060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:16.252409 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m07:42:16.252891 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m07:42:16.357695 [info ] [MainThread]: 
[0m07:42:16.358322 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.37 seconds (1.37s).
[0m07:42:16.359232 [debug] [MainThread]: Command end result
[0m07:42:16.388260 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:42:16.390827 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:42:16.398310 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m07:42:16.398857 [info ] [MainThread]: 
[0m07:42:16.399400 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:42:16.399900 [info ] [MainThread]: 
[0m07:42:16.400476 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'select'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:42:16.400924 [info ] [MainThread]: 
[0m07:42:16.401423 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:42:16.402613 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.8866353, "process_in_blocks": "0", "process_kernel_time": 0.407356, "process_mem_max_rss": "134303744", "process_out_blocks": "0", "process_user_time": 3.04813}
[0m07:42:16.403245 [debug] [MainThread]: Command `dbt build` failed at 07:42:16.403115 after 2.89 seconds
[0m07:42:16.403721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ecebe60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111570c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f24bd40>]}
[0m07:42:16.404952 [debug] [MainThread]: Flushing usage events
[0m07:42:16.593628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:42:41.289712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107df05f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fff3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fff110>]}


============================== 07:42:41.295341 | 19a661a4-46c7-440a-b7c2-7fbbaaac29fd ==============================
[0m07:42:41.295341 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:42:41.296219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:42:41.755994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '19a661a4-46c7-440a-b7c2-7fbbaaac29fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107334aa0>]}
[0m07:42:41.832249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '19a661a4-46c7-440a-b7c2-7fbbaaac29fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c9a300>]}
[0m07:42:41.833317 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:42:42.024422 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:42:42.172765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m07:42:42.173340 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m07:42:42.230792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '19a661a4-46c7-440a-b7c2-7fbbaaac29fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30f470>]}
[0m07:42:42.331064 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:42:42.334464 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:42:42.367091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '19a661a4-46c7-440a-b7c2-7fbbaaac29fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a7c5a90>]}
[0m07:42:42.367707 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m07:42:42.369847 [info ] [MainThread]: 
[0m07:42:42.370383 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:42.370844 [info ] [MainThread]: 
[0m07:42:42.371544 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:42:42.372570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m07:42:42.442812 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m07:42:42.443580 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m07:42:42.444050 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:42.960757 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.517 seconds
[0m07:42:42.967314 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m07:42:42.979207 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m07:42:42.979693 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m07:42:43.087776 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.108 seconds
[0m07:42:43.091775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '19a661a4-46c7-440a-b7c2-7fbbaaac29fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac362a0>]}
[0m07:42:43.094294 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m07:42:43.095196 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m07:42:43.096245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m07:42:43.096717 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m07:42:43.105866 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m07:42:43.106701 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m07:42:43.148222 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m07:42:43.150073 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m07:42:43.150630 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads

    select * from leads
        );
[0m07:42:43.246437 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92df6-0002-4252-0007-02f200011cb2
[0m07:42:43.246968 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 21 at position 4 unexpected 'select'.
[0m07:42:43.250462 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'select'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:42:43.252331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '19a661a4-46c7-440a-b7c2-7fbbaaac29fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b70dac0>]}
[0m07:42:43.253033 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.15s]
[0m07:42:43.253825 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m07:42:43.254446 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'select'.
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m07:42:43.256105 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:43.256455 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m07:42:43.256809 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m07:42:43.359084 [info ] [MainThread]: 
[0m07:42:43.359798 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.99 seconds (0.99s).
[0m07:42:43.360727 [debug] [MainThread]: Command end result
[0m07:42:43.388227 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:42:43.390395 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:42:43.398149 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m07:42:43.398689 [info ] [MainThread]: 
[0m07:42:43.399277 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:42:43.399802 [info ] [MainThread]: 
[0m07:42:43.400290 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 21 at position 4 unexpected 'select'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:42:43.400678 [info ] [MainThread]: 
[0m07:42:43.401148 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:42:43.402308 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.2471871, "process_in_blocks": "0", "process_kernel_time": 0.391047, "process_mem_max_rss": "131547136", "process_out_blocks": "0", "process_user_time": 2.70828}
[0m07:42:43.403013 [debug] [MainThread]: Command `dbt build` failed at 07:42:43.402869 after 2.25 seconds
[0m07:42:43.403490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fff2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4ac050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d31070>]}
[0m07:42:43.403918 [debug] [MainThread]: Flushing usage events
[0m07:42:43.589743 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:42:53.966715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f49400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f735c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f73350>]}


============================== 07:42:53.972351 | 76589643-ce46-41a6-b57e-97ad8aeaf402 ==============================
[0m07:42:53.972351 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:42:53.973105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m07:42:54.401462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76589643-ce46-41a6-b57e-97ad8aeaf402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112134bf0>]}
[0m07:42:54.477260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76589643-ce46-41a6-b57e-97ad8aeaf402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151c7860>]}
[0m07:42:54.478295 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:42:54.689223 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:42:54.841272 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:42:54.842075 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:42:55.181527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76589643-ce46-41a6-b57e-97ad8aeaf402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11564ffe0>]}
[0m07:42:55.281690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:42:55.285568 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:42:55.319548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '76589643-ce46-41a6-b57e-97ad8aeaf402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115897c50>]}
[0m07:42:55.320392 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m07:42:55.322706 [info ] [MainThread]: 
[0m07:42:55.323262 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:42:55.323728 [info ] [MainThread]: 
[0m07:42:55.324452 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:42:55.325511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m07:42:55.396670 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m07:42:55.397184 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m07:42:55.397588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:42:55.970831 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.573 seconds
[0m07:42:55.977374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m07:42:55.989397 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m07:42:55.989886 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m07:42:56.120625 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.130 seconds
[0m07:42:56.124504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '76589643-ce46-41a6-b57e-97ad8aeaf402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115897f20>]}
[0m07:42:56.126067 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m07:42:56.126676 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m07:42:56.127257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m07:42:56.127724 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m07:42:56.137689 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m07:42:56.138627 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m07:42:56.178801 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m07:42:56.180401 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m07:42:56.180845 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
)
    select * from leads
        );
[0m07:42:57.761279 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.580 seconds
[0m07:42:57.793002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76589643-ce46-41a6-b57e-97ad8aeaf402', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11210fcb0>]}
[0m07:42:57.794099 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.66s]
[0m07:42:57.794978 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m07:42:57.796527 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:42:57.796911 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m07:42:57.797283 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m07:42:57.914749 [info ] [MainThread]: 
[0m07:42:57.915437 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.59 seconds (2.59s).
[0m07:42:57.916479 [debug] [MainThread]: Command end result
[0m07:42:57.949258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:42:57.951506 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:42:57.959476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m07:42:57.960054 [info ] [MainThread]: 
[0m07:42:57.960703 [info ] [MainThread]: [32mCompleted successfully[0m
[0m07:42:57.961321 [info ] [MainThread]: 
[0m07:42:57.962044 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m07:42:57.963681 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.1504774, "process_in_blocks": "0", "process_kernel_time": 0.420879, "process_mem_max_rss": "135487488", "process_out_blocks": "0", "process_user_time": 3.09587}
[0m07:42:57.964358 [debug] [MainThread]: Command `dbt build` succeeded at 07:42:57.964218 after 4.15 seconds
[0m07:42:57.964855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115672810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133dc050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116913f80>]}
[0m07:42:57.965294 [debug] [MainThread]: Flushing usage events
[0m07:42:58.151763 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:50:11.871462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112c04bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136db470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136db1d0>]}


============================== 07:50:11.876480 | c8ae2047-3244-47a9-918f-f806366fdd61 ==============================
[0m07:50:11.876480 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:50:11.877225 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m07:50:12.569862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8ae2047-3244-47a9-918f-f806366fdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136bea50>]}
[0m07:50:12.642409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8ae2047-3244-47a9-918f-f806366fdd61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11454dac0>]}
[0m07:50:12.643417 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:50:12.842749 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:50:13.014733 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:50:13.015470 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:50:13.239044 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snowflake.fct_leads' (models/fct_leads.sql) depends on a source named 'stg_source_s3.source_s3' which was not found
[0m07:50:13.240565 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.5029858, "process_in_blocks": "0", "process_kernel_time": 0.340401, "process_mem_max_rss": "116944896", "process_out_blocks": "0", "process_user_time": 2.346449}
[0m07:50:13.241271 [debug] [MainThread]: Command `dbt build` failed at 07:50:13.241127 after 1.50 seconds
[0m07:50:13.241764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1147158e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d5a1b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114d6f6b0>]}
[0m07:50:13.242225 [debug] [MainThread]: Flushing usage events
[0m07:50:13.463700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:51:37.898399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bd93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219b560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11219b2f0>]}


============================== 07:51:37.904741 | 9a92499f-98e9-467d-a1e3-5cebefae94a0 ==============================
[0m07:51:37.904741 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:51:37.905538 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m07:51:38.320597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a92499f-98e9-467d-a1e3-5cebefae94a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133f92b0>]}
[0m07:51:38.398122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a92499f-98e9-467d-a1e3-5cebefae94a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11345ee70>]}
[0m07:51:38.399237 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:51:38.587645 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:51:38.747273 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:51:38.748159 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:51:39.099640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a92499f-98e9-467d-a1e3-5cebefae94a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139df770>]}
[0m07:51:39.195058 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:51:39.198573 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:51:39.229611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a92499f-98e9-467d-a1e3-5cebefae94a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113acbfe0>]}
[0m07:51:39.230210 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m07:51:39.232244 [info ] [MainThread]: 
[0m07:51:39.232752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:51:39.233198 [info ] [MainThread]: 
[0m07:51:39.233941 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:51:39.234955 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m07:51:39.297645 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m07:51:39.298135 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m07:51:39.298502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:51:39.983716 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.685 seconds
[0m07:51:39.990355 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m07:51:40.001721 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m07:51:40.002183 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m07:51:40.107340 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.105 seconds
[0m07:51:40.111202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a92499f-98e9-467d-a1e3-5cebefae94a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108d82f0>]}
[0m07:51:40.112752 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m07:51:40.113309 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m07:51:40.113992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m07:51:40.114415 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m07:51:40.125123 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m07:51:40.126670 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m07:51:40.164800 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m07:51:40.168032 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m07:51:40.168624 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        CENTER AS company,
        ADDRESS AS address2,
        NV AS state,
        CLARK AS county,
        "346-393-9400" AS phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        License AS license_number,
        "Accepts Subsidy" AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m07:51:40.266910 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92dff-0002-431d-0007-02f200018ada
[0m07:51:40.267447 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CENTER'
[0m07:51:40.270802 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:51:40.272603 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a92499f-98e9-467d-a1e3-5cebefae94a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11383f770>]}
[0m07:51:40.273307 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.16s]
[0m07:51:40.274192 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m07:51:40.274897 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m07:51:40.276554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:51:40.276909 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m07:51:40.277266 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m07:51:40.389877 [info ] [MainThread]: 
[0m07:51:40.390492 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.16 seconds (1.16s).
[0m07:51:40.391470 [debug] [MainThread]: Command end result
[0m07:51:40.417964 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:51:40.420696 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:51:40.427820 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m07:51:40.428295 [info ] [MainThread]: 
[0m07:51:40.429039 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:51:40.429564 [info ] [MainThread]: 
[0m07:51:40.430159 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:51:40.430650 [info ] [MainThread]: 
[0m07:51:40.431177 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:51:40.432416 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.67969, "process_in_blocks": "0", "process_kernel_time": 0.385665, "process_mem_max_rss": "134500352", "process_out_blocks": "0", "process_user_time": 3.015018}
[0m07:51:40.433067 [debug] [MainThread]: Command `dbt build` failed at 07:51:40.432933 after 2.68 seconds
[0m07:51:40.433534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111df69f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136f6720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b0ae70>]}
[0m07:51:40.433964 [debug] [MainThread]: Flushing usage events
[0m07:51:40.665090 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m07:55:15.690819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8206b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba2f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ba2f0b0>]}


============================== 07:55:15.697211 | ba6fcd57-4635-4ea9-8495-a2e99cd76b86 ==============================
[0m07:55:15.697211 [info ] [MainThread]: Running with dbt=1.9.1
[0m07:55:15.698577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m07:55:16.337557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba6fcd57-4635-4ea9-8495-a2e99cd76b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8f8fb0>]}
[0m07:55:16.433997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba6fcd57-4635-4ea9-8495-a2e99cd76b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cab3e60>]}
[0m07:55:16.435185 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m07:55:16.679402 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m07:55:16.839963 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m07:55:16.840957 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m07:55:17.190787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba6fcd57-4635-4ea9-8495-a2e99cd76b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d23bc80>]}
[0m07:55:17.314304 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:55:17.343767 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:55:17.384713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba6fcd57-4635-4ea9-8495-a2e99cd76b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf338f0>]}
[0m07:55:17.385394 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m07:55:17.387646 [info ] [MainThread]: 
[0m07:55:17.388145 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m07:55:17.388558 [info ] [MainThread]: 
[0m07:55:17.389363 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m07:55:17.390487 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m07:55:17.468029 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m07:55:17.468563 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m07:55:17.468980 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m07:55:18.086492 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.617 seconds
[0m07:55:18.094835 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m07:55:18.108937 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m07:55:18.110308 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m07:55:18.214459 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.104 seconds
[0m07:55:18.220392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba6fcd57-4635-4ea9-8495-a2e99cd76b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d145910>]}
[0m07:55:18.222250 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m07:55:18.222932 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m07:55:18.223551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m07:55:18.223964 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m07:55:18.237435 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m07:55:18.238742 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m07:55:18.286483 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m07:55:18.290516 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m07:55:18.291327 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        "CENTER" AS company,
        "ADDRESS" AS address2,
        "NV" AS state,
        "CLARK" AS county,
        "346-393-9400" AS phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        License AS license_number,
        "Accepts Subsidy" AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m07:55:18.413580 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e03-0002-4299-0007-02f20001a652
[0m07:55:18.414131 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CENTER'
[0m07:55:18.419186 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:55:18.421559 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba6fcd57-4635-4ea9-8495-a2e99cd76b86', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd94e00>]}
[0m07:55:18.422439 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.20s]
[0m07:55:18.423201 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m07:55:18.423855 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m07:55:18.425694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m07:55:18.426308 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m07:55:18.426890 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m07:55:18.537422 [info ] [MainThread]: 
[0m07:55:18.538259 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m07:55:18.539269 [debug] [MainThread]: Command end result
[0m07:55:18.573581 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m07:55:18.577054 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m07:55:18.585533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m07:55:18.586072 [info ] [MainThread]: 
[0m07:55:18.586733 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m07:55:18.587358 [info ] [MainThread]: 
[0m07:55:18.588125 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m07:55:18.588677 [info ] [MainThread]: 
[0m07:55:18.589186 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m07:55:18.610259 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.062264, "process_in_blocks": "0", "process_kernel_time": 0.461282, "process_mem_max_rss": "135147520", "process_out_blocks": "0", "process_user_time": 3.298434}
[0m07:55:18.611118 [debug] [MainThread]: Command `dbt build` failed at 07:55:18.610975 after 3.06 seconds
[0m07:55:18.611607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb3d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b733c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b9e3800>]}
[0m07:55:18.612057 [debug] [MainThread]: Flushing usage events
[0m07:55:18.828042 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:00:59.921261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d09610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723b380>]}


============================== 08:00:59.926286 | b997ed4c-60fd-41c8-8054-56c09d4cf064 ==============================
[0m08:00:59.926286 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:00:59.927041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:01:00.427898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b997ed4c-60fd-41c8-8054-56c09d4cf064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107239070>]}
[0m08:01:00.499768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b997ed4c-60fd-41c8-8054-56c09d4cf064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10677aa20>]}
[0m08:01:00.500800 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:01:00.702957 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:01:00.842887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:01:00.843353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:01:00.895802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b997ed4c-60fd-41c8-8054-56c09d4cf064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108543980>]}
[0m08:01:00.988472 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:01:00.991712 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:01:01.021382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b997ed4c-60fd-41c8-8054-56c09d4cf064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108a331d0>]}
[0m08:01:01.021964 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:01:01.024017 [info ] [MainThread]: 
[0m08:01:01.024525 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:01:01.024969 [info ] [MainThread]: 
[0m08:01:01.025646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:01:01.026610 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:01:01.092881 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:01:01.093370 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:01:01.093735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:01.654764 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.561 seconds
[0m08:01:01.661741 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:01:01.673381 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:01:01.673826 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:01:01.830408 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.156 seconds
[0m08:01:01.834185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b997ed4c-60fd-41c8-8054-56c09d4cf064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fa2030>]}
[0m08:01:01.835787 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:01:01.836358 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:01:01.837001 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:01:01.837420 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:01:01.848427 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:01:01.849452 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:01:01.887272 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:01:01.890939 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:01:01.891600 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        "CENTER" AS company,
        "ADDRESS" AS address2,
        "NV" AS state,
        "CLARK" AS county,
        "346-393-9400" AS phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        License AS license_number,
        "Accepts Subsidy" AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:01:02.090982 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e09-0002-429c-0007-02f200012c9e
[0m08:01:02.091534 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 8
invalid identifier 'CENTER'
[0m08:01:02.094999 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:01:02.096858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b997ed4c-60fd-41c8-8054-56c09d4cf064', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109a33fb0>]}
[0m08:01:02.097597 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.26s]
[0m08:01:02.098363 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:01:02.099041 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:01:02.100734 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:02.101137 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:01:02.101514 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:01:02.213262 [info ] [MainThread]: 
[0m08:01:02.213909 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m08:01:02.214913 [debug] [MainThread]: Command end result
[0m08:01:02.241955 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:01:02.244508 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:01:02.252369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:01:02.252928 [info ] [MainThread]: 
[0m08:01:02.253638 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:01:02.254137 [info ] [MainThread]: 
[0m08:01:02.254720 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 24 at position 8
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:01:02.255230 [info ] [MainThread]: 
[0m08:01:02.255705 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:01:02.257290 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4776258, "process_in_blocks": "0", "process_kernel_time": 0.379278, "process_mem_max_rss": "133308416", "process_out_blocks": "0", "process_user_time": 2.570239}
[0m08:01:02.258162 [debug] [MainThread]: Command `dbt build` failed at 08:01:02.257997 after 2.48 seconds
[0m08:01:02.258697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723b4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723b410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10723b380>]}
[0m08:01:02.259373 [debug] [MainThread]: Flushing usage events
[0m08:01:02.466025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:01:13.102721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110168d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bb4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113bb200>]}


============================== 08:01:13.108652 | 7351e8aa-c1d8-4bb2-99b5-31827c59636f ==============================
[0m08:01:13.108652 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:01:13.109637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:01:13.679503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7351e8aa-c1d8-4bb2-99b5-31827c59636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f684dd0>]}
[0m08:01:13.755922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7351e8aa-c1d8-4bb2-99b5-31827c59636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114305f0>]}
[0m08:01:13.756946 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:01:13.949389 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:01:14.111871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:01:14.112624 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:01:14.447086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7351e8aa-c1d8-4bb2-99b5-31827c59636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112b73ad0>]}
[0m08:01:14.547568 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:01:14.551799 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:01:14.586821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7351e8aa-c1d8-4bb2-99b5-31827c59636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112cabec0>]}
[0m08:01:14.587461 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:01:14.589610 [info ] [MainThread]: 
[0m08:01:14.590140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:01:14.590591 [info ] [MainThread]: 
[0m08:01:14.591399 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:01:14.592871 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:01:14.655900 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:01:14.656728 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:01:14.657149 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:01:15.401935 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.745 seconds
[0m08:01:15.408928 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:01:15.421138 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:01:15.421622 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:01:15.546512 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.124 seconds
[0m08:01:15.550474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7351e8aa-c1d8-4bb2-99b5-31827c59636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bbe930>]}
[0m08:01:15.552268 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:01:15.552874 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:01:15.553486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:01:15.553908 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:01:15.564579 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:01:15.565456 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:01:15.604717 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:01:15.608034 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:01:15.608573 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        License AS license_number,
        "Accepts Subsidy" AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:01:15.734584 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e09-0002-429d-0007-02f2000199ea
[0m08:01:15.735158 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 35 at position 8
invalid identifier 'LICENSE'
[0m08:01:15.738630 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 35 at position 8
  invalid identifier 'LICENSE'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:01:15.740498 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7351e8aa-c1d8-4bb2-99b5-31827c59636f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128a6720>]}
[0m08:01:15.741233 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.19s]
[0m08:01:15.742071 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:01:15.742786 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 35 at position 8
  invalid identifier 'LICENSE'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:01:15.744481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:01:15.744866 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:01:15.745229 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:01:15.842921 [info ] [MainThread]: 
[0m08:01:15.843530 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m08:01:15.844473 [debug] [MainThread]: Command end result
[0m08:01:15.871295 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:01:15.873546 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:01:15.881610 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:01:15.882193 [info ] [MainThread]: 
[0m08:01:15.882818 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:01:15.883429 [info ] [MainThread]: 
[0m08:01:15.884054 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 35 at position 8
  invalid identifier 'LICENSE'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:01:15.884478 [info ] [MainThread]: 
[0m08:01:15.884913 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:01:15.886128 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.9284608, "process_in_blocks": "0", "process_kernel_time": 0.408998, "process_mem_max_rss": "135737344", "process_out_blocks": "0", "process_user_time": 3.011452}
[0m08:01:15.886880 [debug] [MainThread]: Command `dbt build` failed at 08:01:15.886739 after 2.93 seconds
[0m08:01:15.887369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110168d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11100aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cc2e70>]}
[0m08:01:15.887818 [debug] [MainThread]: Flushing usage events
[0m08:01:16.084656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:04:57.073601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfcbd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db0f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db0f200>]}


============================== 08:04:57.078940 | bd6a29aa-d6cf-4659-ba4b-68384b04e101 ==============================
[0m08:04:57.078940 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:04:57.079820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:04:57.490637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd6a29aa-d6cf-4659-ba4b-68384b04e101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db0f2f0>]}
[0m08:04:57.566781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd6a29aa-d6cf-4659-ba4b-68384b04e101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfcbe30>]}
[0m08:04:57.567822 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:04:57.765961 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:04:57.916319 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:04:57.917107 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:04:58.284328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd6a29aa-d6cf-4659-ba4b-68384b04e101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed3bfe0>]}
[0m08:04:58.382051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:04:58.385297 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:04:58.418078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd6a29aa-d6cf-4659-ba4b-68384b04e101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1a3c50>]}
[0m08:04:58.418696 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:04:58.421709 [info ] [MainThread]: 
[0m08:04:58.422286 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:04:58.422727 [info ] [MainThread]: 
[0m08:04:58.423452 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:04:58.424515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:04:58.490164 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:04:58.490695 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:04:58.491098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:04:59.122008 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.631 seconds
[0m08:04:59.128557 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:04:59.140708 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:04:59.141203 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:04:59.298685 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.157 seconds
[0m08:04:59.302546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd6a29aa-d6cf-4659-ba4b-68384b04e101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f43b980>]}
[0m08:04:59.304462 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:04:59.305423 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:04:59.306822 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:04:59.307536 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:04:59.319676 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:04:59.320773 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:04:59.360391 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:04:59.363863 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:04:59.364498 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
       -- License AS license_number,
        "Accepts Subsidy" AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
   -- source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:04:59.505592 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e0c-0002-429c-0007-02f200012ca6
[0m08:04:59.506331 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 36 at position 8
invalid identifier '"Accepts Subsidy"'
[0m08:04:59.509766 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier '"Accepts Subsidy"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:04:59.511596 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd6a29aa-d6cf-4659-ba4b-68384b04e101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f195520>]}
[0m08:04:59.512428 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.20s]
[0m08:04:59.513207 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:04:59.513858 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier '"Accepts Subsidy"'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:04:59.515520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:04:59.515874 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:04:59.516230 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:04:59.617080 [info ] [MainThread]: 
[0m08:04:59.617712 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m08:04:59.618621 [debug] [MainThread]: Command end result
[0m08:04:59.664870 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:04:59.667106 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:04:59.674691 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:04:59.675147 [info ] [MainThread]: 
[0m08:04:59.675717 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:04:59.676186 [info ] [MainThread]: 
[0m08:04:59.676701 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier '"Accepts Subsidy"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:04:59.677143 [info ] [MainThread]: 
[0m08:04:59.677570 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:04:59.719351 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.7947361, "process_in_blocks": "0", "process_kernel_time": 0.399897, "process_mem_max_rss": "135479296", "process_out_blocks": "0", "process_user_time": 3.048637}
[0m08:04:59.720121 [debug] [MainThread]: Command `dbt build` failed at 08:04:59.719985 after 2.80 seconds
[0m08:04:59.720661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d767da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110466ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110467bf0>]}
[0m08:04:59.721406 [debug] [MainThread]: Flushing usage events
[0m08:04:59.922367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:08:04.769953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103426990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cf6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040cf410>]}


============================== 08:08:04.775000 | 1dbb6e49-2df5-4090-9446-5eeccc86d91c ==============================
[0m08:08:04.775000 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:08:04.775778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:08:05.288758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1dbb6e49-2df5-4090-9446-5eeccc86d91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105302f30>]}
[0m08:08:05.361939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1dbb6e49-2df5-4090-9446-5eeccc86d91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105336e70>]}
[0m08:08:05.362955 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:08:05.543556 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:08:05.686743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:08:05.687483 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:08:06.007861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dbb6e49-2df5-4090-9446-5eeccc86d91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10587fad0>]}
[0m08:08:06.101550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:08:06.104948 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:08:06.136111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dbb6e49-2df5-4090-9446-5eeccc86d91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059bfe00>]}
[0m08:08:06.136727 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:08:06.139631 [info ] [MainThread]: 
[0m08:08:06.140131 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:08:06.140530 [info ] [MainThread]: 
[0m08:08:06.141165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:08:06.142273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:08:06.204588 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:08:06.205116 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:08:06.205518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:08:06.812179 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.607 seconds
[0m08:08:06.818725 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:08:06.829831 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:08:06.830249 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:08:06.981434 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.151 seconds
[0m08:08:06.985254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dbb6e49-2df5-4090-9446-5eeccc86d91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b0bc20>]}
[0m08:08:06.986802 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:08:06.987375 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:08:06.988040 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:08:06.988460 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:08:06.998995 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:08:07.000218 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:08:07.038150 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:08:07.041457 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:08:07.042065 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
       TYPELICENSE AS license_number,
        "Accepts Subsidy" AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
   -- source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:08:07.130206 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e10-0002-429d-0007-02f2000199f6
[0m08:08:07.130748 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 36 at position 8
invalid identifier '"Accepts Subsidy"'
[0m08:08:07.134371 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier '"Accepts Subsidy"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:08:07.136205 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dbb6e49-2df5-4090-9446-5eeccc86d91c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103508da0>]}
[0m08:08:07.136937 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.15s]
[0m08:08:07.137846 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:08:07.138495 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier '"Accepts Subsidy"'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:08:07.140284 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:08:07.140644 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:08:07.141006 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:08:07.266205 [info ] [MainThread]: 
[0m08:08:07.266816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.13 seconds (1.13s).
[0m08:08:07.267787 [debug] [MainThread]: Command end result
[0m08:08:07.295378 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:08:07.297761 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:08:07.304439 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:08:07.304834 [info ] [MainThread]: 
[0m08:08:07.305396 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:08:07.305909 [info ] [MainThread]: 
[0m08:08:07.306462 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 36 at position 8
  invalid identifier '"Accepts Subsidy"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:08:07.306876 [info ] [MainThread]: 
[0m08:08:07.307310 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:08:07.308586 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.6861844, "process_in_blocks": "0", "process_kernel_time": 0.37746, "process_mem_max_rss": "133365760", "process_out_blocks": "0", "process_user_time": 2.954274}
[0m08:08:07.309257 [debug] [MainThread]: Command `dbt build` failed at 08:08:07.309124 after 2.69 seconds
[0m08:08:07.309732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c77a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069c6cf0>]}
[0m08:08:07.310170 [debug] [MainThread]: Flushing usage events
[0m08:08:07.515617 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:09:02.953680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119cfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138475c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113847350>]}


============================== 08:09:02.958766 | 6b113ee2-0c56-456e-ab3d-ac3f5353215f ==============================
[0m08:09:02.958766 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:09:02.959571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:09:03.404294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b113ee2-0c56-456e-ab3d-ac3f5353215f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114833a40>]}
[0m08:09:03.475391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b113ee2-0c56-456e-ab3d-ac3f5353215f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a99bb0>]}
[0m08:09:03.476491 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:09:03.659242 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:09:03.799049 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:09:03.799802 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:09:04.114103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b113ee2-0c56-456e-ab3d-ac3f5353215f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11505f740>]}
[0m08:09:04.209480 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:09:04.213443 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:09:04.276913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b113ee2-0c56-456e-ab3d-ac3f5353215f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151679b0>]}
[0m08:09:04.277517 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:09:04.279577 [info ] [MainThread]: 
[0m08:09:04.280082 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:09:04.280527 [info ] [MainThread]: 
[0m08:09:04.281193 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:09:04.282345 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:09:04.342930 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:09:04.343422 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:09:04.343865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:09:04.932334 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.588 seconds
[0m08:09:04.938813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:09:04.950212 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:09:04.950663 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:09:05.071183 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.120 seconds
[0m08:09:05.075072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b113ee2-0c56-456e-ab3d-ac3f5353215f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150374d0>]}
[0m08:09:05.076620 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:09:05.077195 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:09:05.077814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:09:05.078229 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:09:05.088887 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:09:05.090186 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:09:05.128076 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:09:05.131324 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:09:05.131836 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
         Name AS company,
         ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:09:05.253052 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e11-0002-4298-0000-000702f2fd89
[0m08:09:05.253673 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier '"Year Round"'
[0m08:09:05.257291 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier '"Year Round"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:09:05.259114 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b113ee2-0c56-456e-ab3d-ac3f5353215f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112ca9760>]}
[0m08:09:05.259820 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.18s]
[0m08:09:05.260619 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:09:05.261243 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier '"Year Round"'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:09:05.262921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:09:05.263279 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:09:05.263638 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:09:05.458695 [info ] [MainThread]: 
[0m08:09:05.459312 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.18 seconds (1.18s).
[0m08:09:05.460249 [debug] [MainThread]: Command end result
[0m08:09:05.486506 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:09:05.488812 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:09:05.524366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:09:05.524826 [info ] [MainThread]: 
[0m08:09:05.525389 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:09:05.525859 [info ] [MainThread]: 
[0m08:09:05.526394 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier '"Year Round"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:09:05.526844 [info ] [MainThread]: 
[0m08:09:05.527358 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:09:05.542217 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.7144341, "process_in_blocks": "0", "process_kernel_time": 0.375177, "process_mem_max_rss": "135790592", "process_out_blocks": "0", "process_user_time": 2.905861}
[0m08:09:05.543089 [debug] [MainThread]: Command `dbt build` failed at 08:09:05.542939 after 2.72 seconds
[0m08:09:05.543732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128b5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136a5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161a6ed0>]}
[0m08:09:05.544154 [debug] [MainThread]: Flushing usage events
[0m08:09:05.733579 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:11:15.781651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a52bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcb6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcb440>]}


============================== 08:11:15.862295 | 8d7c8889-5ec0-4871-912d-5b26c2271094 ==============================
[0m08:11:15.862295 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:11:15.863203 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:11:17.355673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d7c8889-5ec0-4871-912d-5b26c2271094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d69460>]}
[0m08:11:17.426855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d7c8889-5ec0-4871-912d-5b26c2271094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076d09b0>]}
[0m08:11:17.428074 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:11:17.864956 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:11:18.172299 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:11:18.172941 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:11:18.231786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d7c8889-5ec0-4871-912d-5b26c2271094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108dc0ec0>]}
[0m08:11:18.335428 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:11:18.419632 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:11:19.185480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d7c8889-5ec0-4871-912d-5b26c2271094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926b500>]}
[0m08:11:19.186070 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:11:19.188121 [info ] [MainThread]: 
[0m08:11:19.188655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:11:19.189093 [info ] [MainThread]: 
[0m08:11:19.189773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:11:19.190756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:11:19.307802 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:11:19.308332 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:11:19.308746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:11:20.140520 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.832 seconds
[0m08:11:20.147513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:11:20.159685 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:11:20.160174 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:11:20.255819 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.095 seconds
[0m08:11:20.260178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d7c8889-5ec0-4871-912d-5b26c2271094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108da3080>]}
[0m08:11:20.262159 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:11:20.262742 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:11:20.263340 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:11:20.263905 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:11:20.275161 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:11:20.276197 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:11:20.315888 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:11:20.319136 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:11:20.319753 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
         Name AS company,
         ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        "Year Round" AS schedule,
        "Star Level" AS facility_type,
        "Total Cap" AS capacity,
        "Monitoring since" AS license_issued,
        "Monitoring since" AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        "Operation Name" AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:11:21.598911 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e13-0002-4299-0007-02f20001a66e
[0m08:11:21.599460 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 37 at position 8
invalid identifier '"Year Round"'
[0m08:11:21.721687 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier '"Year Round"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:11:21.758175 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8d7c8889-5ec0-4871-912d-5b26c2271094', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107015340>]}
[0m08:11:21.759233 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 1.46s]
[0m08:11:21.760060 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:11:21.760698 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier '"Year Round"'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:11:21.762376 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:11:21.762731 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:11:21.763088 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:11:21.902707 [info ] [MainThread]: 
[0m08:11:21.903338 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.71 seconds (2.71s).
[0m08:11:21.904260 [debug] [MainThread]: Command end result
[0m08:11:21.951466 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:11:21.953347 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:11:21.959949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:11:21.960414 [info ] [MainThread]: 
[0m08:11:21.960953 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:11:21.961423 [info ] [MainThread]: 
[0m08:11:21.961959 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 37 at position 8
  invalid identifier '"Year Round"'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:11:21.962481 [info ] [MainThread]: 
[0m08:11:21.962964 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:11:22.003225 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.5922117, "process_in_blocks": "0", "process_kernel_time": 0.472712, "process_mem_max_rss": "132669440", "process_out_blocks": "0", "process_user_time": 2.800524}
[0m08:11:22.004054 [debug] [MainThread]: Command `dbt build` failed at 08:11:22.003920 after 6.59 seconds
[0m08:11:22.004532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a52bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bcb410>]}
[0m08:11:22.004963 [debug] [MainThread]: Flushing usage events
[0m08:11:22.241821 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:12:00.059954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e35b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e57680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e57410>]}


============================== 08:12:00.101615 | 12149e8a-f31c-4cbf-83c3-d461f253931c ==============================
[0m08:12:00.101615 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:12:00.102384 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:12:00.969998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '12149e8a-f31c-4cbf-83c3-d461f253931c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108104590>]}
[0m08:12:01.066644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '12149e8a-f31c-4cbf-83c3-d461f253931c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f728d0>]}
[0m08:12:01.067926 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:12:01.293390 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:12:01.435265 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:12:01.436038 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:12:01.763530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '12149e8a-f31c-4cbf-83c3-d461f253931c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108673ad0>]}
[0m08:12:01.862391 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:12:01.866236 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:12:01.900547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '12149e8a-f31c-4cbf-83c3-d461f253931c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10877bfb0>]}
[0m08:12:01.901168 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:12:01.903341 [info ] [MainThread]: 
[0m08:12:01.903880 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:12:01.904338 [info ] [MainThread]: 
[0m08:12:01.905019 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:12:01.906389 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:12:01.969206 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:12:01.969730 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:12:01.970138 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:12:02.585219 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.615 seconds
[0m08:12:02.592431 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:12:02.604287 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:12:02.604761 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:12:02.765975 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.161 seconds
[0m08:12:02.769866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '12149e8a-f31c-4cbf-83c3-d461f253931c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10835e210>]}
[0m08:12:02.771422 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:12:02.771987 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:12:02.772597 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:12:02.773128 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:12:02.784107 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:12:02.785008 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:12:02.824376 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:12:02.828164 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:12:02.828768 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s2.facility_type,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:12:05.104251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.275 seconds
[0m08:12:05.147963 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '12149e8a-f31c-4cbf-83c3-d461f253931c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10516bad0>]}
[0m08:12:05.148855 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.36s]
[0m08:12:05.149664 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:12:05.151138 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:12:05.151491 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:12:05.151848 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:12:05.265141 [info ] [MainThread]: 
[0m08:12:05.265776 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.36 seconds (3.36s).
[0m08:12:05.266824 [debug] [MainThread]: Command end result
[0m08:12:05.293630 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:12:05.296465 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:12:05.303704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:12:05.304228 [info ] [MainThread]: 
[0m08:12:05.304760 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:12:05.305198 [info ] [MainThread]: 
[0m08:12:05.305711 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:12:05.334632 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.4689946, "process_in_blocks": "0", "process_kernel_time": 0.436931, "process_mem_max_rss": "135299072", "process_out_blocks": "0", "process_user_time": 3.182186}
[0m08:12:05.335552 [debug] [MainThread]: Command `dbt build` succeeded at 08:12:05.335398 after 5.47 seconds
[0m08:12:05.336077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e817c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b55070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109797020>]}
[0m08:12:05.336541 [debug] [MainThread]: Flushing usage events
[0m08:12:05.526941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:15:32.113111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d90920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe3380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fe3110>]}


============================== 08:15:32.176658 | fa829db7-03a2-46e4-8dd4-d3014c58bbe9 ==============================
[0m08:15:32.176658 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:15:32.177585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m08:15:33.069341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae53680>]}
[0m08:15:33.144769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a008bf0>]}
[0m08:15:33.146061 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:15:33.387448 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:15:33.713546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:15:33.714323 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:15:34.047501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81fa10>]}
[0m08:15:34.145017 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:15:34.242325 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:15:34.344156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b534500>]}
[0m08:15:34.344760 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:15:34.345226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b81ad50>]}
[0m08:15:34.347518 [info ] [MainThread]: 
[0m08:15:34.348015 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:15:34.348449 [info ] [MainThread]: 
[0m08:15:34.349137 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:15:34.355877 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:15:34.516473 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:15:34.518025 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:15:34.518412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:15:35.245362 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.727 seconds
[0m08:15:35.248195 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:15:35.259875 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:15:35.260464 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:15:35.350664 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.090 seconds
[0m08:15:35.354537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b67f7a0>]}
[0m08:15:35.355925 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:15:35.356490 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:15:35.357096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:15:35.357505 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:15:35.369475 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:15:35.371028 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:15:35.495819 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:15:35.499477 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:15:35.500054 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:15:35.905564 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e17-0002-4296-0007-02f200010d5a
[0m08:15:35.906116 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 82 at position 4
invalid identifier 'SOURCE_S3.LICENSE_ISSUED_DATE'
[0m08:15:35.912735 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 82 at position 4
  invalid identifier 'SOURCE_S3.LICENSE_ISSUED_DATE'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:15:35.914983 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10941d490>]}
[0m08:15:35.915858 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.56s]
[0m08:15:35.916697 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:15:35.917168 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m08:15:35.917852 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 82 at position 4
  invalid identifier 'SOURCE_S3.LICENSE_ISSUED_DATE'
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:15:35.918428 [info ] [Thread-1 (]: 2 of 3 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m08:15:35.919845 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now model.snowflake.my_first_dbt_model)
[0m08:15:35.920274 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m08:15:35.924371 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m08:15:35.925717 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m08:15:35.931373 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m08:15:35.932718 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m08:15:35.933160 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m08:15:37.912150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.979 seconds
[0m08:15:37.940517 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10828b9b0>]}
[0m08:15:37.941344 [info ] [Thread-1 (]: 2 of 3 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 2.02s]
[0m08:15:37.942129 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m08:15:37.943036 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m08:15:37.943551 [info ] [Thread-1 (]: 3 of 3 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m08:15:37.944095 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m08:15:37.944580 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m08:15:37.948597 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m08:15:37.966067 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m08:15:37.992494 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m08:15:37.993576 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m08:15:37.994007 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m08:15:38.164528 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m08:15:38.167308 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fa829db7-03a2-46e4-8dd4-d3014c58bbe9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b233bc0>]}
[0m08:15:38.167988 [info ] [Thread-1 (]: 3 of 3 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.22s]
[0m08:15:38.168776 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m08:15:38.170149 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:15:38.170500 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m08:15:38.170893 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m08:15:38.271705 [info ] [MainThread]: 
[0m08:15:38.272426 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m08:15:38.273680 [debug] [MainThread]: Command end result
[0m08:15:38.303077 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:15:38.305319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:15:38.312545 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:15:38.313351 [info ] [MainThread]: 
[0m08:15:38.314231 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:15:38.314718 [info ] [MainThread]: 
[0m08:15:38.315440 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 82 at position 4
  invalid identifier 'SOURCE_S3.LICENSE_ISSUED_DATE'
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:15:38.315902 [info ] [MainThread]: 
[0m08:15:38.316382 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:15:38.392345 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.4821334, "process_in_blocks": "0", "process_kernel_time": 0.503718, "process_mem_max_rss": "131817472", "process_out_blocks": "0", "process_user_time": 3.202155}
[0m08:15:38.393127 [debug] [MainThread]: Command `dbt run` failed at 08:15:38.392995 after 6.48 seconds
[0m08:15:38.393591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b751d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b751a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c721a90>]}
[0m08:15:38.394448 [debug] [MainThread]: Flushing usage events
[0m08:15:38.657272 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:17:28.588468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c14eba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c16ef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c16edb0>]}


============================== 08:17:28.611227 | 59536d01-b172-4a97-8ba7-c30e15ef9930 ==============================
[0m08:17:28.611227 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:17:28.612011 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:17:29.130017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c127b90>]}
[0m08:17:29.211808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6940b0>]}
[0m08:17:29.212828 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:17:29.404275 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:17:29.556119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:17:29.556886 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:17:29.909297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d886240>]}
[0m08:17:30.012186 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:17:30.015460 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:17:30.033715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6c00e0>]}
[0m08:17:30.034421 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:17:30.035435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97e8d0>]}
[0m08:17:30.037926 [info ] [MainThread]: 
[0m08:17:30.038386 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:17:30.038782 [info ] [MainThread]: 
[0m08:17:30.039637 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:17:30.046987 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:17:30.117436 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:17:30.118122 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:17:30.118515 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:17:30.695639 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.577 seconds
[0m08:17:30.698466 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:17:30.711605 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:17:30.712095 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:17:30.812254 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.100 seconds
[0m08:17:30.816085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3c7770>]}
[0m08:17:30.818633 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:17:30.819428 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:17:30.820080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:17:30.820501 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:17:30.831519 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:17:30.832388 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:17:30.958296 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:17:30.962084 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:17:30.962619 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        Issue Date AS license_issued_date,
        Monitoring Frequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:17:31.049608 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e19-0002-42a4-0007-02f200015c76
[0m08:17:31.050147 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 19 unexpected 'AS'.
syntax error line 60 at position 19 unexpected 'Frequency'.
syntax error line 61 at position 8 unexpected ''Audit Date''.
syntax error line 61 at position 24 unexpected 'audit_date'.
syntax error line 62 at position 8 unexpected ''Audit Notes''.
syntax error line 62 at position 25 unexpected 'audit_notes'.
syntax error line 63 at position 4 unexpected 'FROM'.
syntax error line 67 at position 0 unexpected 'SELECT'.
[0m08:17:31.054321 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 19 unexpected 'AS'.
  syntax error line 60 at position 19 unexpected 'Frequency'.
  syntax error line 61 at position 8 unexpected ''Audit Date''.
  syntax error line 61 at position 24 unexpected 'audit_date'.
  syntax error line 62 at position 8 unexpected ''Audit Notes''.
  syntax error line 62 at position 25 unexpected 'audit_notes'.
  syntax error line 63 at position 4 unexpected 'FROM'.
  syntax error line 67 at position 0 unexpected 'SELECT'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:17:31.056245 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5dd070>]}
[0m08:17:31.056954 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.23s]
[0m08:17:31.057845 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:17:31.058363 [debug] [Thread-1 (]: Began running node model.snowflake.my_first_dbt_model
[0m08:17:31.058987 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 19 unexpected 'AS'.
  syntax error line 60 at position 19 unexpected 'Frequency'.
  syntax error line 61 at position 8 unexpected ''Audit Date''.
  syntax error line 61 at position 24 unexpected 'audit_date'.
  syntax error line 62 at position 8 unexpected ''Audit Notes''.
  syntax error line 62 at position 25 unexpected 'audit_notes'.
  syntax error line 63 at position 4 unexpected 'FROM'.
  syntax error line 67 at position 0 unexpected 'SELECT'.
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:17:31.059547 [info ] [Thread-1 (]: 2 of 3 START sql table model STG.my_first_dbt_model ............................ [RUN]
[0m08:17:31.060937 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now model.snowflake.my_first_dbt_model)
[0m08:17:31.061357 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_first_dbt_model
[0m08:17:31.065224 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_first_dbt_model"
[0m08:17:31.066207 [debug] [Thread-1 (]: Began executing node model.snowflake.my_first_dbt_model
[0m08:17:31.072535 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_first_dbt_model"
[0m08:17:31.074017 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_first_dbt_model"
[0m08:17:31.074466 [debug] [Thread-1 (]: On model.snowflake.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_first_dbt_model"} */
create or replace transient table DBT_TEST.STG.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m08:17:32.915684 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.841 seconds
[0m08:17:32.944643 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a483bf0>]}
[0m08:17:32.945467 [info ] [Thread-1 (]: 2 of 3 OK created sql table model STG.my_first_dbt_model ....................... [[32mSUCCESS 1[0m in 1.88s]
[0m08:17:32.946284 [debug] [Thread-1 (]: Finished running node model.snowflake.my_first_dbt_model
[0m08:17:32.947110 [debug] [Thread-1 (]: Began running node model.snowflake.my_second_dbt_model
[0m08:17:32.947810 [info ] [Thread-1 (]: 3 of 3 START sql view model STG.my_second_dbt_model ............................ [RUN]
[0m08:17:32.948486 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.my_first_dbt_model, now model.snowflake.my_second_dbt_model)
[0m08:17:32.948907 [debug] [Thread-1 (]: Began compiling node model.snowflake.my_second_dbt_model
[0m08:17:32.953686 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.my_second_dbt_model"
[0m08:17:32.954712 [debug] [Thread-1 (]: Began executing node model.snowflake.my_second_dbt_model
[0m08:17:32.988835 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.my_second_dbt_model"
[0m08:17:32.990078 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.my_second_dbt_model"
[0m08:17:32.990528 [debug] [Thread-1 (]: On model.snowflake.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.my_second_dbt_model"} */
create or replace   view DBT_TEST.STG.my_second_dbt_model
  
   as (
    -- Use the `ref` function to select from other models

select *
from DBT_TEST.STG.my_first_dbt_model
where id = 1
  );
[0m08:17:33.182845 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.192 seconds
[0m08:17:33.185627 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59536d01-b172-4a97-8ba7-c30e15ef9930', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6b4320>]}
[0m08:17:33.186540 [info ] [Thread-1 (]: 3 of 3 OK created sql view model STG.my_second_dbt_model ....................... [[32mSUCCESS 1[0m in 0.24s]
[0m08:17:33.187418 [debug] [Thread-1 (]: Finished running node model.snowflake.my_second_dbt_model
[0m08:17:33.189083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:17:33.189478 [debug] [MainThread]: Connection 'model.snowflake.my_second_dbt_model' was left open.
[0m08:17:33.189879 [debug] [MainThread]: On model.snowflake.my_second_dbt_model: Close
[0m08:17:33.288866 [info ] [MainThread]: 
[0m08:17:33.289668 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m08:17:33.290994 [debug] [MainThread]: Command end result
[0m08:17:33.318276 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:17:33.320891 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:17:33.329298 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:17:33.329803 [info ] [MainThread]: 
[0m08:17:33.330371 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:17:33.330837 [info ] [MainThread]: 
[0m08:17:33.331381 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 19 unexpected 'AS'.
  syntax error line 60 at position 19 unexpected 'Frequency'.
  syntax error line 61 at position 8 unexpected ''Audit Date''.
  syntax error line 61 at position 24 unexpected 'audit_date'.
  syntax error line 62 at position 8 unexpected ''Audit Notes''.
  syntax error line 62 at position 25 unexpected 'audit_notes'.
  syntax error line 63 at position 4 unexpected 'FROM'.
  syntax error line 67 at position 0 unexpected 'SELECT'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:17:33.331876 [info ] [MainThread]: 
[0m08:17:33.332349 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:17:33.333514 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 4.9677396, "process_in_blocks": "0", "process_kernel_time": 0.472857, "process_mem_max_rss": "133079040", "process_out_blocks": "0", "process_user_time": 3.251046}
[0m08:17:33.334158 [debug] [MainThread]: Command `dbt run` failed at 08:17:33.334018 after 4.97 seconds
[0m08:17:33.334628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8dc380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8dd6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9dcaa0>]}
[0m08:17:33.335084 [debug] [MainThread]: Flushing usage events
[0m08:17:33.552573 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:20:01.729726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d583c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd9a150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1a3380>]}


============================== 08:20:01.734884 | 4ee915ea-ea35-45f1-8769-4e21a874d9a1 ==============================
[0m08:20:01.734884 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:20:01.735691 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:20:02.108997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ee915ea-ea35-45f1-8769-4e21a874d9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c470ad0>]}
[0m08:20:02.180243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ee915ea-ea35-45f1-8769-4e21a874d9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3a8350>]}
[0m08:20:02.181276 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:20:02.370396 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:20:02.516033 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:20:02.516547 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:20:02.571255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ee915ea-ea35-45f1-8769-4e21a874d9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8484d0>]}
[0m08:20:02.670447 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:20:02.673700 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:20:02.995954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ee915ea-ea35-45f1-8769-4e21a874d9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa0f8f0>]}
[0m08:20:02.996555 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:20:02.998624 [info ] [MainThread]: 
[0m08:20:02.999191 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:20:02.999634 [info ] [MainThread]: 
[0m08:20:03.000311 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:20:03.001275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:20:03.067394 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:20:03.067879 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:20:03.068245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:20:03.551733 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.483 seconds
[0m08:20:03.558348 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:20:03.569655 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:20:03.570080 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:20:03.690434 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.120 seconds
[0m08:20:03.694316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ee915ea-ea35-45f1-8769-4e21a874d9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c4fd760>]}
[0m08:20:03.695936 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:20:03.696515 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:20:03.697123 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:20:03.697541 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:20:03.708221 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:20:03.709481 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:20:03.750257 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:20:03.754226 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:20:03.754836 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        Issue Date AS license_issued_date,
        Monitoring Frequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:20:03.841881 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e1c-0002-4297-0007-02f200017cae
[0m08:20:03.842441 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 59 at position 19 unexpected 'AS'.
syntax error line 60 at position 19 unexpected 'Frequency'.
syntax error line 61 at position 8 unexpected ''Audit Date''.
syntax error line 61 at position 24 unexpected 'audit_date'.
syntax error line 62 at position 8 unexpected ''Audit Notes''.
syntax error line 62 at position 25 unexpected 'audit_notes'.
syntax error line 63 at position 4 unexpected 'FROM'.
syntax error line 67 at position 0 unexpected 'SELECT'.
[0m08:20:03.845889 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 19 unexpected 'AS'.
  syntax error line 60 at position 19 unexpected 'Frequency'.
  syntax error line 61 at position 8 unexpected ''Audit Date''.
  syntax error line 61 at position 24 unexpected 'audit_date'.
  syntax error line 62 at position 8 unexpected ''Audit Notes''.
  syntax error line 62 at position 25 unexpected 'audit_notes'.
  syntax error line 63 at position 4 unexpected 'FROM'.
  syntax error line 67 at position 0 unexpected 'SELECT'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:20:03.847706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ee915ea-ea35-45f1-8769-4e21a874d9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a83320>]}
[0m08:20:03.848413 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.15s]
[0m08:20:03.849236 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:20:03.849891 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 19 unexpected 'AS'.
  syntax error line 60 at position 19 unexpected 'Frequency'.
  syntax error line 61 at position 8 unexpected ''Audit Date''.
  syntax error line 61 at position 24 unexpected 'audit_date'.
  syntax error line 62 at position 8 unexpected ''Audit Notes''.
  syntax error line 62 at position 25 unexpected 'audit_notes'.
  syntax error line 63 at position 4 unexpected 'FROM'.
  syntax error line 67 at position 0 unexpected 'SELECT'.
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:20:03.851564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:20:03.851914 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:20:03.852272 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:20:03.980543 [info ] [MainThread]: 
[0m08:20:03.981176 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.98 seconds (0.98s).
[0m08:20:03.982120 [debug] [MainThread]: Command end result
[0m08:20:04.025382 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:20:04.027289 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:20:04.033803 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:20:04.034175 [info ] [MainThread]: 
[0m08:20:04.034740 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:20:04.035214 [info ] [MainThread]: 
[0m08:20:04.035773 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 59 at position 19 unexpected 'AS'.
  syntax error line 60 at position 19 unexpected 'Frequency'.
  syntax error line 61 at position 8 unexpected ''Audit Date''.
  syntax error line 61 at position 24 unexpected 'audit_date'.
  syntax error line 62 at position 8 unexpected ''Audit Notes''.
  syntax error line 62 at position 25 unexpected 'audit_notes'.
  syntax error line 63 at position 4 unexpected 'FROM'.
  syntax error line 67 at position 0 unexpected 'SELECT'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:20:04.036321 [info ] [MainThread]: 
[0m08:20:04.036843 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:20:04.038163 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4330225, "process_in_blocks": "0", "process_kernel_time": 0.372637, "process_mem_max_rss": "131940352", "process_out_blocks": "0", "process_user_time": 2.589612}
[0m08:20:04.038893 [debug] [MainThread]: Command `dbt build` failed at 08:20:04.038756 after 2.43 seconds
[0m08:20:04.039394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1569f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8aa2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1a3380>]}
[0m08:20:04.040298 [debug] [MainThread]: Flushing usage events
[0m08:20:04.302702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:19.324445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e278710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c7350>]}


============================== 08:22:19.329697 | 7ab7f9bc-5aa8-4acc-836e-67dd0626df20 ==============================
[0m08:22:19.329697 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:22:19.330617 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:22:19.740322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ab7f9bc-5aa8-4acc-836e-67dd0626df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d794b60>]}
[0m08:22:19.812697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ab7f9bc-5aa8-4acc-836e-67dd0626df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4c4b60>]}
[0m08:22:19.813892 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:22:19.994769 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:22:20.135989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:22:20.136733 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:22:20.461963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ab7f9bc-5aa8-4acc-836e-67dd0626df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ce6db0>]}
[0m08:22:20.562912 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:22:20.567087 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:22:20.601495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ab7f9bc-5aa8-4acc-836e-67dd0626df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f43e60>]}
[0m08:22:20.602126 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:22:20.604284 [info ] [MainThread]: 
[0m08:22:20.604833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:22:20.605320 [info ] [MainThread]: 
[0m08:22:20.606256 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:22:20.607466 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:22:20.669957 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:22:20.670492 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:22:20.670907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:21.253674 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.583 seconds
[0m08:22:21.260814 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:22:21.272984 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:22:21.273540 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:22:21.385631 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.112 seconds
[0m08:22:21.390060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ab7f9bc-5aa8-4acc-836e-67dd0626df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f43e60>]}
[0m08:22:21.392029 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:22:21.392718 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:22:21.393471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:22:21.394143 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:22:21.405762 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:22:21.406883 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:22:21.448205 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:22:21.451691 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:22:21.452434 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency' AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:22:21.554341 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e1e-0002-4296-0007-02f200010d5e
[0m08:22:21.554885 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
        ''.
parse error line 106 at position 10 near '<EOF>'.
[0m08:22:21.558376 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
          ''.
  parse error line 106 at position 10 near '<EOF>'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:22:21.560185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ab7f9bc-5aa8-4acc-836e-67dd0626df20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e909070>]}
[0m08:22:21.560893 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.17s]
[0m08:22:21.561690 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:22:21.562563 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
          ''.
  parse error line 106 at position 10 near '<EOF>'.
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:22:21.564455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:21.564818 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:22:21.565180 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:22:21.755786 [info ] [MainThread]: 
[0m08:22:21.756504 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.15 seconds (1.15s).
[0m08:22:21.757464 [debug] [MainThread]: Command end result
[0m08:22:21.804791 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:22:21.807077 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:22:21.815507 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:22:21.816453 [info ] [MainThread]: 
[0m08:22:21.817011 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:22:21.817481 [info ] [MainThread]: 
[0m08:22:21.817986 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
          ''.
  parse error line 106 at position 10 near '<EOF>'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:22:21.818406 [info ] [MainThread]: 
[0m08:22:21.818901 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:22:21.820122 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.6390216, "process_in_blocks": "0", "process_kernel_time": 0.386435, "process_mem_max_rss": "135385088", "process_out_blocks": "0", "process_user_time": 3.023733}
[0m08:22:21.821139 [debug] [MainThread]: Command `dbt build` failed at 08:22:21.820931 after 2.64 seconds
[0m08:22:21.821848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127bf80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f0f7d0>]}
[0m08:22:21.822425 [debug] [MainThread]: Flushing usage events
[0m08:22:22.068002 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:22:27.668329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c817740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8174a0>]}


============================== 08:22:27.673756 | fd353a59-6e08-4e83-a91d-2d1c892d0637 ==============================
[0m08:22:27.673756 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:22:27.674723 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:22:28.057720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fd353a59-6e08-4e83-a91d-2d1c892d0637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7ec830>]}
[0m08:22:28.129444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fd353a59-6e08-4e83-a91d-2d1c892d0637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c83d190>]}
[0m08:22:28.130479 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:22:28.311841 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:22:28.454474 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:22:28.455047 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:22:28.509028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd353a59-6e08-4e83-a91d-2d1c892d0637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dac0d40>]}
[0m08:22:28.603189 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:22:28.606485 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:22:28.636859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fd353a59-6e08-4e83-a91d-2d1c892d0637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db3f1d0>]}
[0m08:22:28.637455 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:22:28.639546 [info ] [MainThread]: 
[0m08:22:28.640055 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:22:28.640496 [info ] [MainThread]: 
[0m08:22:28.641177 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:22:28.642140 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:22:28.706998 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:22:28.707485 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:22:28.707849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:29.167464 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.460 seconds
[0m08:22:29.174018 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:22:29.185149 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:22:29.185634 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:22:29.329274 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.143 seconds
[0m08:22:29.333071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fd353a59-6e08-4e83-a91d-2d1c892d0637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d92e1b0>]}
[0m08:22:29.334661 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:22:29.335234 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:22:29.335855 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:22:29.336273 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:22:29.347717 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:22:29.349247 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:22:29.386549 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:22:29.389306 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:22:29.389843 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency' AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:22:29.489870 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e1e-0002-4297-0007-02f200017cb6
[0m08:22:29.490409 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
        ''.
parse error line 106 at position 10 near '<EOF>'.
[0m08:22:29.493794 [debug] [Thread-1 (]: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
          ''.
  parse error line 106 at position 10 near '<EOF>'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:22:29.495752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd353a59-6e08-4e83-a91d-2d1c892d0637', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db648c0>]}
[0m08:22:29.496460 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.16s]
[0m08:22:29.497335 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:22:29.497976 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
          ''.
  parse error line 106 at position 10 near '<EOF>'.
  compiled code at target/run/snowflake/models/fct_leads.sql.
[0m08:22:29.499604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:29.499957 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:22:29.500316 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:22:29.604718 [info ] [MainThread]: 
[0m08:22:29.605414 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.96 seconds (0.96s).
[0m08:22:29.606483 [debug] [MainThread]: Command end result
[0m08:22:29.631356 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:22:29.633497 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:22:29.640650 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:22:29.641335 [info ] [MainThread]: 
[0m08:22:29.642170 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:22:29.642822 [info ] [MainThread]: 
[0m08:22:29.643368 [error] [MainThread]:   Database Error in model fct_leads (models/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 60 at position 27 unexpected '' AS compliance_frequency,
          ''.
  parse error line 106 at position 10 near '<EOF>'.
  compiled code at target/run/snowflake/models/fct_leads.sql
[0m08:22:29.643824 [info ] [MainThread]: 
[0m08:22:29.644313 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:22:29.645564 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.1050084, "process_in_blocks": "0", "process_kernel_time": 0.370578, "process_mem_max_rss": "132366336", "process_out_blocks": "0", "process_user_time": 2.569368}
[0m08:22:29.646336 [debug] [MainThread]: Command `dbt build` failed at 08:22:29.646203 after 2.11 seconds
[0m08:22:29.646899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c66aff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10947dc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d8f6f00>]}
[0m08:22:29.647382 [debug] [MainThread]: Flushing usage events
[0m08:22:29.834032 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:24:46.118841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b0b33e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc9b320>]}


============================== 08:24:46.124154 | 7db706e3-11ae-4b59-b666-ae6920105ed4 ==============================
[0m08:24:46.124154 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:24:46.124975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:24:46.500691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7db706e3-11ae-4b59-b666-ae6920105ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc74d10>]}
[0m08:24:46.575343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7db706e3-11ae-4b59-b666-ae6920105ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cd7b2c0>]}
[0m08:24:46.576374 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:24:46.761418 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:24:46.900841 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:24:46.901568 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/fct_leads.sql
[0m08:24:47.213669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7db706e3-11ae-4b59-b666-ae6920105ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d389d30>]}
[0m08:24:47.305748 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:24:47.308977 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:24:47.338870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7db706e3-11ae-4b59-b666-ae6920105ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5bbc20>]}
[0m08:24:47.339450 [info ] [MainThread]: Found 3 models, 4 data tests, 4 sources, 468 macros
[0m08:24:47.341501 [info ] [MainThread]: 
[0m08:24:47.341996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:24:47.342435 [info ] [MainThread]: 
[0m08:24:47.343087 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:24:47.344056 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:24:47.405467 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:24:47.405983 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:24:47.406385 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:24:48.088601 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.682 seconds
[0m08:24:48.095061 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:24:48.106442 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:24:48.106882 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:24:48.297595 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.190 seconds
[0m08:24:48.301374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7db706e3-11ae-4b59-b666-ae6920105ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4737d0>]}
[0m08:24:48.302930 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:24:48.303494 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:24:48.304107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:24:48.304517 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:24:48.315094 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:24:48.316756 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:24:48.355180 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:24:48.359076 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:24:48.359621 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:24:49.337290 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.977 seconds
[0m08:24:49.365363 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7db706e3-11ae-4b59-b666-ae6920105ed4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109fa7d40>]}
[0m08:24:49.366125 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.06s]
[0m08:24:49.366924 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:24:49.368388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:24:49.368735 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:24:49.369086 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:24:49.479421 [info ] [MainThread]: 
[0m08:24:49.480004 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.14 seconds (2.14s).
[0m08:24:49.481321 [debug] [MainThread]: Command end result
[0m08:24:49.508668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:24:49.511244 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:24:49.519430 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:24:49.519971 [info ] [MainThread]: 
[0m08:24:49.520623 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:24:49.521097 [info ] [MainThread]: 
[0m08:24:49.529546 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:24:49.531492 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.5380647, "process_in_blocks": "0", "process_kernel_time": 0.374721, "process_mem_max_rss": "134045696", "process_out_blocks": "0", "process_user_time": 2.928774}
[0m08:24:49.532592 [debug] [MainThread]: Command `dbt build` succeeded at 08:24:49.532399 after 3.54 seconds
[0m08:24:49.533327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd70bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb98c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e69ef90>]}
[0m08:24:49.533933 [debug] [MainThread]: Flushing usage events
[0m08:24:49.753257 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:29:48.463080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a66ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8f4a0>]}


============================== 08:29:48.544094 | da094407-36d0-427e-b407-6850c3281054 ==============================
[0m08:29:48.544094 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:29:48.545052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:29:49.664785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da094407-36d0-427e-b407-6850c3281054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105913d70>]}
[0m08:29:49.736998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da094407-36d0-427e-b407-6850c3281054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b73f20>]}
[0m08:29:49.738335 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:29:50.085031 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:29:50.410462 [debug] [MainThread]: Partial parsing enabled: 4 files deleted, 1 files added, 0 files changed.
[0m08:29:50.411149 [debug] [MainThread]: Partial parsing: added file: snowflake://models/Analytics/fct_leads.sql
[0m08:29:50.411658 [debug] [MainThread]: Partial parsing: deleted file: snowflake://models/fct_leads.sql
[0m08:29:50.412011 [debug] [MainThread]: Partial parsing: deleted file: snowflake://models/example/my_second_dbt_model.sql
[0m08:29:50.412358 [debug] [MainThread]: Partial parsing: deleted file: snowflake://models/example/my_first_dbt_model.sql
[0m08:29:50.743183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:29:50.761228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da094407-36d0-427e-b407-6850c3281054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107224f80>]}
[0m08:29:50.840284 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:29:50.856302 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:29:51.104175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da094407-36d0-427e-b407-6850c3281054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073e48f0>]}
[0m08:29:51.104779 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:29:51.106822 [info ] [MainThread]: 
[0m08:29:51.107324 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:29:51.107766 [info ] [MainThread]: 
[0m08:29:51.108432 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:29:51.109387 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:29:51.372336 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:29:51.372834 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:29:51.373204 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:52.269045 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.896 seconds
[0m08:29:52.271777 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:29:52.363924 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:29:52.364397 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:29:52.464308 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.099 seconds
[0m08:29:52.469186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da094407-36d0-427e-b407-6850c3281054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b4e810>]}
[0m08:29:52.470971 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:29:52.471586 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:29:52.472245 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:29:52.472663 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:29:52.483815 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:29:52.504306 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:29:52.543800 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:29:52.547532 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:29:52.548067 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:29:54.516448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.968 seconds
[0m08:29:54.561448 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da094407-36d0-427e-b407-6850c3281054', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103d33bc0>]}
[0m08:29:54.562385 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.08s]
[0m08:29:54.563289 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:29:54.564874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:54.565243 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:29:54.565612 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:29:54.729159 [info ] [MainThread]: 
[0m08:29:54.729818 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.62 seconds (3.62s).
[0m08:29:54.730832 [debug] [MainThread]: Command end result
[0m08:29:54.760272 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:29:54.762183 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:29:54.769198 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:29:54.769641 [info ] [MainThread]: 
[0m08:29:54.770249 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:29:54.770713 [info ] [MainThread]: 
[0m08:29:54.771221 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:29:54.789923 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.7640386, "process_in_blocks": "0", "process_kernel_time": 0.547159, "process_mem_max_rss": "133677056", "process_out_blocks": "0", "process_user_time": 3.076986}
[0m08:29:54.790719 [debug] [MainThread]: Command `dbt build` succeeded at 08:29:54.790589 after 6.77 seconds
[0m08:29:54.791184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8d370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a8f4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb1880>]}
[0m08:29:54.791606 [debug] [MainThread]: Flushing usage events
[0m08:29:55.007898 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:14.920343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089d6f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109eb33b0>]}


============================== 08:30:14.925497 | 37de4552-e742-4aa1-af93-0317727bb52e ==============================
[0m08:30:14.925497 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:30:14.926290 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:30:15.303686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37de4552-e742-4aa1-af93-0317727bb52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b137ce0>]}
[0m08:30:15.373975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37de4552-e742-4aa1-af93-0317727bb52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aedbc80>]}
[0m08:30:15.374984 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:30:15.562726 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:30:15.682327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:15.682817 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:15.690177 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:30:15.726561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37de4552-e742-4aa1-af93-0317727bb52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b21fd40>]}
[0m08:30:15.803837 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:30:15.807082 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:30:15.837869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37de4552-e742-4aa1-af93-0317727bb52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b651580>]}
[0m08:30:15.838466 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:30:15.840565 [info ] [MainThread]: 
[0m08:30:15.841108 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:30:15.841563 [info ] [MainThread]: 
[0m08:30:15.842285 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:30:15.843297 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:30:15.908801 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:30:15.909356 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:30:15.909762 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:16.412123 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.502 seconds
[0m08:30:16.415060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:30:16.427302 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:30:16.427797 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:30:16.577995 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.150 seconds
[0m08:30:16.581838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37de4552-e742-4aa1-af93-0317727bb52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109d43d10>]}
[0m08:30:16.583210 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:30:16.583767 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:30:16.584370 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:30:16.584785 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:30:16.597997 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:30:16.598927 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:30:16.642835 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:30:16.646667 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:30:16.647253 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:30:17.702249 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.054 seconds
[0m08:30:17.732965 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37de4552-e742-4aa1-af93-0317727bb52e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081c3ce0>]}
[0m08:30:17.733712 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.15s]
[0m08:30:17.734580 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:30:17.735989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:17.736339 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:30:17.736734 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:30:17.843843 [info ] [MainThread]: 
[0m08:30:17.844482 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.00 seconds (2.00s).
[0m08:30:17.845452 [debug] [MainThread]: Command end result
[0m08:30:17.872187 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:30:17.874432 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:30:17.882220 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:30:17.882729 [info ] [MainThread]: 
[0m08:30:17.883237 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:17.883640 [info ] [MainThread]: 
[0m08:30:17.884089 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:30:17.885710 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0904431, "process_in_blocks": "0", "process_kernel_time": 0.467292, "process_mem_max_rss": "131985408", "process_out_blocks": "0", "process_user_time": 2.650777}
[0m08:30:17.886612 [debug] [MainThread]: Command `dbt build` succeeded at 08:30:17.886429 after 3.09 seconds
[0m08:30:17.887247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e669f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af94230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b16a80>]}
[0m08:30:17.887785 [debug] [MainThread]: Flushing usage events
[0m08:30:18.083812 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:30:45.362151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136810d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138e32c0>]}


============================== 08:30:45.367428 | 07092d15-eb52-4bac-8db7-0955565cdbe0 ==============================
[0m08:30:45.367428 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:30:45.383745 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:30:45.753827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ab1520>]}
[0m08:30:45.824159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c876e0>]}
[0m08:30:45.825156 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:30:46.010824 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:30:46.132085 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:30:46.132613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:30:46.140314 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:30:46.177630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4f8c0>]}
[0m08:30:46.254515 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:30:46.258037 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:30:46.275087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114f661e0>]}
[0m08:30:46.275686 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:30:46.276198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c4e7e0>]}
[0m08:30:46.278256 [info ] [MainThread]: 
[0m08:30:46.278777 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:30:46.279234 [info ] [MainThread]: 
[0m08:30:46.279931 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:30:46.280948 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:30:46.345980 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:30:46.346622 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:30:46.347129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:46.862730 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.516 seconds
[0m08:30:46.865395 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:30:46.876961 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:30:46.877404 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:30:47.024397 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.147 seconds
[0m08:30:47.028219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11530a4b0>]}
[0m08:30:47.029575 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:30:47.030146 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:30:47.030748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:30:47.031166 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:30:47.041990 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:30:47.042888 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:30:47.081448 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:30:47.085474 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:30:47.086042 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
        );
[0m08:30:49.420991 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.334 seconds
[0m08:30:49.452167 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '07092d15-eb52-4bac-8db7-0955565cdbe0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112bfd8e0>]}
[0m08:30:49.452943 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.42s]
[0m08:30:49.453766 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:30:49.455288 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:49.455642 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:30:49.456005 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:30:49.554294 [info ] [MainThread]: 
[0m08:30:49.554983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m08:30:49.555918 [debug] [MainThread]: Command end result
[0m08:30:49.579668 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:30:49.581654 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:30:49.589125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:30:49.589599 [info ] [MainThread]: 
[0m08:30:49.590185 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:30:49.590678 [info ] [MainThread]: 
[0m08:30:49.591168 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:30:49.592398 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3612804, "process_in_blocks": "0", "process_kernel_time": 0.370253, "process_mem_max_rss": "128524288", "process_out_blocks": "0", "process_user_time": 2.539317}
[0m08:30:49.593072 [debug] [MainThread]: Command `dbt run` succeeded at 08:30:49.592943 after 4.36 seconds
[0m08:30:49.593620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1130e2ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f78e30>]}
[0m08:30:49.594128 [debug] [MainThread]: Flushing usage events
[0m08:30:49.779753 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:44:40.394758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ebefa70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110ae33b0>]}


============================== 08:44:40.473424 | b2625524-d0e9-4406-9e29-d2ba329c414d ==============================
[0m08:44:40.473424 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:44:40.474355 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:41.319418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b2625524-d0e9-4406-9e29-d2ba329c414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d32f30>]}
[0m08:44:41.391905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b2625524-d0e9-4406-9e29-d2ba329c414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119b0770>]}
[0m08:44:41.392918 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:44:41.593029 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:44:41.832917 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:44:41.833657 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:44:42.143841 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:44:42.161275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b2625524-d0e9-4406-9e29-d2ba329c414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121bac90>]}
[0m08:44:42.240872 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:44:42.244378 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:44:42.400888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b2625524-d0e9-4406-9e29-d2ba329c414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1123d7a70>]}
[0m08:44:42.401474 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:44:42.403507 [info ] [MainThread]: 
[0m08:44:42.404008 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:44:42.404493 [info ] [MainThread]: 
[0m08:44:42.405315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:44:42.406337 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:44:42.635197 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:44:42.635690 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:44:42.636055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:43.456711 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.821 seconds
[0m08:44:43.459583 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:44:43.550581 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:44:43.551131 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:44:43.649532 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.098 seconds
[0m08:44:43.653639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b2625524-d0e9-4406-9e29-d2ba329c414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1122d8ec0>]}
[0m08:44:43.655076 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:44:43.655639 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:44:43.656256 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:44:43.656666 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:44:43.669819 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:44:43.670754 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:44:43.717062 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:44:43.720916 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:44:43.721597 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email_bounced_reason AS email,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m08:44:45.521396 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.799 seconds
[0m08:44:45.566238 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b2625524-d0e9-4406-9e29-d2ba329c414d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed8bb90>]}
[0m08:44:45.567261 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.89s]
[0m08:44:45.568072 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:44:45.569745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:45.570113 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:44:45.570478 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:44:45.680359 [info ] [MainThread]: 
[0m08:44:45.680983 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m08:44:45.681918 [debug] [MainThread]: Command end result
[0m08:44:45.723807 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:44:45.726014 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:44:45.732757 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:44:45.733158 [info ] [MainThread]: 
[0m08:44:45.733856 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:45.734371 [info ] [MainThread]: 
[0m08:44:45.734878 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:44:45.769514 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.6636114, "process_in_blocks": "0", "process_kernel_time": 0.515774, "process_mem_max_rss": "135286784", "process_out_blocks": "0", "process_user_time": 3.060326}
[0m08:44:45.770302 [debug] [MainThread]: Command `dbt build` succeeded at 08:44:45.770173 after 5.66 seconds
[0m08:44:45.770764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11197d730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abe4e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110abdc70>]}
[0m08:44:45.771239 [debug] [MainThread]: Flushing usage events
[0m08:44:45.979017 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:50:20.282106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111af4770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d3f680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d3f230>]}


============================== 08:50:20.287120 | 20512efd-517d-42db-8afa-84fdd93e1dea ==============================
[0m08:50:20.287120 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:50:20.287880 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:50:20.665378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20512efd-517d-42db-8afa-84fdd93e1dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d64c80>]}
[0m08:50:20.737287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20512efd-517d-42db-8afa-84fdd93e1dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b4a1b0>]}
[0m08:50:20.738284 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:50:20.919622 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:50:21.039066 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:50:21.039760 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:50:21.325328 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:50:21.342845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20512efd-517d-42db-8afa-84fdd93e1dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1144fb8f0>]}
[0m08:50:21.422261 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:50:21.425636 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:50:21.456038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20512efd-517d-42db-8afa-84fdd93e1dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1146334a0>]}
[0m08:50:21.456611 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:50:21.458613 [info ] [MainThread]: 
[0m08:50:21.459109 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:21.459546 [info ] [MainThread]: 
[0m08:50:21.460204 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:50:21.461161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:50:21.521908 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:50:21.522396 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:50:21.522761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:22.138977 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.616 seconds
[0m08:50:22.141671 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:50:22.231540 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:50:22.232039 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:50:22.404514 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.172 seconds
[0m08:50:22.408450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20512efd-517d-42db-8afa-84fdd93e1dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114bb81a0>]}
[0m08:50:22.409816 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:50:22.410378 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:50:22.410985 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:50:22.411401 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:50:22.423685 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:50:22.424591 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:50:22.462467 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:50:22.466384 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:50:22.466935 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modifed_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m08:50:22.718572 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e3a-0002-42a4-0007-02f200015cb2
[0m08:50:22.719144 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'LAST_MODIFED_DATE'
[0m08:50:22.758578 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'LAST_MODIFED_DATE'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:50:22.760811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20512efd-517d-42db-8afa-84fdd93e1dea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114786300>]}
[0m08:50:22.761540 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.35s]
[0m08:50:22.762364 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:50:22.763001 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'LAST_MODIFED_DATE'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m08:50:22.764694 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:22.765049 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:50:22.765405 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:50:22.889259 [info ] [MainThread]: 
[0m08:50:22.889853 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.43 seconds (1.43s).
[0m08:50:22.890804 [debug] [MainThread]: Command end result
[0m08:50:22.916094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:50:22.918558 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:50:22.925869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:50:22.926472 [info ] [MainThread]: 
[0m08:50:22.926997 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:50:22.927423 [info ] [MainThread]: 
[0m08:50:22.927916 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'LAST_MODIFED_DATE'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:50:22.928312 [info ] [MainThread]: 
[0m08:50:22.928849 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:50:22.930099 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.776058, "process_in_blocks": "0", "process_kernel_time": 0.442788, "process_mem_max_rss": "134131712", "process_out_blocks": "0", "process_user_time": 2.93186}
[0m08:50:22.930877 [debug] [MainThread]: Command `dbt build` failed at 08:50:22.930720 after 2.78 seconds
[0m08:50:22.931420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d6ab70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d68e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f91430>]}
[0m08:50:22.932003 [debug] [MainThread]: Flushing usage events
[0m08:50:23.153460 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:50:57.776084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111680a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cf530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cf2c0>]}


============================== 08:50:57.781249 | a6161793-689d-47b0-92fe-c77f59140701 ==============================
[0m08:50:57.781249 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:50:57.782020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:50:58.154410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a6161793-689d-47b0-92fe-c77f59140701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128f8f80>]}
[0m08:50:58.226334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a6161793-689d-47b0-92fe-c77f59140701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114d7860>]}
[0m08:50:58.227360 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:50:58.410999 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:50:58.531603 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:50:58.532088 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:50:58.540068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:50:58.574679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a6161793-689d-47b0-92fe-c77f59140701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b1f290>]}
[0m08:50:58.654887 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:50:58.658188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:50:58.688505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a6161793-689d-47b0-92fe-c77f59140701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114098fb0>]}
[0m08:50:58.689080 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:50:58.691161 [info ] [MainThread]: 
[0m08:50:58.691655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:50:58.692098 [info ] [MainThread]: 
[0m08:50:58.692764 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:50:58.693734 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:50:58.760140 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:50:58.760633 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:50:58.760995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:50:59.291286 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.530 seconds
[0m08:50:59.293933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:50:59.305066 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:50:59.305587 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:50:59.391085 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.085 seconds
[0m08:50:59.394930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a6161793-689d-47b0-92fe-c77f59140701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ee8140>]}
[0m08:50:59.396297 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:50:59.396855 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:50:59.397455 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:50:59.397862 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:50:59.409349 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:50:59.410314 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:50:59.446715 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:50:59.450755 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:50:59.451302 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modifed_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m08:50:59.575672 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e3a-0002-42a4-0007-02f200015cb6
[0m08:50:59.576202 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 19 at position 8
invalid identifier 'LAST_MODIFED_DATE'
[0m08:50:59.579651 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'LAST_MODIFED_DATE'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:50:59.581466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a6161793-689d-47b0-92fe-c77f59140701', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1145747d0>]}
[0m08:50:59.582184 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.18s]
[0m08:50:59.582998 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:50:59.583628 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'LAST_MODIFED_DATE'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m08:50:59.585274 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:50:59.585616 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:50:59.585969 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:50:59.702175 [info ] [MainThread]: 
[0m08:50:59.702811 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m08:50:59.703759 [debug] [MainThread]: Command end result
[0m08:50:59.729038 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:50:59.730864 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:50:59.738206 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:50:59.738634 [info ] [MainThread]: 
[0m08:50:59.739288 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:50:59.739832 [info ] [MainThread]: 
[0m08:50:59.740372 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 19 at position 8
  invalid identifier 'LAST_MODIFED_DATE'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:50:59.740951 [info ] [MainThread]: 
[0m08:50:59.741440 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:50:59.742641 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.1167257, "process_in_blocks": "0", "process_kernel_time": 0.366408, "process_mem_max_rss": "132644864", "process_out_blocks": "0", "process_user_time": 2.51624}
[0m08:50:59.743315 [debug] [MainThread]: Command `dbt build` failed at 08:50:59.743186 after 2.12 seconds
[0m08:50:59.743779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128cf290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136826f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c170b0>]}
[0m08:50:59.744199 [debug] [MainThread]: Flushing usage events
[0m08:50:59.934667 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:51:12.748724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbf4e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129f31a0>]}


============================== 08:51:12.754209 | cd041a42-c4f3-490e-9a7a-b93d02f03480 ==============================
[0m08:51:12.754209 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:51:12.754975 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:51:13.156372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd041a42-c4f3-490e-9a7a-b93d02f03480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113565c70>]}
[0m08:51:13.240650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd041a42-c4f3-490e-9a7a-b93d02f03480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113caa090>]}
[0m08:51:13.242191 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:51:13.434443 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:51:13.562831 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:51:13.563564 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:51:13.882131 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:51:13.899999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd041a42-c4f3-490e-9a7a-b93d02f03480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141ab9b0>]}
[0m08:51:13.986638 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:51:13.989957 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:51:14.022308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd041a42-c4f3-490e-9a7a-b93d02f03480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1142e3110>]}
[0m08:51:14.022897 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:51:14.024954 [info ] [MainThread]: 
[0m08:51:14.025496 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:51:14.025955 [info ] [MainThread]: 
[0m08:51:14.026646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:51:14.027906 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:51:14.091923 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:51:14.092428 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:51:14.092803 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:51:14.548277 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.455 seconds
[0m08:51:14.550931 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:51:14.646037 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:51:14.646608 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:51:14.855907 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.209 seconds
[0m08:51:14.859856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd041a42-c4f3-490e-9a7a-b93d02f03480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d80b0>]}
[0m08:51:14.861895 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:51:14.862618 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:51:14.863270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:51:14.863690 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:51:14.874486 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:51:14.875392 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:51:14.914809 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:51:14.919301 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:51:14.919993 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m08:51:17.274075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.354 seconds
[0m08:51:17.304719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd041a42-c4f3-490e-9a7a-b93d02f03480', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c97c20>]}
[0m08:51:17.305505 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.44s]
[0m08:51:17.306306 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:51:17.307739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:51:17.308093 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:51:17.308451 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:51:17.437093 [info ] [MainThread]: 
[0m08:51:17.437681 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.41 seconds (3.41s).
[0m08:51:17.438678 [debug] [MainThread]: Command end result
[0m08:51:17.463478 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:51:17.466366 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:51:17.473777 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:51:17.474335 [info ] [MainThread]: 
[0m08:51:17.474901 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:51:17.475349 [info ] [MainThread]: 
[0m08:51:17.475842 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:51:17.477050 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.866058, "process_in_blocks": "0", "process_kernel_time": 0.383719, "process_mem_max_rss": "134823936", "process_out_blocks": "0", "process_user_time": 2.993551}
[0m08:51:17.477695 [debug] [MainThread]: Command `dbt build` succeeded at 08:51:17.477566 after 4.87 seconds
[0m08:51:17.478154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d32ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d30ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d33770>]}
[0m08:51:17.478595 [debug] [MainThread]: Flushing usage events
[0m08:51:17.673605 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:52:17.306934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8cc950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb1b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cb1b320>]}


============================== 08:52:17.313834 | 61be028a-ef98-48a9-af52-fe6d35543770 ==============================
[0m08:52:17.313834 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:52:17.314558 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:52:17.735886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '61be028a-ef98-48a9-af52-fe6d35543770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adec860>]}
[0m08:52:17.813697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '61be028a-ef98-48a9-af52-fe6d35543770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c9d91c0>]}
[0m08:52:17.814710 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:52:18.012227 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:52:18.143787 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:52:18.144814 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:52:18.441299 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:52:18.457623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '61be028a-ef98-48a9-af52-fe6d35543770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfc4440>]}
[0m08:52:18.537388 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:52:18.540628 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:52:18.570968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '61be028a-ef98-48a9-af52-fe6d35543770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e40f2c0>]}
[0m08:52:18.571560 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:52:18.573561 [info ] [MainThread]: 
[0m08:52:18.574060 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:52:18.574504 [info ] [MainThread]: 
[0m08:52:18.575165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:52:18.576126 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:52:18.636986 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:52:18.637489 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:52:18.637852 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:52:19.214964 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.577 seconds
[0m08:52:19.217600 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:52:19.310416 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:52:19.310930 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:52:19.422726 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.111 seconds
[0m08:52:19.426620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '61be028a-ef98-48a9-af52-fe6d35543770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c67d9a0>]}
[0m08:52:19.428089 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:52:19.428851 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:52:19.429674 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:52:19.430106 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:52:19.440742 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:52:19.441715 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:52:19.480591 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:52:19.484880 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:52:19.485432 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m08:52:21.294745 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.809 seconds
[0m08:52:21.326574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '61be028a-ef98-48a9-af52-fe6d35543770', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10adc3b00>]}
[0m08:52:21.327446 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.90s]
[0m08:52:21.328473 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:52:21.330397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:52:21.330834 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:52:21.331232 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:52:21.432121 [info ] [MainThread]: 
[0m08:52:21.432749 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.86 seconds (2.86s).
[0m08:52:21.433670 [debug] [MainThread]: Command end result
[0m08:52:21.458117 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:52:21.460031 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:52:21.467223 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:52:21.468019 [info ] [MainThread]: 
[0m08:52:21.468812 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:52:21.469302 [info ] [MainThread]: 
[0m08:52:21.469813 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:52:21.471155 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.307838, "process_in_blocks": "0", "process_kernel_time": 0.396878, "process_mem_max_rss": "133799936", "process_out_blocks": "0", "process_user_time": 3.031931}
[0m08:52:21.471872 [debug] [MainThread]: Command `dbt build` succeeded at 08:52:21.471729 after 4.31 seconds
[0m08:52:21.472377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad283b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5ca70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de5c9e0>]}
[0m08:52:21.472947 [debug] [MainThread]: Flushing usage events
[0m08:52:21.692543 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:55:39.440792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076635c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107663320>]}


============================== 08:55:39.446327 | 95b9df48-c6c0-472c-9778-4caa8fce3b84 ==============================
[0m08:55:39.446327 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:55:39.447078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m08:55:39.832450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '95b9df48-c6c0-472c-9778-4caa8fce3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10852e2d0>]}
[0m08:55:39.903442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '95b9df48-c6c0-472c-9778-4caa8fce3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10864c3b0>]}
[0m08:55:39.904479 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:55:40.083056 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:55:40.201441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:55:40.202265 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:55:40.512056 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:55:40.529231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '95b9df48-c6c0-472c-9778-4caa8fce3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e1b770>]}
[0m08:55:40.608420 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:55:40.611686 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:55:40.641537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '95b9df48-c6c0-472c-9778-4caa8fce3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f531d0>]}
[0m08:55:40.642185 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:55:40.644249 [info ] [MainThread]: 
[0m08:55:40.644745 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:55:40.645185 [info ] [MainThread]: 
[0m08:55:40.645852 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:55:40.646862 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:55:40.708291 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:55:40.708776 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:55:40.709142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:55:41.176952 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.468 seconds
[0m08:55:41.179726 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:55:41.271922 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:55:41.272487 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:55:41.376554 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.104 seconds
[0m08:55:41.380639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '95b9df48-c6c0-472c-9778-4caa8fce3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e55eb0>]}
[0m08:55:41.382195 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:55:41.382771 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:55:41.383384 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:55:41.383803 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:55:41.394757 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:55:41.395672 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:55:41.435514 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:55:41.439924 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:55:41.440561 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m08:55:43.297955 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.857 seconds
[0m08:55:43.331605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '95b9df48-c6c0-472c-9778-4caa8fce3b84', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105903b90>]}
[0m08:55:43.332426 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.95s]
[0m08:55:43.333372 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:55:43.334875 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:55:43.335241 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:55:43.335604 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:55:43.435448 [info ] [MainThread]: 
[0m08:55:43.436086 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.79 seconds (2.79s).
[0m08:55:43.437146 [debug] [MainThread]: Command end result
[0m08:55:43.461051 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:55:43.464127 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:55:43.471549 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:55:43.472128 [info ] [MainThread]: 
[0m08:55:43.472650 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:55:43.473131 [info ] [MainThread]: 
[0m08:55:43.473722 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:55:43.475244 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.172101, "process_in_blocks": "0", "process_kernel_time": 0.384894, "process_mem_max_rss": "133214208", "process_out_blocks": "0", "process_user_time": 2.9728}
[0m08:55:43.476324 [debug] [MainThread]: Command `dbt build` succeeded at 08:55:43.476133 after 4.17 seconds
[0m08:55:43.476806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10571d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bc3050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e2a50>]}
[0m08:55:43.477250 [debug] [MainThread]: Flushing usage events
[0m08:55:43.686288 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:56:49.085217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e206e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602b320>]}


============================== 08:56:49.090214 | 3a535c9f-e4d7-414f-8ee9-5a886812d46d ==============================
[0m08:56:49.090214 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:56:49.090983 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:56:49.723356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a535c9f-e4d7-414f-8ee9-5a886812d46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104364bf0>]}
[0m08:56:49.794923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a535c9f-e4d7-414f-8ee9-5a886812d46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b7ce0>]}
[0m08:56:49.795916 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:56:49.993508 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:56:50.111600 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:56:50.112332 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:56:50.421690 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:56:50.438668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a535c9f-e4d7-414f-8ee9-5a886812d46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10798f920>]}
[0m08:56:50.516669 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:56:50.519850 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:56:50.549740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a535c9f-e4d7-414f-8ee9-5a886812d46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a775f0>]}
[0m08:56:50.550317 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:56:50.552325 [info ] [MainThread]: 
[0m08:56:50.552833 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:56:50.553279 [info ] [MainThread]: 
[0m08:56:50.553942 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:56:50.554898 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:56:50.614730 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:56:50.615233 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:56:50.615595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:56:51.270609 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.655 seconds
[0m08:56:51.279717 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:56:51.368280 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:56:51.368771 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:56:51.522143 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.153 seconds
[0m08:56:51.526118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a535c9f-e4d7-414f-8ee9-5a886812d46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10769d010>]}
[0m08:56:51.527476 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:56:51.528039 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:56:51.528646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:56:51.529063 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:56:51.539619 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:56:51.540900 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:56:51.578635 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:56:51.583216 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:56:51.583824 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
 and lead.country not like '[0-9]'
        );
[0m08:56:51.677870 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e40-0002-42a4-0007-02f200015cc6
[0m08:56:51.678432 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 125 at position 5
invalid identifier 'LEAD.COUNTRY'
[0m08:56:51.681765 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 125 at position 5
  invalid identifier 'LEAD.COUNTRY'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:56:51.683582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a535c9f-e4d7-414f-8ee9-5a886812d46d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10782d100>]}
[0m08:56:51.684290 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.15s]
[0m08:56:51.685099 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:56:51.685725 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 125 at position 5
  invalid identifier 'LEAD.COUNTRY'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m08:56:51.687361 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:56:51.687712 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:56:51.688070 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:56:51.805918 [info ] [MainThread]: 
[0m08:56:51.806541 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.25 seconds (1.25s).
[0m08:56:51.807459 [debug] [MainThread]: Command end result
[0m08:56:51.833632 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:56:51.835895 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:56:51.843193 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:56:51.843649 [info ] [MainThread]: 
[0m08:56:51.844239 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:56:51.844707 [info ] [MainThread]: 
[0m08:56:51.845207 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 125 at position 5
  invalid identifier 'LEAD.COUNTRY'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:56:51.845654 [info ] [MainThread]: 
[0m08:56:51.846067 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:56:51.864350 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.000703, "process_in_blocks": "0", "process_kernel_time": 0.379027, "process_mem_max_rss": "132894720", "process_out_blocks": "0", "process_user_time": 2.851028}
[0m08:56:51.865216 [debug] [MainThread]: Command `dbt build` failed at 08:56:51.865084 after 3.00 seconds
[0m08:56:51.865687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10469f020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c8fb90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078a9cd0>]}
[0m08:56:51.866113 [debug] [MainThread]: Flushing usage events
[0m08:56:52.057779 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:57:02.777950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fecf5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11007f830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11007f5c0>]}


============================== 08:57:02.783027 | 7c6875fb-7e53-475e-913f-9be03c552969 ==============================
[0m08:57:02.783027 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:57:02.783805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:57:03.164894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c6875fb-7e53-475e-913f-9be03c552969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111069520>]}
[0m08:57:03.235717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c6875fb-7e53-475e-913f-9be03c552969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11127c440>]}
[0m08:57:03.236774 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:57:03.416473 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:57:03.537157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:57:03.537954 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:57:03.819409 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:57:03.836088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7c6875fb-7e53-475e-913f-9be03c552969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11183b800>]}
[0m08:57:03.914513 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:57:03.917837 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:57:03.947686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7c6875fb-7e53-475e-913f-9be03c552969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11196f560>]}
[0m08:57:03.948271 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:57:03.950309 [info ] [MainThread]: 
[0m08:57:03.950817 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:57:03.951251 [info ] [MainThread]: 
[0m08:57:03.951970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:57:03.952932 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:57:04.013356 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:57:04.013843 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:57:04.014208 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:57:04.551556 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.537 seconds
[0m08:57:04.554166 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:57:04.642743 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:57:04.643229 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:57:04.734479 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.091 seconds
[0m08:57:04.738357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7c6875fb-7e53-475e-913f-9be03c552969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11177bec0>]}
[0m08:57:04.739807 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:57:04.740368 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:57:04.740974 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:57:04.741383 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:57:04.752036 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:57:04.753080 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:57:04.792155 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:57:04.796559 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:57:04.797124 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
 and leads.country not like '[0-9]'
        );
[0m08:57:05.639315 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m08:57:05.669655 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7c6875fb-7e53-475e-913f-9be03c552969', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e327950>]}
[0m08:57:05.670374 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.93s]
[0m08:57:05.671168 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:57:05.672604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:57:05.672947 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:57:05.673296 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:57:05.780965 [info ] [MainThread]: 
[0m08:57:05.781566 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.83 seconds (1.83s).
[0m08:57:05.782502 [debug] [MainThread]: Command end result
[0m08:57:05.807685 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:57:05.810002 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:57:05.817553 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:57:05.818007 [info ] [MainThread]: 
[0m08:57:05.818658 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:57:05.819113 [info ] [MainThread]: 
[0m08:57:05.819601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:57:05.820760 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.1695523, "process_in_blocks": "0", "process_kernel_time": 0.372218, "process_mem_max_rss": "135311360", "process_out_blocks": "0", "process_user_time": 2.861266}
[0m08:57:05.821403 [debug] [MainThread]: Command `dbt build` succeeded at 08:57:05.821273 after 3.17 seconds
[0m08:57:05.821859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed5ffb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111162f60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100a5880>]}
[0m08:57:05.822290 [debug] [MainThread]: Flushing usage events
[0m08:57:06.049468 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:58:56.682900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d3eab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f88530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10645b770>]}


============================== 08:58:56.688241 | 5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d ==============================
[0m08:58:56.688241 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:58:56.689027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:58:57.071974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075abb00>]}
[0m08:58:57.146480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075a8200>]}
[0m08:58:57.147560 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:58:57.331730 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:58:57.458386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:58:57.459158 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:58:57.751798 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:58:57.769496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4f770>]}
[0m08:58:57.851057 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:58:57.854345 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:58:57.884717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c87200>]}
[0m08:58:57.885304 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:58:57.887365 [info ] [MainThread]: 
[0m08:58:57.887865 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:58:57.888306 [info ] [MainThread]: 
[0m08:58:57.888974 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:58:57.889937 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:58:57.951897 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:58:57.952448 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:58:57.952930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:58:58.483628 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.531 seconds
[0m08:58:58.486226 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:58:58.575835 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:58:58.576358 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:58:58.699857 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.123 seconds
[0m08:58:58.703819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10582a600>]}
[0m08:58:58.705309 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:58:58.705872 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:58:58.706393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:58:58.706891 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:58:58.717894 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:58:58.720432 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:58:58.758066 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:58:58.762498 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:58:58.763256 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
    AND country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE CENTER IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
        WHERE Operation IS NOT NULL -- Validate non-null operation IDs
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
 and leads.country not like '[0-9]'
        );
[0m08:58:58.873761 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e42-0002-4252-0007-02f200011d22
[0m08:58:58.874293 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 4 unexpected 'AND'.
[0m08:58:58.877693 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 4 unexpected 'AND'.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:58:58.879699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5bdfc1af-4f88-4c0a-b5de-caf19c4e3d1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dd8b90>]}
[0m08:58:58.880584 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.17s]
[0m08:58:58.881392 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:58:58.882018 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 4 unexpected 'AND'.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m08:58:58.883767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:58:58.884118 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:58:58.884473 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:58:58.985614 [info ] [MainThread]: 
[0m08:58:58.986240 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m08:58:58.987157 [debug] [MainThread]: Command end result
[0m08:58:59.014234 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:58:59.016481 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:58:59.023731 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:58:59.024318 [info ] [MainThread]: 
[0m08:58:59.024918 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:58:59.025398 [info ] [MainThread]: 
[0m08:58:59.025931 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 4 unexpected 'AND'.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:58:59.026361 [info ] [MainThread]: 
[0m08:58:59.026818 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:58:59.028056 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.4731762, "process_in_blocks": "0", "process_kernel_time": 0.381502, "process_mem_max_rss": "134246400", "process_out_blocks": "0", "process_user_time": 2.922409}
[0m08:58:59.028765 [debug] [MainThread]: Command `dbt build` failed at 08:58:59.028621 after 2.47 seconds
[0m08:58:59.029278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dda660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ebc620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076e49e0>]}
[0m08:58:59.030591 [debug] [MainThread]: Flushing usage events
[0m08:58:59.232243 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:15.950587 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de310a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eabb560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eabb2f0>]}


============================== 08:59:15.956093 | 3e368f1b-d5cf-4665-890d-956c1eec43ef ==============================
[0m08:59:15.956093 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:59:15.956961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:59:16.496003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e368f1b-d5cf-4665-890d-956c1eec43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd0c860>]}
[0m08:59:16.570194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e368f1b-d5cf-4665-890d-956c1eec43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbd5bb0>]}
[0m08:59:16.571297 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:59:16.786577 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:59:17.071107 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:59:17.071831 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:59:17.359846 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:59:17.376658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e368f1b-d5cf-4665-890d-956c1eec43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102bbaa0>]}
[0m08:59:17.458054 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:59:17.474159 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:59:18.165482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e368f1b-d5cf-4665-890d-956c1eec43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103a74a0>]}
[0m08:59:18.166123 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:59:18.168477 [info ] [MainThread]: 
[0m08:59:18.169855 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:18.170667 [info ] [MainThread]: 
[0m08:59:18.172114 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:18.173434 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:59:18.423833 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:59:18.424375 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:59:18.424781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:59:19.353243 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.928 seconds
[0m08:59:19.356265 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m08:59:19.493715 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m08:59:19.494217 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m08:59:19.662951 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.168 seconds
[0m08:59:19.666960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e368f1b-d5cf-4665-890d-956c1eec43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110298290>]}
[0m08:59:19.668341 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m08:59:19.668907 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m08:59:19.669527 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m08:59:19.669942 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m08:59:19.680870 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m08:59:19.681804 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m08:59:19.723656 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m08:59:19.728611 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m08:59:19.729628 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
    country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE CENTER IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
        WHERE Operation IS NOT NULL -- Validate non-null operation IDs
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
 and leads.country not like '[0-9]'
        );
[0m08:59:19.937740 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e43-0002-4296-0007-02f200010d86
[0m08:59:19.938296 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 29 at position 12 unexpected 'NOT'.
[0m08:59:19.977922 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 12 unexpected 'NOT'.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:59:19.980199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e368f1b-d5cf-4665-890d-956c1eec43ef', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df21550>]}
[0m08:59:19.980942 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.31s]
[0m08:59:19.981749 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m08:59:19.982375 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 12 unexpected 'NOT'.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m08:59:19.984120 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:59:19.984481 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m08:59:19.984840 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m08:59:20.113696 [info ] [MainThread]: 
[0m08:59:20.114323 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.94 seconds (1.94s).
[0m08:59:20.115235 [debug] [MainThread]: Command end result
[0m08:59:20.141345 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:59:20.143476 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:59:20.150736 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m08:59:20.151190 [info ] [MainThread]: 
[0m08:59:20.151737 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m08:59:20.152265 [info ] [MainThread]: 
[0m08:59:20.152814 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 29 at position 12 unexpected 'NOT'.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m08:59:20.153283 [info ] [MainThread]: 
[0m08:59:20.153917 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m08:59:20.182924 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 4.391656, "process_in_blocks": "0", "process_kernel_time": 0.419643, "process_mem_max_rss": "133332992", "process_out_blocks": "0", "process_user_time": 2.979054}
[0m08:59:20.183700 [debug] [MainThread]: Command `dbt build` failed at 08:59:20.183572 after 4.39 seconds
[0m08:59:20.184164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe20f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe21c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe22f30>]}
[0m08:59:20.184589 [debug] [MainThread]: Flushing usage events
[0m08:59:20.381551 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m08:59:57.904095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b230b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e7680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058e73e0>]}


============================== 08:59:57.909243 | 38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5 ==============================
[0m08:59:57.909243 [info ] [MainThread]: Running with dbt=1.9.1
[0m08:59:57.910825 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:59:58.520655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a58d10>]}
[0m08:59:58.607879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a406b0>]}
[0m08:59:58.608981 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m08:59:58.801665 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m08:59:58.926661 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:59:58.927583 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m08:59:59.292870 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m08:59:59.312052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071c7890>]}
[0m08:59:59.400367 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m08:59:59.404094 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m08:59:59.435183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072ff650>]}
[0m08:59:59.435763 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m08:59:59.437791 [info ] [MainThread]: 
[0m08:59:59.438301 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m08:59:59.438741 [info ] [MainThread]: 
[0m08:59:59.439413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:59:59.440378 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m08:59:59.502859 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m08:59:59.503368 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m08:59:59.503854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:00:00.002228 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.498 seconds
[0m09:00:00.005520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:00:00.101699 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:00:00.102341 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:00:00.220562 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.118 seconds
[0m09:00:00.224646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105b7a330>]}
[0m09:00:00.226052 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:00:00.226610 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:00:00.227211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:00:00.227620 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:00:00.239163 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:00:00.240198 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:00:00.280144 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:00:00.284646 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:00:00.285502 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE CENTER IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
        WHERE Operation IS NOT NULL -- Validate non-null operation IDs
),

source_s3 AS (
    SELECT
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:00:00.408909 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e44-0002-431d-0007-02f200018b3a
[0m09:00:00.409450 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 40 at position 11
invalid identifier 'CENTER'
[0m09:00:00.413030 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 40 at position 11
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m09:00:00.414934 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38ea07fa-f47f-4ce4-9f8f-ff53ccc3e6a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10590d2b0>]}
[0m09:00:00.415647 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.19s]
[0m09:00:00.416452 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:00:00.417085 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 40 at position 11
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m09:00:00.418811 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:00:00.419164 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:00:00.419518 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:00:00.520488 [info ] [MainThread]: 
[0m09:00:00.521113 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m09:00:00.522023 [debug] [MainThread]: Command end result
[0m09:00:00.547905 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:00:00.550199 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:00:00.557472 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:00:00.557916 [info ] [MainThread]: 
[0m09:00:00.558476 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:00:00.558934 [info ] [MainThread]: 
[0m09:00:00.559424 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 40 at position 11
  invalid identifier 'CENTER'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m09:00:00.559869 [info ] [MainThread]: 
[0m09:00:00.560327 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:00:00.561612 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.8761773, "process_in_blocks": "0", "process_kernel_time": 0.425377, "process_mem_max_rss": "134021120", "process_out_blocks": "0", "process_user_time": 3.207455}
[0m09:00:00.562283 [debug] [MainThread]: Command `dbt build` failed at 09:00:00.562152 after 2.88 seconds
[0m09:00:00.562787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071049e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d7a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107664500>]}
[0m09:00:00.563223 [debug] [MainThread]: Flushing usage events
[0m09:00:00.750591 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:01:14.215190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111ef7b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113de7500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113de7290>]}


============================== 09:01:14.221233 | 23cada5c-a24f-4b8f-abab-ea5321dffa22 ==============================
[0m09:01:14.221233 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:01:14.222062 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m09:01:14.614739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '23cada5c-a24f-4b8f-abab-ea5321dffa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ed7e30>]}
[0m09:01:14.689616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '23cada5c-a24f-4b8f-abab-ea5321dffa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fbfa10>]}
[0m09:01:14.690682 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:01:14.880106 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:01:15.002249 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:01:15.002993 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:01:15.295324 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m09:01:15.312600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23cada5c-a24f-4b8f-abab-ea5321dffa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155abd70>]}
[0m09:01:15.392722 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:01:15.395992 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:01:15.426161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '23cada5c-a24f-4b8f-abab-ea5321dffa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156e33b0>]}
[0m09:01:15.426771 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m09:01:15.428867 [info ] [MainThread]: 
[0m09:01:15.429395 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:01:15.429933 [info ] [MainThread]: 
[0m09:01:15.430785 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:01:15.431852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m09:01:15.493757 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m09:01:15.494249 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m09:01:15.494612 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:01:15.975359 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.481 seconds
[0m09:01:15.977968 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:01:16.068314 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:01:16.068813 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:01:16.166530 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.097 seconds
[0m09:01:16.170410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '23cada5c-a24f-4b8f-abab-ea5321dffa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11664c3e0>]}
[0m09:01:16.172055 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:01:16.172633 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:01:16.173255 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:01:16.173673 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:01:16.185321 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:01:16.186268 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:01:16.225316 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:01:16.229711 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:01:16.230278 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
        WHERE Company IS NOT NULL -- Validate non-null operation IDs
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:01:18.029588 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.799 seconds
[0m09:01:18.062228 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23cada5c-a24f-4b8f-abab-ea5321dffa22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112093d10>]}
[0m09:01:18.063080 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.89s]
[0m09:01:18.063990 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:01:18.065638 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:01:18.066038 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:01:18.066429 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:01:18.184884 [info ] [MainThread]: 
[0m09:01:18.185487 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.75 seconds (2.75s).
[0m09:01:18.186524 [debug] [MainThread]: Command end result
[0m09:01:18.211527 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:01:18.213521 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:01:18.220893 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:01:18.221330 [info ] [MainThread]: 
[0m09:01:18.221859 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:01:18.222340 [info ] [MainThread]: 
[0m09:01:18.222873 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:01:18.224386 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.1421165, "process_in_blocks": "0", "process_kernel_time": 0.381703, "process_mem_max_rss": "134897664", "process_out_blocks": "0", "process_user_time": 2.938467}
[0m09:01:18.225388 [debug] [MainThread]: Command `dbt build` succeeded at 09:01:18.225243 after 4.14 seconds
[0m09:01:18.225863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151588c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151594f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115159580>]}
[0m09:01:18.226313 [debug] [MainThread]: Flushing usage events
[0m09:01:18.431688 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:12.704493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111d6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111fb440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111fb0b0>]}


============================== 09:18:12.782222 | 5aa4d499-e73f-4844-9c18-d20e04a7e2c2 ==============================
[0m09:18:12.782222 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:18:12.783204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m09:18:14.160718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5aa4d499-e73f-4844-9c18-d20e04a7e2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11218bcb0>]}
[0m09:18:14.232988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5aa4d499-e73f-4844-9c18-d20e04a7e2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e142f0>]}
[0m09:18:14.234346 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:18:14.605665 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:18:14.939089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:18:14.939857 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:18:15.310382 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m09:18:15.327433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5aa4d499-e73f-4844-9c18-d20e04a7e2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1129b76e0>]}
[0m09:18:15.414634 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:18:15.468830 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:18:15.583998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5aa4d499-e73f-4844-9c18-d20e04a7e2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aef260>]}
[0m09:18:15.584586 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m09:18:15.586650 [info ] [MainThread]: 
[0m09:18:15.587156 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:18:15.587600 [info ] [MainThread]: 
[0m09:18:15.588280 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:18:15.589245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m09:18:15.793336 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m09:18:15.793826 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m09:18:15.794194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:16.664603 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.870 seconds
[0m09:18:16.667536 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:18:16.761096 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:18:16.761597 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:18:16.872178 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.110 seconds
[0m09:18:16.876399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5aa4d499-e73f-4844-9c18-d20e04a7e2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112aeffb0>]}
[0m09:18:16.886064 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:18:16.886725 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:18:16.887346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:18:16.887763 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:18:16.898677 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:18:16.902720 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:18:16.944083 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:18:16.948621 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:18:16.949195 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
        WHERE Company IS NOT NULL -- Validate non-null operation IDs
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:18:18.076636 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b92e56-0002-42a4-0007-02f200015cd6
[0m09:18:18.077241 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 58 at position 8 unexpected ''Monitoring since''.
syntax error line 61 at position 1 unexpected ','.
[0m09:18:18.164084 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 8 unexpected ''Monitoring since''.
  syntax error line 61 at position 1 unexpected ','.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m09:18:18.190749 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5aa4d499-e73f-4844-9c18-d20e04a7e2c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a27560>]}
[0m09:18:18.191641 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 1.28s]
[0m09:18:18.192544 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:18:18.193278 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 8 unexpected ''Monitoring since''.
  syntax error line 61 at position 1 unexpected ','.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m09:18:18.195075 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:18.195478 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:18:18.195833 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:18:18.291068 [info ] [MainThread]: 
[0m09:18:18.291673 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.70 seconds (2.70s).
[0m09:18:18.292666 [debug] [MainThread]: Command end result
[0m09:18:18.317109 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:18:18.319260 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:18:18.327140 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:18:18.327717 [info ] [MainThread]: 
[0m09:18:18.328606 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:18:18.329113 [info ] [MainThread]: 
[0m09:18:18.329654 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  001003 (42000): SQL compilation error:
  syntax error line 58 at position 8 unexpected ''Monitoring since''.
  syntax error line 61 at position 1 unexpected ','.
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m09:18:18.330112 [info ] [MainThread]: 
[0m09:18:18.330581 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m09:18:18.394049 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 6.0383096, "process_in_blocks": "0", "process_kernel_time": 0.561458, "process_mem_max_rss": "134189056", "process_out_blocks": "0", "process_user_time": 3.182649}
[0m09:18:18.394938 [debug] [MainThread]: Command `dbt build` failed at 09:18:18.394744 after 6.04 seconds
[0m09:18:18.395459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c10f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d4860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1121d6d50>]}
[0m09:18:18.395883 [debug] [MainThread]: Flushing usage events
[0m09:18:18.649857 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:18:38.506679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab98e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bda77d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bda7560>]}


============================== 09:18:38.594678 | a8ba5bee-c00e-499c-a1c7-d8ec9293dd35 ==============================
[0m09:18:38.594678 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:18:38.595637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m09:18:39.683455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a8ba5bee-c00e-499c-a1c7-d8ec9293dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfcbf80>]}
[0m09:18:39.755176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a8ba5bee-c00e-499c-a1c7-d8ec9293dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b4b2060>]}
[0m09:18:39.756463 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:18:39.993021 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:18:40.258403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:18:40.259136 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:18:40.545629 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m09:18:40.561830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8ba5bee-c00e-499c-a1c7-d8ec9293dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a79b0>]}
[0m09:18:40.644454 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:18:40.659373 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:18:40.782962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a8ba5bee-c00e-499c-a1c7-d8ec9293dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6931d0>]}
[0m09:18:40.783549 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m09:18:40.785575 [info ] [MainThread]: 
[0m09:18:40.786096 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:18:40.786510 [info ] [MainThread]: 
[0m09:18:40.787172 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:18:40.788332 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m09:18:40.876060 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m09:18:40.876619 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m09:18:40.876991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:18:41.624656 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.748 seconds
[0m09:18:41.627305 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:18:41.717306 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:18:41.717820 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:18:41.911501 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.193 seconds
[0m09:18:41.915417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a8ba5bee-c00e-499c-a1c7-d8ec9293dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10db21190>]}
[0m09:18:41.916794 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:18:41.917391 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:18:41.917993 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:18:41.918401 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:18:41.930090 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:18:41.931519 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:18:41.970377 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:18:41.975154 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:18:41.975778 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
        WHERE Company IS NOT NULL -- Validate non-null operation IDs
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:18:44.359816 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.383 seconds
[0m09:18:44.414585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8ba5bee-c00e-499c-a1c7-d8ec9293dd35', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a0b3fe0>]}
[0m09:18:44.415573 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.47s]
[0m09:18:44.416525 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:18:44.418255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:18:44.418641 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:18:44.419015 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:18:44.531188 [info ] [MainThread]: 
[0m09:18:44.531869 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m09:18:44.532918 [debug] [MainThread]: Command end result
[0m09:18:44.562631 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:18:44.565147 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:18:44.575977 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:18:44.576563 [info ] [MainThread]: 
[0m09:18:44.577240 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:18:44.577733 [info ] [MainThread]: 
[0m09:18:44.578214 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:18:44.601328 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.480468, "process_in_blocks": "0", "process_kernel_time": 0.522585, "process_mem_max_rss": "133750784", "process_out_blocks": "0", "process_user_time": 3.069073}
[0m09:18:44.602379 [debug] [MainThread]: Command `dbt build` succeeded at 09:18:44.602207 after 6.48 seconds
[0m09:18:44.603102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10baaefc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5342c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a7500>]}
[0m09:18:44.603659 [debug] [MainThread]: Flushing usage events
[0m09:18:44.795883 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:20:54.534086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5d0d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8236e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e823440>]}


============================== 09:20:54.539395 | 43211743-44e0-4739-ae36-1ebe4f6ebde2 ==============================
[0m09:20:54.539395 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:20:54.540231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m09:20:54.920657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '43211743-44e0-4739-ae36-1ebe4f6ebde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7fb620>]}
[0m09:20:54.992212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '43211743-44e0-4739-ae36-1ebe4f6ebde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e313710>]}
[0m09:20:54.993234 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:20:55.183199 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:20:55.305362 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:20:55.306093 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:20:55.592044 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m09:20:55.608761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '43211743-44e0-4739-ae36-1ebe4f6ebde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffdf920>]}
[0m09:20:55.687730 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:20:55.690944 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:20:55.721106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '43211743-44e0-4739-ae36-1ebe4f6ebde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101131d0>]}
[0m09:20:55.721693 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m09:20:55.723698 [info ] [MainThread]: 
[0m09:20:55.724184 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:20:55.724607 [info ] [MainThread]: 
[0m09:20:55.725271 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:20:55.726238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m09:20:55.787111 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m09:20:55.787598 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m09:20:55.787962 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:20:56.331447 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.543 seconds
[0m09:20:56.334054 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:20:56.423838 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:20:56.424340 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:20:56.556275 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.132 seconds
[0m09:20:56.560205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '43211743-44e0-4739-ae36-1ebe4f6ebde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ffd9af0>]}
[0m09:20:56.561752 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:20:56.562318 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:20:56.562983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:20:56.563405 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:20:56.574200 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:20:56.576057 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:20:56.614607 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:20:56.619194 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:20:56.619862 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:20:58.513230 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.893 seconds
[0m09:20:58.545101 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '43211743-44e0-4739-ae36-1ebe4f6ebde2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10caec230>]}
[0m09:20:58.545858 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.98s]
[0m09:20:58.546792 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:20:58.548307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:20:58.548668 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:20:58.549034 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:20:58.666576 [info ] [MainThread]: 
[0m09:20:58.667218 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m09:20:58.668148 [debug] [MainThread]: Command end result
[0m09:20:58.694156 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:20:58.696058 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:20:58.703369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:20:58.703949 [info ] [MainThread]: 
[0m09:20:58.704510 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:20:58.704938 [info ] [MainThread]: 
[0m09:20:58.705392 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:20:58.706809 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.299832, "process_in_blocks": "0", "process_kernel_time": 0.444317, "process_mem_max_rss": "134873088", "process_out_blocks": "0", "process_user_time": 2.970708}
[0m09:20:58.707479 [debug] [MainThread]: Command `dbt build` succeeded at 09:20:58.707348 after 4.30 seconds
[0m09:20:58.707948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df551c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbfeb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5382f0>]}
[0m09:20:58.708392 [debug] [MainThread]: Flushing usage events
[0m09:20:58.920182 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:25:40.240624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102807050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bb5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bb230>]}


============================== 09:25:40.245839 | 593c1f8d-27eb-46cd-a644-f725c4f219aa ==============================
[0m09:25:40.245839 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:25:40.246658 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m09:25:40.628987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '593c1f8d-27eb-46cd-a644-f725c4f219aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028f0d40>]}
[0m09:25:40.702974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '593c1f8d-27eb-46cd-a644-f725c4f219aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053c2930>]}
[0m09:25:40.704155 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:25:40.906362 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:25:41.035055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:25:41.035788 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:25:41.336974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m09:25:41.357109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '593c1f8d-27eb-46cd-a644-f725c4f219aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dbb8c0>]}
[0m09:25:41.441137 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:25:41.445599 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:25:41.478765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '593c1f8d-27eb-46cd-a644-f725c4f219aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105ea7500>]}
[0m09:25:41.479377 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m09:25:41.481481 [info ] [MainThread]: 
[0m09:25:41.482027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:25:41.482485 [info ] [MainThread]: 
[0m09:25:41.483165 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:25:41.484165 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m09:25:41.547463 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m09:25:41.547984 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m09:25:41.548384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:25:42.076070 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.528 seconds
[0m09:25:42.078688 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:25:42.168305 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:25:42.168928 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:25:42.298420 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 0.129 seconds
[0m09:25:42.303471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '593c1f8d-27eb-46cd-a644-f725c4f219aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045e06b0>]}
[0m09:25:42.305699 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:25:42.306566 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:25:42.307341 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:25:42.308003 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:25:42.319749 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:25:42.320650 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:25:42.366961 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:25:42.372743 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:25:42.373893 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_sf_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:25:43.033855 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m09:25:43.065369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '593c1f8d-27eb-46cd-a644-f725c4f219aa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c1ba70>]}
[0m09:25:43.066211 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.76s]
[0m09:25:43.067015 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:25:43.068428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:25:43.068779 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:25:43.069136 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:25:43.163957 [info ] [MainThread]: 
[0m09:25:43.164552 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m09:25:43.165622 [debug] [MainThread]: Command end result
[0m09:25:43.191922 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:25:43.194494 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:25:43.202339 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:25:43.202821 [info ] [MainThread]: 
[0m09:25:43.203409 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:25:43.203911 [info ] [MainThread]: 
[0m09:25:43.204405 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:25:43.205713 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.0966594, "process_in_blocks": "0", "process_kernel_time": 0.387098, "process_mem_max_rss": "134164480", "process_out_blocks": "0", "process_user_time": 2.954792}
[0m09:25:43.206533 [debug] [MainThread]: Command `dbt build` succeeded at 09:25:43.206398 after 3.10 seconds
[0m09:25:43.206999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045bb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b8d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ddd30>]}
[0m09:25:43.207499 [debug] [MainThread]: Flushing usage events
[0m09:25:43.414714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:19.217086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137b1520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d7650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1137d73e0>]}


============================== 09:38:19.258505 | 4495a0b2-a3bb-438c-ae21-b59e92df84a5 ==============================
[0m09:38:19.258505 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:38:19.259450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:38:20.168590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4495a0b2-a3bb-438c-ae21-b59e92df84a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111aa4980>]}
[0m09:38:20.240451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4495a0b2-a3bb-438c-ae21-b59e92df84a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114448ef0>]}
[0m09:38:20.241475 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:38:20.432559 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:38:20.553932 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:38:20.554753 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:38:20.781827 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.snowflake.fct_leads' (models/Analytics/fct_leads.sql) depends on a source named 'stg.stg_salesforce_leads' which was not found
[0m09:38:20.783363 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.7642797, "process_in_blocks": "0", "process_kernel_time": 0.347999, "process_mem_max_rss": "117628928", "process_out_blocks": "0", "process_user_time": 2.385656}
[0m09:38:20.784073 [debug] [MainThread]: Command `dbt build` failed at 09:38:20.783933 after 1.77 seconds
[0m09:38:20.784567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112beb800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1134ffc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114c881a0>]}
[0m09:38:20.785031 [debug] [MainThread]: Flushing usage events
[0m09:38:21.093395 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:42.498330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659b6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10659b410>]}


============================== 09:38:42.503680 | 47eea79a-8f98-49a7-b275-c51938011799 ==============================
[0m09:38:42.503680 [info ] [MainThread]: Running with dbt=1.9.1
[0m09:38:42.504790 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:38:43.040654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '47eea79a-8f98-49a7-b275-c51938011799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c11f0>]}
[0m09:38:43.118572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '47eea79a-8f98-49a7-b275-c51938011799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10638d2b0>]}
[0m09:38:43.119753 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m09:38:43.323625 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m09:38:43.448517 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m09:38:43.449426 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/sources/source.yml
[0m09:38:43.449877 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m09:38:43.933685 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m09:38:43.948263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47eea79a-8f98-49a7-b275-c51938011799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d69c70>]}
[0m09:38:44.035818 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:38:44.039143 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:38:44.069913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '47eea79a-8f98-49a7-b275-c51938011799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f6acc0>]}
[0m09:38:44.070500 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m09:38:44.072618 [info ] [MainThread]: 
[0m09:38:44.073140 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:38:44.073583 [info ] [MainThread]: 
[0m09:38:44.074256 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:38:44.075218 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m09:38:44.137493 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m09:38:44.137979 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m09:38:44.138414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:38:44.930285 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.792 seconds
[0m09:38:44.932962 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m09:38:44.945964 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m09:38:44.946574 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m09:38:45.067459 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.120 seconds
[0m09:38:45.072091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '47eea79a-8f98-49a7-b275-c51938011799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10809b6e0>]}
[0m09:38:45.073551 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m09:38:45.074114 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m09:38:45.074722 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m09:38:45.075137 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m09:38:45.088338 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m09:38:45.089528 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m09:38:45.128963 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m09:38:45.134142 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m09:38:45.134814 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m09:38:47.180771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.045 seconds
[0m09:38:47.212907 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47eea79a-8f98-49a7-b275-c51938011799', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078ac4a0>]}
[0m09:38:47.213833 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.14s]
[0m09:38:47.214790 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m09:38:47.216429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:38:47.216813 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m09:38:47.217190 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m09:38:47.326006 [info ] [MainThread]: 
[0m09:38:47.326618 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.25 seconds (3.25s).
[0m09:38:47.327573 [debug] [MainThread]: Command end result
[0m09:38:47.351291 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m09:38:47.354234 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m09:38:47.361192 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m09:38:47.361627 [info ] [MainThread]: 
[0m09:38:47.362188 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:38:47.362785 [info ] [MainThread]: 
[0m09:38:47.363326 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m09:38:47.384397 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.0482993, "process_in_blocks": "0", "process_kernel_time": 0.395002, "process_mem_max_rss": "134488064", "process_out_blocks": "0", "process_user_time": 3.178617}
[0m09:38:47.385677 [debug] [MainThread]: Command `dbt build` succeeded at 09:38:47.385401 after 5.05 seconds
[0m09:38:47.386381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b30140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605eb40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10858ee70>]}
[0m09:38:47.386832 [debug] [MainThread]: Flushing usage events
[0m09:38:47.573303 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:08:32.058318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10918e900>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b7560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b71d0>]}


============================== 10:08:32.120218 | 2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd ==============================
[0m10:08:32.120218 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:08:32.121126 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:08:36.341271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ba20f0>]}
[0m10:08:36.441285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109163f20>]}
[0m10:08:36.471976 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:08:37.716271 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:08:39.335415 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:08:39.335907 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:08:39.346680 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m10:08:39.530644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109dfe570>]}
[0m10:08:39.614286 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:08:39.642925 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:08:39.874920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94d100>]}
[0m10:08:39.875589 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m10:08:39.878399 [info ] [MainThread]: 
[0m10:08:39.879038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:08:39.879475 [info ] [MainThread]: 
[0m10:08:39.880214 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:08:39.881382 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m10:08:40.075668 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m10:08:40.076221 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m10:08:40.076616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:08:42.289063 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 2.212 seconds
[0m10:08:42.291800 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m10:08:42.303185 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m10:08:42.303639 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m10:08:42.434004 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.130 seconds
[0m10:08:42.438173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903bb60>]}
[0m10:08:42.439775 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m10:08:42.440385 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m10:08:42.441005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m10:08:42.441415 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m10:08:42.453610 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m10:08:42.461942 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m10:08:42.504114 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m10:08:42.509114 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m10:08:42.509995 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m10:08:43.669951 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.159 seconds
[0m10:08:43.723139 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2ee014c7-0c9c-4b27-9afb-0da5b71fe4fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10745f9b0>]}
[0m10:08:43.724042 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.26s]
[0m10:08:43.724831 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m10:08:43.726424 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:08:43.726907 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m10:08:43.727417 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m10:08:43.845155 [info ] [MainThread]: 
[0m10:08:43.845951 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.97 seconds (3.97s).
[0m10:08:43.847222 [debug] [MainThread]: Command end result
[0m10:08:43.871123 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:08:43.872978 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:08:43.880702 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m10:08:43.881148 [info ] [MainThread]: 
[0m10:08:43.881780 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:08:43.882245 [info ] [MainThread]: 
[0m10:08:43.882766 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:08:43.901448 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 12.380233, "process_in_blocks": "0", "process_kernel_time": 0.575321, "process_mem_max_rss": "130908160", "process_out_blocks": "0", "process_user_time": 2.890291}
[0m10:08:43.902270 [debug] [MainThread]: Command `dbt build` succeeded at 10:08:43.902133 after 12.38 seconds
[0m10:08:43.902742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f649b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10903bb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa6a0c0>]}
[0m10:08:43.903181 [debug] [MainThread]: Flushing usage events
[0m10:08:44.123171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:19:49.798294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b8138c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f7620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f73b0>]}


============================== 10:19:49.840658 | 25a22143-1d13-4045-a1b5-0de265eda0a5 ==============================
[0m10:19:49.840658 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:19:49.841484 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:19:50.786693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25a22143-1d13-4045-a1b5-0de265eda0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7c6f60>]}
[0m10:19:50.866006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25a22143-1d13-4045-a1b5-0de265eda0a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8e030>]}
[0m10:19:50.867449 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:19:51.170130 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:19:51.331736 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading snowflake: Analytics/analytics.yml - Runtime Error
    Syntax error near line 24
    ------------------------------
    21 |       - name: state
    22 |         description: 'State where the provider operates.'
    23 |       - name: zip
    24 |         description: 'Postal code for the provider's address.'
    25 |       - name: county
    26 |         description: 'County where the provider is located.'
    27 |       - name: first_issue_date
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 23, column 9
    did not find expected key
      in "<unicode string>", line 24, column 52
[0m10:19:51.333307 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.8618685, "process_in_blocks": "0", "process_kernel_time": 0.47764, "process_mem_max_rss": "113410048", "process_out_blocks": "0", "process_user_time": 2.308493}
[0m10:19:51.334002 [debug] [MainThread]: Command `dbt build` failed at 10:19:51.333864 after 1.86 seconds
[0m10:19:51.334517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6f74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec90e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ec90800>]}
[0m10:19:51.334977 [debug] [MainThread]: Flushing usage events
[0m10:19:51.522494 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:19.363953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c8920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eb560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eb2c0>]}


============================== 10:20:19.369652 | 9fb1bc01-cf22-4af0-8715-df515f860443 ==============================
[0m10:20:19.369652 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:20:19.370371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:19.778025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fb1bc01-cf22-4af0-8715-df515f860443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ea256a0>]}
[0m10:20:19.851103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fb1bc01-cf22-4af0-8715-df515f860443', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d10b260>]}
[0m10:20:19.852116 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:20:20.050646 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:20:20.147195 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading snowflake: Analytics/analytics.yml - Runtime Error
    Syntax error near line 44
    ------------------------------
    41 |       - name: operator
    42 |         description: 'Operator or owner of the provider.'
    43 |       - name: license_status
    44 |         description: 'Status of the provider's license.'
    45 |       - name: license_number
    46 |         description: 'Unique license number assigned to the provider.'
    47 |       - name: license_issued
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 43, column 9
    did not find expected key
      in "<unicode string>", line 44, column 46
[0m10:20:20.148831 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 0.9285759, "process_in_blocks": "0", "process_kernel_time": 0.33117, "process_mem_max_rss": "112947200", "process_out_blocks": "0", "process_user_time": 2.179439}
[0m10:20:20.149602 [debug] [MainThread]: Command `dbt build` failed at 10:20:20.149462 after 0.93 seconds
[0m10:20:20.150123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7eb380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ed88650>]}
[0m10:20:20.150582 [debug] [MainThread]: Flushing usage events
[0m10:20:20.337534 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:36.430639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10203c470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6b470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f6b200>]}


============================== 10:20:36.437439 | 56053620-1689-45bb-9d80-f4eca8e1c30f ==============================
[0m10:20:36.437439 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:20:36.438300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:37.016465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '56053620-1689-45bb-9d80-f4eca8e1c30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051eff50>]}
[0m10:20:37.095639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '56053620-1689-45bb-9d80-f4eca8e1c30f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10527f3e0>]}
[0m10:20:37.096949 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:20:37.290537 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:20:37.389251 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading snowflake: Analytics/analytics.yml - Runtime Error
    Syntax error near line 44
    ------------------------------
    41 |       - name: operator
    42 |         description: 'Operator or owner of the provider.'
    43 |       - name: license_status
    44 |         description: 'Status of the provider's license.'
    45 |       - name: license_number
    46 |         description: 'Unique license number assigned to the provider.'
    47 |       - name: license_issued
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 43, column 9
    did not find expected key
      in "<unicode string>", line 44, column 46
[0m10:20:37.390845 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 1.1097417, "process_in_blocks": "0", "process_kernel_time": 0.339496, "process_mem_max_rss": "114159616", "process_out_blocks": "0", "process_user_time": 2.231435}
[0m10:20:37.391589 [debug] [MainThread]: Command `dbt build` failed at 10:20:37.391451 after 1.11 seconds
[0m10:20:37.392100 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103452ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051b9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e39370>]}
[0m10:20:37.392621 [debug] [MainThread]: Flushing usage events
[0m10:20:37.555610 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:20:58.815274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e60a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f69490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3470>]}


============================== 10:20:58.820159 | f3101a50-8b81-4cdc-8275-72c18a0f856a ==============================
[0m10:20:58.820159 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:20:58.820934 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:20:59.202326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f3101a50-8b81-4cdc-8275-72c18a0f856a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091b6030>]}
[0m10:20:59.274137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f3101a50-8b81-4cdc-8275-72c18a0f856a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a21940>]}
[0m10:20:59.275153 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:20:59.452802 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:20:59.602907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m10:20:59.603680 [debug] [MainThread]: Partial parsing: added file: snowflake://models/Analytics/analytics.yml
[0m10:20:59.702167 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dbt_leads_model' in the 'models' section of file 'models/Analytics/analytics.yml'
[0m10:20:59.801192 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m10:20:59.818506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f3101a50-8b81-4cdc-8275-72c18a0f856a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1096ff140>]}
[0m10:20:59.896994 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:20:59.900225 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:20:59.929835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f3101a50-8b81-4cdc-8275-72c18a0f856a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098a16a0>]}
[0m10:20:59.930428 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m10:20:59.932532 [info ] [MainThread]: 
[0m10:20:59.933038 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:20:59.933481 [info ] [MainThread]: 
[0m10:20:59.934167 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:20:59.935175 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m10:20:59.998102 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m10:20:59.998596 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m10:20:59.999006 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:21:00.542802 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.544 seconds
[0m10:21:00.545454 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m10:21:00.557055 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m10:21:00.557518 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m10:21:00.730502 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.172 seconds
[0m10:21:00.734928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f3101a50-8b81-4cdc-8275-72c18a0f856a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109599d00>]}
[0m10:21:00.736319 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m10:21:00.736888 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m10:21:00.737499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m10:21:00.737916 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m10:21:00.749197 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m10:21:00.750724 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m10:21:00.790130 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m10:21:00.870724 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m10:21:00.871428 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m10:21:03.078392 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.206 seconds
[0m10:21:03.112769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f3101a50-8b81-4cdc-8275-72c18a0f856a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106353c80>]}
[0m10:21:03.113604 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.37s]
[0m10:21:03.114494 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m10:21:03.116003 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:21:03.116470 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m10:21:03.116847 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m10:21:03.221900 [info ] [MainThread]: 
[0m10:21:03.222503 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.29 seconds (3.29s).
[0m10:21:03.223889 [debug] [MainThread]: Command end result
[0m10:21:03.248179 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:21:03.250838 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:21:03.257581 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m10:21:03.258061 [info ] [MainThread]: 
[0m10:21:03.258962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:21:03.259493 [info ] [MainThread]: 
[0m10:21:03.260103 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:21:03.261358 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.574001, "process_in_blocks": "0", "process_kernel_time": 0.375285, "process_mem_max_rss": "132796416", "process_out_blocks": "0", "process_user_time": 2.773847}
[0m10:21:03.262018 [debug] [MainThread]: Command `dbt build` succeeded at 10:21:03.261887 after 4.57 seconds
[0m10:21:03.262487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b3530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080b1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10959a8a0>]}
[0m10:21:03.262926 [debug] [MainThread]: Flushing usage events
[0m10:21:03.449656 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:37.923955 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1080c36e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec74a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec7230>]}


============================== 10:24:37.929277 | eff982bc-ff33-4f47-8217-83131d48e5bc ==============================
[0m10:24:37.929277 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:24:37.930105 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:24:38.319763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eff982bc-ff33-4f47-8217-83131d48e5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ad890a0>]}
[0m10:24:38.392978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eff982bc-ff33-4f47-8217-83131d48e5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c105ee0>]}
[0m10:24:38.393993 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:24:38.584576 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:24:38.709136 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:38.709643 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:38.717103 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m10:24:38.753817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eff982bc-ff33-4f47-8217-83131d48e5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c354050>]}
[0m10:24:38.834324 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:24:38.837818 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:24:38.867231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eff982bc-ff33-4f47-8217-83131d48e5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c720680>]}
[0m10:24:38.867814 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m10:24:38.868299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eff982bc-ff33-4f47-8217-83131d48e5bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab1faa0>]}
[0m10:24:38.870425 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m10:24:38.872643 [debug] [MainThread]: Command end result
[0m10:24:38.898176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:24:38.900036 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:24:38.903894 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m10:24:38.905198 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 1.112756, "process_in_blocks": "0", "process_kernel_time": 0.342365, "process_mem_max_rss": "118669312", "process_out_blocks": "0", "process_user_time": 2.336529}
[0m10:24:38.905877 [debug] [MainThread]: Command `dbt test` succeeded at 10:24:38.905746 after 1.11 seconds
[0m10:24:38.906344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a94b1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a30ed80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aec73e0>]}
[0m10:24:38.906770 [debug] [MainThread]: Flushing usage events
[0m10:24:39.111330 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:24:48.085105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff425a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6eff0>]}


============================== 10:24:48.090729 | 6156e08b-1caa-4aa2-958a-11afd38b67c2 ==============================
[0m10:24:48.090729 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:24:48.091542 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m10:24:48.478001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f41fb30>]}
[0m10:24:48.550224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8d9e20>]}
[0m10:24:48.551326 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:24:48.737914 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:24:48.863096 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:24:48.863585 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:24:48.871189 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m10:24:48.908897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1113f41d0>]}
[0m10:24:48.987443 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:24:48.990793 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:24:49.007925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1115d66c0>]}
[0m10:24:49.008524 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m10:24:49.009054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1112ba8a0>]}
[0m10:24:49.011210 [info ] [MainThread]: 
[0m10:24:49.011744 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:24:49.012173 [info ] [MainThread]: 
[0m10:24:49.012860 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:24:49.013973 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m10:24:49.079781 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m10:24:49.080291 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m10:24:49.080689 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:24:49.628515 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.548 seconds
[0m10:24:49.631411 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m10:24:49.642687 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m10:24:49.643099 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m10:24:49.787360 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.144 seconds
[0m10:24:49.791363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff41c70>]}
[0m10:24:49.792766 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m10:24:49.793326 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m10:24:49.793951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m10:24:49.794373 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m10:24:49.806667 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m10:24:49.807791 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m10:24:49.844568 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m10:24:49.849399 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m10:24:49.850023 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m10:24:51.939851 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.089 seconds
[0m10:24:51.970650 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6156e08b-1caa-4aa2-958a-11afd38b67c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e213980>]}
[0m10:24:51.971403 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.18s]
[0m10:24:51.972180 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m10:24:51.973604 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:24:51.973952 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m10:24:51.974313 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m10:24:52.094112 [info ] [MainThread]: 
[0m10:24:52.094736 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.08 seconds (3.08s).
[0m10:24:52.095671 [debug] [MainThread]: Command end result
[0m10:24:52.121098 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:24:52.123119 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:24:52.130103 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m10:24:52.130706 [info ] [MainThread]: 
[0m10:24:52.131218 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:24:52.131725 [info ] [MainThread]: 
[0m10:24:52.132254 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:24:52.133459 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.1757812, "process_in_blocks": "0", "process_kernel_time": 0.377455, "process_mem_max_rss": "129318912", "process_out_blocks": "0", "process_user_time": 2.581763}
[0m10:24:52.134160 [debug] [MainThread]: Command `dbt run` succeeded at 10:24:52.134023 after 4.18 seconds
[0m10:24:52.134640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fc622d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6f0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff6eff0>]}
[0m10:24:52.135082 [debug] [MainThread]: Flushing usage events
[0m10:24:52.329967 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:49:09.251446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f4396d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f467230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f466fc0>]}


============================== 10:49:09.304085 | 676d1031-5c8b-447e-83fb-bd3a3b05a6b9 ==============================
[0m10:49:09.304085 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:49:09.305058 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:49:09.883433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f438650>]}
[0m10:49:09.954578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11071a300>]}
[0m10:49:09.955583 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:49:10.136039 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:49:10.255224 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:49:10.255726 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:49:10.262967 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m10:49:10.300093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1106b41a0>]}
[0m10:49:10.433157 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:49:10.478950 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:49:10.560889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110af6660>]}
[0m10:49:10.561462 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m10:49:10.561901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11090f4d0>]}
[0m10:49:10.563915 [info ] [MainThread]: 
[0m10:49:10.564418 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:49:10.564855 [info ] [MainThread]: 
[0m10:49:10.565524 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:49:10.566480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m10:49:10.633926 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m10:49:10.634399 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m10:49:10.634760 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:49:11.221706 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.587 seconds
[0m10:49:11.224318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m10:49:11.235420 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m10:49:11.235830 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m10:49:11.390248 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.154 seconds
[0m10:49:11.394238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11021f470>]}
[0m10:49:11.395614 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m10:49:11.396173 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m10:49:11.396773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m10:49:11.397187 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m10:49:11.408494 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m10:49:11.409755 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m10:49:11.447205 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m10:49:11.452313 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m10:49:11.452971 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m10:49:14.161564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.708 seconds
[0m10:49:14.193610 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '676d1031-5c8b-447e-83fb-bd3a3b05a6b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d707b60>]}
[0m10:49:14.194377 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.80s]
[0m10:49:14.195178 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m10:49:14.196634 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:49:14.196987 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m10:49:14.197346 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m10:49:14.316330 [info ] [MainThread]: 
[0m10:49:14.316957 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m10:49:14.317872 [debug] [MainThread]: Command end result
[0m10:49:14.342892 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:49:14.345511 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:49:14.352738 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m10:49:14.353421 [info ] [MainThread]: 
[0m10:49:14.354030 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:49:14.354545 [info ] [MainThread]: 
[0m10:49:14.355047 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:49:14.391654 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.312419, "process_in_blocks": "0", "process_kernel_time": 0.38043, "process_mem_max_rss": "129138688", "process_out_blocks": "0", "process_user_time": 2.542143}
[0m10:49:14.392569 [debug] [MainThread]: Command `dbt run` succeeded at 10:49:14.392436 after 5.31 seconds
[0m10:49:14.393048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f439910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110690dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d5c200>]}
[0m10:49:14.393491 [debug] [MainThread]: Flushing usage events
[0m10:49:14.603824 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:54:03.105749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089627e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091faf30>]}


============================== 10:54:03.111154 | 5ec9d477-e879-4130-ab9d-84660cb0ae31 ==============================
[0m10:54:03.111154 [info ] [MainThread]: Running with dbt=1.9.1
[0m10:54:03.111911 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m10:54:03.510123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a1ed280>]}
[0m10:54:03.581210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a041a30>]}
[0m10:54:03.582280 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m10:54:03.767559 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m10:54:03.887239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:54:03.887701 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:54:03.895224 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m10:54:03.931343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5674a0>]}
[0m10:54:04.008824 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:54:04.011986 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:54:04.028407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a892150>]}
[0m10:54:04.028977 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m10:54:04.029455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6fd550>]}
[0m10:54:04.031425 [info ] [MainThread]: 
[0m10:54:04.031970 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m10:54:04.032408 [info ] [MainThread]: 
[0m10:54:04.033086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:54:04.034060 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m10:54:04.096120 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m10:54:04.096603 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m10:54:04.096986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:04.624445 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.527 seconds
[0m10:54:04.627273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m10:54:04.638782 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m10:54:04.639212 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m10:54:04.779658 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.140 seconds
[0m10:54:04.783673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a54c6b0>]}
[0m10:54:04.785023 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m10:54:04.785574 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m10:54:04.786173 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m10:54:04.786576 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m10:54:04.797576 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m10:54:04.799454 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m10:54:04.835513 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m10:54:04.840005 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m10:54:04.840567 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m10:54:06.673428 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.832 seconds
[0m10:54:06.704145 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5ec9d477-e879-4130-ab9d-84660cb0ae31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074a3b90>]}
[0m10:54:06.704984 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.92s]
[0m10:54:06.705876 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m10:54:06.707600 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:54:06.707984 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m10:54:06.708362 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m10:54:06.804492 [info ] [MainThread]: 
[0m10:54:06.805147 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.77 seconds (2.77s).
[0m10:54:06.806106 [debug] [MainThread]: Command end result
[0m10:54:06.830764 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m10:54:06.832660 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m10:54:06.840374 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m10:54:06.840854 [info ] [MainThread]: 
[0m10:54:06.841557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:54:06.842102 [info ] [MainThread]: 
[0m10:54:06.842705 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m10:54:06.844072 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.8667402, "process_in_blocks": "0", "process_kernel_time": 0.370742, "process_mem_max_rss": "128393216", "process_out_blocks": "0", "process_user_time": 2.53033}
[0m10:54:06.844807 [debug] [MainThread]: Command `dbt run` succeeded at 10:54:06.844665 after 3.87 seconds
[0m10:54:06.845406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108699130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fb2c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091fafc0>]}
[0m10:54:06.845862 [debug] [MainThread]: Flushing usage events
[0m10:54:07.051367 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:05:51.030715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ba0230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c54fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca33b0>]}


============================== 11:05:51.036028 | 54c139b7-11ee-457b-907f-cc167a9f79da ==============================
[0m11:05:51.036028 [info ] [MainThread]: Running with dbt=1.9.1
[0m11:05:51.036771 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m11:05:51.510015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ac977d0>]}
[0m11:05:51.580590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aeabf20>]}
[0m11:05:51.581585 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m11:05:51.767431 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m11:05:51.931887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:05:51.932369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:05:51.939689 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m11:05:51.975317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afe7fe0>]}
[0m11:05:52.052301 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m11:05:52.055523 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m11:05:52.081025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b33a4e0>]}
[0m11:05:52.081602 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m11:05:52.082070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afee8a0>]}
[0m11:05:52.084128 [info ] [MainThread]: 
[0m11:05:52.084633 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:05:52.085070 [info ] [MainThread]: 
[0m11:05:52.085742 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:05:52.086765 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m11:05:52.151861 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m11:05:52.152344 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m11:05:52.152708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:05:52.690724 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.538 seconds
[0m11:05:52.693327 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m11:05:52.704575 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m11:05:52.704984 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m11:05:52.851364 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.146 seconds
[0m11:05:52.855376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aed4170>]}
[0m11:05:52.856739 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m11:05:52.857297 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m11:05:52.857905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m11:05:52.858319 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m11:05:52.870637 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m11:05:52.871677 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m11:05:52.907438 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m11:05:52.912120 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m11:05:52.912701 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m11:05:55.311376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.381 seconds
[0m11:05:55.380001 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54c139b7-11ee-457b-907f-cc167a9f79da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f47ec0>]}
[0m11:05:55.380777 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.52s]
[0m11:05:55.381890 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m11:05:55.383378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:05:55.383731 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m11:05:55.384091 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m11:05:55.528965 [info ] [MainThread]: 
[0m11:05:55.529637 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.44 seconds (3.44s).
[0m11:05:55.530556 [debug] [MainThread]: Command end result
[0m11:05:55.559280 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m11:05:55.561170 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m11:05:55.568564 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m11:05:55.569051 [info ] [MainThread]: 
[0m11:05:55.569651 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:05:55.570142 [info ] [MainThread]: 
[0m11:05:55.570683 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:05:55.633745 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.7437563, "process_in_blocks": "0", "process_kernel_time": 0.381105, "process_mem_max_rss": "128606208", "process_out_blocks": "0", "process_user_time": 2.529045}
[0m11:05:55.634585 [debug] [MainThread]: Command `dbt run` succeeded at 11:05:55.634449 after 4.74 seconds
[0m11:05:55.635054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ca3500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1090e3d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108bb2660>]}
[0m11:05:55.635494 [debug] [MainThread]: Flushing usage events
[0m11:05:55.852925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:18:42.303547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e68cce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b7440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b71d0>]}


============================== 11:18:42.523537 | bd4a0610-601f-4a36-a9fe-b4c99fcc74f8 ==============================
[0m11:18:42.523537 [info ] [MainThread]: Running with dbt=1.9.1
[0m11:18:42.524429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:18:43.397267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e78cf80>]}
[0m11:18:43.471927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6dcec0>]}
[0m11:18:43.473215 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m11:18:43.729865 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m11:18:43.902091 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:18:43.902602 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:18:43.909975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m11:18:43.948648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e78f920>]}
[0m11:18:44.052100 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m11:18:44.055665 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m11:18:44.160604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd22450>]}
[0m11:18:44.161188 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m11:18:44.161675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f9e4b30>]}
[0m11:18:44.163642 [info ] [MainThread]: 
[0m11:18:44.164149 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:18:44.164584 [info ] [MainThread]: 
[0m11:18:44.165259 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:18:44.166221 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m11:18:44.391888 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m11:18:44.392396 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m11:18:44.392761 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:18:45.348394 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.956 seconds
[0m11:18:45.351027 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m11:18:45.362654 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m11:18:45.363108 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m11:18:45.523708 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.160 seconds
[0m11:18:45.527714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd1f710>]}
[0m11:18:45.529079 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m11:18:45.529635 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m11:18:45.530239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m11:18:45.530647 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m11:18:45.542563 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m11:18:45.543613 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m11:18:45.589458 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m11:18:45.624939 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m11:18:45.625635 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m11:18:47.776642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.150 seconds
[0m11:18:47.823254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd4a0610-601f-4a36-a9fe-b4c99fcc74f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c95bb90>]}
[0m11:18:47.824208 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.28s]
[0m11:18:47.825115 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m11:18:47.826607 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:18:47.826955 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m11:18:47.827315 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m11:18:47.938925 [info ] [MainThread]: 
[0m11:18:47.939581 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m11:18:47.940513 [debug] [MainThread]: Command end result
[0m11:18:47.965778 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m11:18:47.968102 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m11:18:48.017013 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m11:18:48.017480 [info ] [MainThread]: 
[0m11:18:48.018001 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:18:48.018401 [info ] [MainThread]: 
[0m11:18:48.018958 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m11:18:48.034798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0870943, "process_in_blocks": "0", "process_kernel_time": 0.558746, "process_mem_max_rss": "128491520", "process_out_blocks": "0", "process_user_time": 2.853651}
[0m11:18:48.035672 [debug] [MainThread]: Command `dbt run` succeeded at 11:18:48.035541 after 6.09 seconds
[0m11:18:48.036139 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b71a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6b7320>]}
[0m11:18:48.036574 [debug] [MainThread]: Flushing usage events
[0m11:18:48.252719 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:44:23.973252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ec81d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef3350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ef30b0>]}


============================== 14:44:24.195187 | e0202d06-03c2-499a-8bc4-e8c265c19384 ==============================
[0m14:44:24.195187 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:44:24.196104 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:44:25.179925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109df4a40>]}
[0m14:44:25.251386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e38470>]}
[0m14:44:25.252658 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:44:25.533969 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:44:25.828437 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:44:25.829281 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/analytics.yml
[0m14:44:25.927702 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dbt_leads_model' in the 'models' section of file 'models/Analytics/analytics.yml'
[0m14:44:26.067452 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.snowflake.not_null_dbt_leads_model_provider_id.947941bf5c' (models/Analytics/analytics.yml) depends on a node named 'dbt_leads_model' in package '' which was not found
[0m14:44:26.068107 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.snowflake.unique_dbt_leads_model_provider_id.bf92f3714d' (models/Analytics/analytics.yml) depends on a node named 'dbt_leads_model' in package '' which was not found
[0m14:44:26.179883 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m14:44:26.197572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a173e00>]}
[0m14:44:26.296569 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m14:44:26.300024 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m14:44:26.405783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6da3f0>]}
[0m14:44:26.406365 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m14:44:26.406825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a659e20>]}
[0m14:44:26.408875 [info ] [MainThread]: 
[0m14:44:26.409367 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:44:26.409863 [info ] [MainThread]: 
[0m14:44:26.410533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:44:26.411507 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m14:44:26.559441 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m14:44:26.559941 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m14:44:26.560319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:44:27.424181 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.864 seconds
[0m14:44:27.426963 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m14:44:27.438232 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m14:44:27.438662 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m14:44:27.612085 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.173 seconds
[0m14:44:27.616232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aace210>]}
[0m14:44:27.618534 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m14:44:27.619320 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m14:44:27.620002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m14:44:27.620475 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m14:44:27.637321 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m14:44:27.638800 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m14:44:27.764553 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m14:44:27.769695 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m14:44:27.770403 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m14:44:30.249861 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.479 seconds
[0m14:44:30.282585 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0202d06-03c2-499a-8bc4-e8c265c19384', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083313a0>]}
[0m14:44:30.283462 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.66s]
[0m14:44:30.284276 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m14:44:30.285778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:44:30.286169 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m14:44:30.286573 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m14:44:30.396053 [info ] [MainThread]: 
[0m14:44:30.396715 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m14:44:30.397627 [debug] [MainThread]: Command end result
[0m14:44:30.422271 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m14:44:30.425434 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m14:44:30.432079 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m14:44:30.432527 [info ] [MainThread]: 
[0m14:44:30.433400 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:44:30.433890 [info ] [MainThread]: 
[0m14:44:30.434403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:44:30.462973 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.795707, "process_in_blocks": "0", "process_kernel_time": 0.538357, "process_mem_max_rss": "130781184", "process_out_blocks": "0", "process_user_time": 3.114563}
[0m14:44:30.463754 [debug] [MainThread]: Command `dbt run` succeeded at 14:44:30.463627 after 6.80 seconds
[0m14:44:30.464212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108ce62a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089aee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1089afc20>]}
[0m14:44:30.464693 [debug] [MainThread]: Flushing usage events
[0m14:44:30.685411 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:45:28.197467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c6dd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc74d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc7260>]}


============================== 14:45:28.203197 | 1b311ecb-8543-416f-bec7-c76c91fcc285 ==============================
[0m14:45:28.203197 [info ] [MainThread]: Running with dbt=1.9.1
[0m14:45:28.203988 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:45:28.591872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1072aec30>]}
[0m14:45:28.665412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fed640>]}
[0m14:45:28.666478 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m14:45:28.862624 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m14:45:29.003667 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:45:29.004161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:45:29.012081 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m14:45:29.062193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10603c5f0>]}
[0m14:45:29.157382 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m14:45:29.160697 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m14:45:29.177835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076428a0>]}
[0m14:45:29.178444 [info ] [MainThread]: Found 1 model, 4 sources, 468 macros
[0m14:45:29.178965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107489760>]}
[0m14:45:29.181068 [info ] [MainThread]: 
[0m14:45:29.181592 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:45:29.182041 [info ] [MainThread]: 
[0m14:45:29.182748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:45:29.183748 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m14:45:29.249033 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m14:45:29.249569 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m14:45:29.249999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:45:29.901738 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.652 seconds
[0m14:45:29.904460 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m14:45:29.915691 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m14:45:29.916117 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m14:45:30.093489 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 0.177 seconds
[0m14:45:30.097534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fece30>]}
[0m14:45:30.098899 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m14:45:30.099460 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m14:45:30.100070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m14:45:30.100484 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m14:45:30.111631 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m14:45:30.113307 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m14:45:30.150498 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m14:45:30.155282 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m14:45:30.155884 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m14:45:32.404304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.248 seconds
[0m14:45:32.436679 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b311ecb-8543-416f-bec7-c76c91fcc285', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10426f950>]}
[0m14:45:32.437448 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.34s]
[0m14:45:32.438257 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m14:45:32.439739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:45:32.440094 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m14:45:32.440461 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m14:45:32.562151 [info ] [MainThread]: 
[0m14:45:32.562881 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m14:45:32.563830 [debug] [MainThread]: Command end result
[0m14:45:32.590096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m14:45:32.591982 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m14:45:32.599053 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m14:45:32.599570 [info ] [MainThread]: 
[0m14:45:32.600273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:45:32.600763 [info ] [MainThread]: 
[0m14:45:32.601267 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:45:32.602516 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.53142, "process_in_blocks": "0", "process_kernel_time": 0.384335, "process_mem_max_rss": "127856640", "process_out_blocks": "0", "process_user_time": 2.635422}
[0m14:45:32.603243 [debug] [MainThread]: Command `dbt run` succeeded at 14:45:32.603064 after 4.53 seconds
[0m14:45:32.603709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e80800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105406c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105407c80>]}
[0m14:45:32.604138 [debug] [MainThread]: Flushing usage events
[0m14:45:32.789457 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:25:35.144667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074bd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e32c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074e3020>]}


============================== 15:25:35.242208 | caf05d60-1735-4dcb-8cc2-2e55ed5c684d ==============================
[0m15:25:35.242208 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:25:35.243544 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:25:36.575127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108699010>]}
[0m15:25:36.646327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085bad50>]}
[0m15:25:36.647569 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:25:36.999192 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:25:37.275169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:25:37.276007 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/analytics.yml
[0m15:25:37.610305 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m15:25:37.628508 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108814380>]}
[0m15:25:37.722829 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m15:25:37.759213 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m15:25:37.879932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cbb470>]}
[0m15:25:37.880516 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m15:25:37.880960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5c560>]}
[0m15:25:37.883077 [info ] [MainThread]: 
[0m15:25:37.883577 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:25:37.883990 [info ] [MainThread]: 
[0m15:25:37.884622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:37.885583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m15:25:38.025578 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m15:25:38.026073 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m15:25:38.026440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:38.987062 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.961 seconds
[0m15:25:38.990041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m15:25:39.001600 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m15:25:39.002048 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m15:25:39.096401 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.094 seconds
[0m15:25:39.100158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108c9f470>]}
[0m15:25:39.101569 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m15:25:39.102128 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m15:25:39.102788 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m15:25:39.103212 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m15:25:39.195792 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m15:25:39.234553 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m15:25:39.271125 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m15:25:39.295922 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m15:25:39.296852 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        created_date, 
        last_modified_date, 
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m15:25:40.655410 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.358 seconds
[0m15:25:40.705950 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'caf05d60-1735-4dcb-8cc2-2e55ed5c684d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b0c320>]}
[0m15:25:40.719911 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.58s]
[0m15:25:40.720874 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m15:25:40.722663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:40.723075 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m15:25:40.723463 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m15:25:40.823397 [info ] [MainThread]: 
[0m15:25:40.824020 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.94 seconds (2.94s).
[0m15:25:40.824928 [debug] [MainThread]: Command end result
[0m15:25:40.853273 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m15:25:40.855357 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m15:25:40.862237 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m15:25:40.862699 [info ] [MainThread]: 
[0m15:25:40.863608 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:25:40.864159 [info ] [MainThread]: 
[0m15:25:40.864819 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:25:40.884445 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.0716634, "process_in_blocks": "0", "process_kernel_time": 0.581951, "process_mem_max_rss": "131997696", "process_out_blocks": "0", "process_user_time": 3.098436}
[0m15:25:40.885258 [debug] [MainThread]: Command `dbt run` succeeded at 15:25:40.885132 after 6.07 seconds
[0m15:25:40.885716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104411e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b58590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b5b290>]}
[0m15:25:40.886137 [debug] [MainThread]: Flushing usage events
[0m15:25:41.152826 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:26:55.039600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b5970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052db4a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052db200>]}


============================== 15:26:55.080762 | 68c28153-22a8-4935-a335-7e496f708f71 ==============================
[0m15:26:55.080762 [info ] [MainThread]: Running with dbt=1.9.1
[0m15:26:55.081550 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m15:26:55.595640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106547740>]}
[0m15:26:55.667403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064c5850>]}
[0m15:26:55.668409 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m15:26:55.846685 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m15:26:55.990014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:26:55.990825 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m15:26:56.490602 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m15:26:56.508640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c3f470>]}
[0m15:26:56.605658 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m15:26:56.609734 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m15:26:56.673620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f91280>]}
[0m15:26:56.674210 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m15:26:56.674691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042d75f0>]}
[0m15:26:56.676987 [info ] [MainThread]: 
[0m15:26:56.677554 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:26:56.678061 [info ] [MainThread]: 
[0m15:26:56.678725 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:26:56.679681 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m15:26:56.788535 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m15:26:56.789022 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m15:26:56.789387 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:26:57.431959 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m15:26:57.455683 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m15:26:57.467974 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m15:26:57.468467 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m15:26:57.546400 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.078 seconds
[0m15:26:57.549967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c2c770>]}
[0m15:26:57.551712 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m15:26:57.552283 [info ] [Thread-1 (]: 1 of 1 START sql table model STG.fct_leads ..................................... [RUN]
[0m15:26:57.552885 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m15:26:57.553293 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m15:26:57.564519 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m15:26:57.566371 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m15:26:57.603177 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m15:26:57.608125 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m15:26:57.608805 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m15:26:58.630752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.021 seconds
[0m15:26:58.677835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '68c28153-22a8-4935-a335-7e496f708f71', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103583d40>]}
[0m15:26:58.678803 [info ] [Thread-1 (]: 1 of 1 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.11s]
[0m15:26:58.679620 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m15:26:58.681077 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:26:58.681425 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m15:26:58.681780 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m15:26:58.775952 [info ] [MainThread]: 
[0m15:26:58.776582 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m15:26:58.777510 [debug] [MainThread]: Command end result
[0m15:26:58.804583 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m15:26:58.806941 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m15:26:58.815046 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m15:26:58.815497 [info ] [MainThread]: 
[0m15:26:58.816009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:26:58.816550 [info ] [MainThread]: 
[0m15:26:58.817042 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:26:58.872808 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.0391207, "process_in_blocks": "0", "process_kernel_time": 0.476204, "process_mem_max_rss": "133431296", "process_out_blocks": "0", "process_user_time": 3.220914}
[0m15:26:58.873751 [debug] [MainThread]: Command `dbt run` succeeded at 15:26:58.873612 after 4.04 seconds
[0m15:26:58.874247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c8a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f91280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069b5460>]}
[0m15:26:58.874677 [debug] [MainThread]: Flushing usage events
[0m15:26:59.081959 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:43:01.765524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063d3a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b3560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1082b32c0>]}


============================== 16:43:01.844718 | f7368b75-3903-4623-bfa0-3371926acaf5 ==============================
[0m16:43:01.844718 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:43:01.845716 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:03.195797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f7368b75-3903-4623-bfa0-3371926acaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107603dd0>]}
[0m16:43:03.268608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f7368b75-3903-4623-bfa0-3371926acaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109142720>]}
[0m16:43:03.269896 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:43:03.513626 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:43:03.856801 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:43:03.857279 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:43:03.863411 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m16:43:03.914186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f7368b75-3903-4623-bfa0-3371926acaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10973c7d0>]}
[0m16:43:04.019253 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:43:04.046617 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:43:04.236917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f7368b75-3903-4623-bfa0-3371926acaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10995b050>]}
[0m16:43:04.237525 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m16:43:04.239611 [info ] [MainThread]: 
[0m16:43:04.240110 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:43:04.240508 [info ] [MainThread]: 
[0m16:43:04.241232 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:04.242202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m16:43:04.387178 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m16:43:04.387674 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m16:43:04.388040 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:05.124672 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.737 seconds
[0m16:43:05.127555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m16:43:05.140121 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m16:43:05.140614 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m16:43:05.245041 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.104 seconds
[0m16:43:05.248619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f7368b75-3903-4623-bfa0-3371926acaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e83740>]}
[0m16:43:05.250284 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m16:43:05.250852 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m16:43:05.251458 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m16:43:05.251874 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m16:43:05.263073 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m16:43:05.264220 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m16:43:05.302400 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m16:43:05.309233 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m16:43:05.309901 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m16:43:07.644094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.334 seconds
[0m16:43:07.693254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f7368b75-3903-4623-bfa0-3371926acaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076f1490>]}
[0m16:43:07.694167 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.42s]
[0m16:43:07.695072 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m16:43:07.696239 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:43:07.696678 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m16:43:07.697303 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m16:43:07.697719 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:43:07.711750 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m16:43:07.712889 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:43:07.733906 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m16:43:07.735748 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m16:43:07.736738 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m16:43:09.006622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.269 seconds
[0m16:43:09.011202 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 1.31s]
[0m16:43:09.012103 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:43:09.012594 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:43:09.013175 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m16:43:09.013828 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m16:43:09.014251 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:43:09.024623 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m16:43:09.025908 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:43:09.028962 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m16:43:09.030298 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m16:43:09.030735 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:09.162206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m16:43:09.164665 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.15s]
[0m16:43:09.165464 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:43:09.166874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:09.167223 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m16:43:09.167583 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m16:43:09.272746 [info ] [MainThread]: 
[0m16:43:09.273349 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 5.03 seconds (5.03s).
[0m16:43:09.274734 [debug] [MainThread]: Command end result
[0m16:43:09.383412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:43:09.385200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:43:09.391983 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:43:09.392364 [info ] [MainThread]: 
[0m16:43:09.392880 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:09.393539 [info ] [MainThread]: 
[0m16:43:09.394031 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:43:09.413313 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 8.013729, "process_in_blocks": "0", "process_kernel_time": 0.573174, "process_mem_max_rss": "132661248", "process_out_blocks": "0", "process_user_time": 2.95288}
[0m16:43:09.414163 [debug] [MainThread]: Command `dbt build` succeeded at 16:43:09.414033 after 8.01 seconds
[0m16:43:09.414738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e77a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f20fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10655bc80>]}
[0m16:43:09.415268 [debug] [MainThread]: Flushing usage events
[0m16:43:09.623260 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:25.333435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e042f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef13380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef12ff0>]}


============================== 16:56:25.338731 | 64b86867-2f39-43b8-bea4-8566fdfa29ff ==============================
[0m16:56:25.338731 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:56:25.339573 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:56:25.728345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64b86867-2f39-43b8-bea4-8566fdfa29ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e736f60>]}
[0m16:56:25.800018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64b86867-2f39-43b8-bea4-8566fdfa29ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101ae330>]}
[0m16:56:25.801076 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m16:56:25.987713 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m16:56:26.128572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:26.129056 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:26.135132 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m16:56:26.187116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64b86867-2f39-43b8-bea4-8566fdfa29ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110237ec0>]}
[0m16:56:26.280957 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:56:26.284253 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:56:26.314856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64b86867-2f39-43b8-bea4-8566fdfa29ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105b6cf0>]}
[0m16:56:26.315461 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m16:56:26.317668 [info ] [MainThread]: 
[0m16:56:26.318226 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m16:56:26.318809 [info ] [MainThread]: 
[0m16:56:26.319631 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:56:26.320680 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m16:56:26.387285 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m16:56:26.387927 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m16:56:26.388505 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:26.887436 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.499 seconds
[0m16:56:26.890092 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m16:56:26.902030 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m16:56:26.902504 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m16:56:26.986262 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.083 seconds
[0m16:56:26.990259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64b86867-2f39-43b8-bea4-8566fdfa29ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111465490>]}
[0m16:56:26.991671 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m16:56:26.992231 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m16:56:26.992831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m16:56:26.993242 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m16:56:27.004717 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m16:56:27.005684 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m16:56:27.044414 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m16:56:27.050761 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m16:56:27.051445 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m16:56:28.974700 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.923 seconds
[0m16:56:29.005642 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64b86867-2f39-43b8-bea4-8566fdfa29ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e345550>]}
[0m16:56:29.006402 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.01s]
[0m16:56:29.007204 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m16:56:29.008154 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:56:29.008639 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m16:56:29.009278 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m16:56:29.009723 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:56:29.026025 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m16:56:29.026904 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:56:29.046195 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m16:56:29.047655 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m16:56:29.048174 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m16:56:30.265291 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.217 seconds
[0m16:56:30.269673 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 1.26s]
[0m16:56:30.270491 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m16:56:30.270953 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:56:30.271545 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m16:56:30.272175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m16:56:30.272701 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:56:30.281361 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m16:56:30.282318 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:56:30.285145 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m16:56:30.286251 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m16:56:30.286684 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:56:31.501543 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.214 seconds
[0m16:56:31.503921 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 1.23s]
[0m16:56:31.504714 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m16:56:31.506173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:31.506667 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m16:56:31.507317 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m16:56:31.608975 [info ] [MainThread]: 
[0m16:56:31.609579 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m16:56:31.610883 [debug] [MainThread]: Command end result
[0m16:56:31.801796 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m16:56:31.804220 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m16:56:31.812504 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m16:56:31.812978 [info ] [MainThread]: 
[0m16:56:31.813522 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:56:31.814119 [info ] [MainThread]: 
[0m16:56:31.814668 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m16:56:31.815897 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 6.608718, "process_in_blocks": "0", "process_kernel_time": 0.483297, "process_mem_max_rss": "131465216", "process_out_blocks": "0", "process_user_time": 2.922373}
[0m16:56:31.816612 [debug] [MainThread]: Command `dbt build` succeeded at 16:56:31.816467 after 6.61 seconds
[0m16:56:31.817125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaab0e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111510a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff25430>]}
[0m16:56:31.817736 [debug] [MainThread]: Flushing usage events
[0m16:56:32.046471 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:05:26.335739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c791100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b7410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7b7170>]}


============================== 17:05:26.341006 | bf05a28e-e38d-4400-ae6c-65c8f5fd96c9 ==============================
[0m17:05:26.341006 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:05:26.341855 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select fct_leads', 'send_anonymous_usage_stats': 'True'}
[0m17:05:26.720828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf05a28e-e38d-4400-ae6c-65c8f5fd96c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d6fc860>]}
[0m17:05:26.791836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf05a28e-e38d-4400-ae6c-65c8f5fd96c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5c22d0>]}
[0m17:05:26.792890 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:05:26.975764 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:05:27.116953 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:27.117446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:27.123754 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m17:05:27.176350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf05a28e-e38d-4400-ae6c-65c8f5fd96c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9de3f0>]}
[0m17:05:27.273332 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:05:27.276859 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:05:27.307530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf05a28e-e38d-4400-ae6c-65c8f5fd96c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c7693d0>]}
[0m17:05:27.308148 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m17:05:27.310255 [info ] [MainThread]: 
[0m17:05:27.310789 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:05:27.311277 [info ] [MainThread]: 
[0m17:05:27.311975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:05:27.312983 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:05:27.378701 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:05:27.379200 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:05:27.379564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:27.844676 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.465 seconds
[0m17:05:27.847330 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:05:27.858646 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:05:27.859074 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:05:27.964906 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.105 seconds
[0m17:05:27.968621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf05a28e-e38d-4400-ae6c-65c8f5fd96c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4f2990>]}
[0m17:05:27.970001 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m17:05:27.970560 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m17:05:27.971139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m17:05:27.971550 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m17:05:27.984531 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m17:05:27.985507 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m17:05:28.022398 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m17:05:28.028418 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m17:05:28.029120 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        brightwheel_school_uuid_c AS website_address
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m17:05:30.030500 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.001 seconds
[0m17:05:30.062164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf05a28e-e38d-4400-ae6c-65c8f5fd96c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbf15b0>]}
[0m17:05:30.063323 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.09s]
[0m17:05:30.064270 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m17:05:30.065503 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:05:30.066049 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m17:05:30.066731 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m17:05:30.067155 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:05:30.083339 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m17:05:30.084382 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:05:30.105571 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m17:05:30.107196 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m17:05:30.107777 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m17:05:30.283351 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.175 seconds
[0m17:05:30.287757 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 0.22s]
[0m17:05:30.288547 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:05:30.289012 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:05:30.289502 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m17:05:30.290086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m17:05:30.290500 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:05:30.298333 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m17:05:30.299238 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:05:30.303796 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m17:05:30.305139 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m17:05:30.305570 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:05:30.476222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.170 seconds
[0m17:05:30.478602 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.19s]
[0m17:05:30.479392 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:05:30.480739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:05:30.481088 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m17:05:30.481447 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m17:05:30.588081 [info ] [MainThread]: 
[0m17:05:30.588721 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 3.28 seconds (3.28s).
[0m17:05:30.590017 [debug] [MainThread]: Command end result
[0m17:05:30.691852 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:05:30.693651 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:05:30.700241 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:05:30.700641 [info ] [MainThread]: 
[0m17:05:30.701165 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:05:30.701629 [info ] [MainThread]: 
[0m17:05:30.702223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:05:30.703609 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.4939313, "process_in_blocks": "0", "process_kernel_time": 0.373547, "process_mem_max_rss": "131497984", "process_out_blocks": "0", "process_user_time": 2.739372}
[0m17:05:30.704274 [debug] [MainThread]: Command `dbt build` succeeded at 17:05:30.704147 after 4.49 seconds
[0m17:05:30.704729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7df260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa5fda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eea35c0>]}
[0m17:05:30.705158 [debug] [MainThread]: Flushing usage events
[0m17:05:30.902757 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:07:42.941536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1107c7bf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109acdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bff320>]}


============================== 17:07:42.947435 | c11a5ec6-0b58-4c16-8a21-0f0261c98dc3 ==============================
[0m17:07:42.947435 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:07:42.948229 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:07:43.341387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c11a5ec6-0b58-4c16-8a21-0f0261c98dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112e86f90>]}
[0m17:07:43.413186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c11a5ec6-0b58-4c16-8a21-0f0261c98dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1111dfec0>]}
[0m17:07:43.414202 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:07:43.619672 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:07:43.803933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:07:43.804959 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m17:07:44.360030 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m17:07:44.377456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c11a5ec6-0b58-4c16-8a21-0f0261c98dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133c0620>]}
[0m17:07:44.482464 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:07:44.485772 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:07:44.520288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c11a5ec6-0b58-4c16-8a21-0f0261c98dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113690980>]}
[0m17:07:44.521183 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m17:07:44.523572 [info ] [MainThread]: 
[0m17:07:44.524177 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:07:44.524635 [info ] [MainThread]: 
[0m17:07:44.525354 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:07:44.526587 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:07:44.677099 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:07:44.677576 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:07:44.677930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:45.221614 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.544 seconds
[0m17:07:45.224351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:07:45.237170 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:07:45.237675 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:07:45.333050 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.095 seconds
[0m17:07:45.336860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c11a5ec6-0b58-4c16-8a21-0f0261c98dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133b4710>]}
[0m17:07:45.338219 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m17:07:45.338774 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m17:07:45.339402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m17:07:45.339836 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m17:07:45.351692 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m17:07:45.352604 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m17:07:45.393333 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m17:07:45.398828 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m17:07:45.399675 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website_address,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m17:07:45.757262 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9302b-0002-4299-0007-02f20001a902
[0m17:07:45.760974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 31 at position 8
invalid identifier 'WEBSITE_ADDRESS'
[0m17:07:45.805150 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 31 at position 8
  invalid identifier 'WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m17:07:45.807161 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c11a5ec6-0b58-4c16-8a21-0f0261c98dc3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111039850>]}
[0m17:07:45.807868 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.47s]
[0m17:07:45.808676 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m17:07:45.809459 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 31 at position 8
  invalid identifier 'WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m17:07:45.810781 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:07:45.811288 [info ] [Thread-1 (]: 2 of 3 SKIP test not_null_fct_leads_provider_id ................................ [[33mSKIP[0m]
[0m17:07:45.811861 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:07:45.812345 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:07:45.812901 [debug] [Thread-4 (]: Marking all children of 'test.snowflake.not_null_fct_leads_provider_id.bc48999026' to be skipped because of status 'skipped'. 
[0m17:07:45.813457 [info ] [Thread-1 (]: 3 of 3 SKIP test unique_fct_leads_provider_id .................................. [[33mSKIP[0m]
[0m17:07:45.814377 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:07:45.814846 [debug] [Thread-4 (]: Marking all children of 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' to be skipped because of status 'skipped'. 
[0m17:07:45.816328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:45.816747 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m17:07:45.817154 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m17:07:45.929636 [info ] [MainThread]: 
[0m17:07:45.930269 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 1.40 seconds (1.40s).
[0m17:07:45.931760 [debug] [MainThread]: Command end result
[0m17:07:45.958754 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:07:45.961103 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:07:45.969371 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:07:45.970054 [info ] [MainThread]: 
[0m17:07:45.970635 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:07:45.971117 [info ] [MainThread]: 
[0m17:07:45.971800 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 31 at position 8
  invalid identifier 'WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m17:07:45.972310 [info ] [MainThread]: 
[0m17:07:45.972808 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m17:07:45.974074 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.1750162, "process_in_blocks": "0", "process_kernel_time": 0.417573, "process_mem_max_rss": "136126464", "process_out_blocks": "0", "process_user_time": 3.299546}
[0m17:07:45.975035 [debug] [MainThread]: Command `dbt build` failed at 17:07:45.974855 after 3.18 seconds
[0m17:07:45.975760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11350f6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bff2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111bff470>]}
[0m17:07:45.976721 [debug] [MainThread]: Flushing usage events
[0m17:07:46.193157 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:36.871768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c11bbf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a33b0>]}


============================== 17:09:36.877201 | 7548f27e-827d-4eff-80aa-1886c22b68e7 ==============================
[0m17:09:36.877201 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:09:36.877970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:09:37.307133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7548f27e-827d-4eff-80aa-1886c22b68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d994e90>]}
[0m17:09:37.392170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7548f27e-827d-4eff-80aa-1886c22b68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dca62a0>]}
[0m17:09:37.393314 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:09:37.604973 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:09:37.867427 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:09:37.868457 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/analytics.yml
[0m17:09:38.457974 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m17:09:38.474676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7548f27e-827d-4eff-80aa-1886c22b68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f8b8d40>]}
[0m17:09:38.581185 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:09:38.585100 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:09:38.618451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7548f27e-827d-4eff-80aa-1886c22b68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa0a270>]}
[0m17:09:38.619104 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m17:09:38.621191 [info ] [MainThread]: 
[0m17:09:38.621646 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:38.622034 [info ] [MainThread]: 
[0m17:09:38.622666 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:38.623658 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:09:38.777032 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:09:38.777536 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:09:38.777905 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:39.398452 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.620 seconds
[0m17:09:39.401233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:09:39.413505 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:09:39.413990 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:09:39.525098 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.111 seconds
[0m17:09:39.528770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7548f27e-827d-4eff-80aa-1886c22b68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f183020>]}
[0m17:09:39.530113 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m17:09:39.530666 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m17:09:39.531309 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m17:09:39.531895 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m17:09:39.543430 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m17:09:39.544390 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m17:09:39.585774 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m17:09:39.591089 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m17:09:39.591785 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website_address,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m17:09:39.695199 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9302d-0002-42a0-0007-02f20001c02e
[0m17:09:39.695734 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 31 at position 8
invalid identifier 'WEBSITE_ADDRESS'
[0m17:09:39.699259 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 31 at position 8
  invalid identifier 'WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m17:09:39.701092 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7548f27e-827d-4eff-80aa-1886c22b68e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f3a5400>]}
[0m17:09:39.701801 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.17s]
[0m17:09:39.702602 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m17:09:39.703231 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 31 at position 8
  invalid identifier 'WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m17:09:39.704542 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:09:39.705115 [info ] [Thread-1 (]: 2 of 3 SKIP test not_null_fct_leads_provider_id ................................ [[33mSKIP[0m]
[0m17:09:39.705695 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:09:39.706135 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:09:39.706533 [debug] [Thread-4 (]: Marking all children of 'test.snowflake.not_null_fct_leads_provider_id.bc48999026' to be skipped because of status 'skipped'. 
[0m17:09:39.706977 [info ] [Thread-1 (]: 3 of 3 SKIP test unique_fct_leads_provider_id .................................. [[33mSKIP[0m]
[0m17:09:39.707789 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:09:39.708281 [debug] [Thread-4 (]: Marking all children of 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' to be skipped because of status 'skipped'. 
[0m17:09:39.709597 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:39.710007 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m17:09:39.710368 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m17:09:39.812091 [info ] [MainThread]: 
[0m17:09:39.812813 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 1.19 seconds (1.19s).
[0m17:09:39.814363 [debug] [MainThread]: Command end result
[0m17:09:39.840176 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:09:39.842715 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:09:39.850533 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:09:39.851125 [info ] [MainThread]: 
[0m17:09:39.851675 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:09:39.852177 [info ] [MainThread]: 
[0m17:09:39.852716 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 31 at position 8
  invalid identifier 'WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m17:09:39.853176 [info ] [MainThread]: 
[0m17:09:39.853754 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m17:09:39.855210 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 3.118313, "process_in_blocks": "0", "process_kernel_time": 0.409367, "process_mem_max_rss": "136163328", "process_out_blocks": "0", "process_user_time": 3.29995}
[0m17:09:39.856198 [debug] [MainThread]: Command `dbt build` failed at 17:09:39.856024 after 3.12 seconds
[0m17:09:39.856849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fa349e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a3440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e0a33b0>]}
[0m17:09:39.857461 [debug] [MainThread]: Flushing usage events
[0m17:09:40.064043 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:09:51.156942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107480770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108680fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086cf0e0>]}


============================== 17:09:51.162351 | 37fba7cc-d139-4e44-b36f-638bc0483cac ==============================
[0m17:09:51.162351 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:09:51.163204 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:09:51.554984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '37fba7cc-d139-4e44-b36f-638bc0483cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1097e8ad0>]}
[0m17:09:51.633795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '37fba7cc-d139-4e44-b36f-638bc0483cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e078f0>]}
[0m17:09:51.634879 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:09:51.838665 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:09:51.988624 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:09:51.989669 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/analytics.yml
[0m17:09:51.990153 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m17:09:52.491942 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m17:09:52.509692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '37fba7cc-d139-4e44-b36f-638bc0483cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109def5f0>]}
[0m17:09:52.605769 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:09:52.609156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:09:52.640700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '37fba7cc-d139-4e44-b36f-638bc0483cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bd80b0>]}
[0m17:09:52.641338 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m17:09:52.643445 [info ] [MainThread]: 
[0m17:09:52.643975 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:09:52.644428 [info ] [MainThread]: 
[0m17:09:52.645111 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:09:52.646113 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:09:52.795332 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:09:52.795850 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:09:52.796249 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:53.235787 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.439 seconds
[0m17:09:53.238629 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:09:53.250103 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:09:53.250545 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:09:53.363918 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.113 seconds
[0m17:09:53.367580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '37fba7cc-d139-4e44-b36f-638bc0483cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109ef0e90>]}
[0m17:09:53.368932 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m17:09:53.369482 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m17:09:53.370085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m17:09:53.370492 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m17:09:53.381433 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m17:09:53.382348 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m17:09:53.422449 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m17:09:53.427449 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m17:09:53.428082 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website_address,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m17:09:53.522573 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b9302d-0002-42a0-0007-02f20001c032
[0m17:09:53.523286 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 129 at position 4
invalid identifier 'LEADS.WEBSITE_ADDRESS'
[0m17:09:53.526689 [debug] [Thread-1 (]: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 129 at position 4
  invalid identifier 'LEADS.WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m17:09:53.528526 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '37fba7cc-d139-4e44-b36f-638bc0483cac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b11310>]}
[0m17:09:53.529234 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model STG.fct_leads ............................ [[31mERROR[0m in 0.16s]
[0m17:09:53.530021 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m17:09:53.530638 [debug] [Thread-4 (]: Marking all children of 'model.snowflake.fct_leads' to be skipped because of status 'error'.  Reason: Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 129 at position 4
  invalid identifier 'LEADS.WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql.
[0m17:09:53.531749 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:09:53.532248 [info ] [Thread-1 (]: 2 of 3 SKIP test not_null_fct_leads_provider_id ................................ [[33mSKIP[0m]
[0m17:09:53.532900 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:09:53.533341 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:09:53.533771 [debug] [Thread-4 (]: Marking all children of 'test.snowflake.not_null_fct_leads_provider_id.bc48999026' to be skipped because of status 'skipped'. 
[0m17:09:53.534389 [info ] [Thread-1 (]: 3 of 3 SKIP test unique_fct_leads_provider_id .................................. [[33mSKIP[0m]
[0m17:09:53.535177 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:09:53.535774 [debug] [Thread-4 (]: Marking all children of 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' to be skipped because of status 'skipped'. 
[0m17:09:53.537318 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:53.537795 [debug] [MainThread]: Connection 'model.snowflake.fct_leads' was left open.
[0m17:09:53.538245 [debug] [MainThread]: On model.snowflake.fct_leads: Close
[0m17:09:53.650427 [info ] [MainThread]: 
[0m17:09:53.651060 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 1.01 seconds (1.01s).
[0m17:09:53.652060 [debug] [MainThread]: Command end result
[0m17:09:53.678088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:09:53.680122 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:09:53.687126 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:09:53.687550 [info ] [MainThread]: 
[0m17:09:53.688053 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:09:53.688543 [info ] [MainThread]: 
[0m17:09:53.689108 [error] [MainThread]:   Database Error in model fct_leads (models/Analytics/fct_leads.sql)
  000904 (42000): SQL compilation error: error line 129 at position 4
  invalid identifier 'LEADS.WEBSITE_ADDRESS'
  compiled code at target/run/snowflake/models/Analytics/fct_leads.sql
[0m17:09:53.689569 [info ] [MainThread]: 
[0m17:09:53.690098 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m17:09:53.691308 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": false, "command_wall_clock_time": 2.6622393, "process_in_blocks": "0", "process_kernel_time": 0.39292, "process_mem_max_rss": "136126464", "process_out_blocks": "0", "process_user_time": 3.159244}
[0m17:09:53.691939 [debug] [MainThread]: Command `dbt build` failed at 17:09:53.691814 after 2.66 seconds
[0m17:09:53.692544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107760650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109e9c200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108680e60>]}
[0m17:09:53.693086 [debug] [MainThread]: Flushing usage events
[0m17:09:53.893184 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:10:12.111592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079daab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a036e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a03470>]}


============================== 17:10:12.116582 | f982e284-8e42-43a2-8ca7-6998d13c3603 ==============================
[0m17:10:12.116582 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:10:12.117342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:10:12.586185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f982e284-8e42-43a2-8ca7-6998d13c3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cc5d00>]}
[0m17:10:12.658097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f982e284-8e42-43a2-8ca7-6998d13c3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108864ad0>]}
[0m17:10:12.659098 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m17:10:12.861092 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:10:13.003350 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:10:13.004121 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m17:10:13.493696 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m17:10:13.511422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f982e284-8e42-43a2-8ca7-6998d13c3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10911e2a0>]}
[0m17:10:13.606567 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:10:13.610029 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:10:13.640344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f982e284-8e42-43a2-8ca7-6998d13c3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109367140>]}
[0m17:10:13.640937 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m17:10:13.643369 [info ] [MainThread]: 
[0m17:10:13.643892 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:10:13.644344 [info ] [MainThread]: 
[0m17:10:13.645044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:10:13.646016 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m17:10:13.789063 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m17:10:13.789580 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m17:10:13.789977 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:10:14.261998 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.472 seconds
[0m17:10:14.264604 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m17:10:14.275915 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m17:10:14.276342 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m17:10:14.349883 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.073 seconds
[0m17:10:14.353464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f982e284-8e42-43a2-8ca7-6998d13c3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091ee5a0>]}
[0m17:10:14.354811 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m17:10:14.355369 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m17:10:14.355951 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m17:10:14.356363 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m17:10:14.367663 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m17:10:14.368613 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m17:10:14.407442 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m17:10:14.412313 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m17:10:14.412942 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m17:10:15.366069 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.953 seconds
[0m17:10:15.396644 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f982e284-8e42-43a2-8ca7-6998d13c3603', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e39550>]}
[0m17:10:15.397372 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.04s]
[0m17:10:15.398174 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m17:10:15.399131 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:10:15.399627 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m17:10:15.400221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m17:10:15.400635 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:10:15.415421 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m17:10:15.416319 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:10:15.437068 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m17:10:15.438428 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m17:10:15.438872 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m17:10:15.674802 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.235 seconds
[0m17:10:15.679162 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 0.28s]
[0m17:10:15.679965 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m17:10:15.680429 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:10:15.680924 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m17:10:15.681512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m17:10:15.681926 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:10:15.689463 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m17:10:15.690387 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:10:15.695353 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m17:10:15.696783 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m17:10:15.697226 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:10:15.902783 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.205 seconds
[0m17:10:15.905219 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.22s]
[0m17:10:15.906065 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m17:10:15.907481 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:10:15.907834 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m17:10:15.908193 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m17:10:16.015133 [info ] [MainThread]: 
[0m17:10:16.015691 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 2.37 seconds (2.37s).
[0m17:10:16.017053 [debug] [MainThread]: Command end result
[0m17:10:16.043061 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m17:10:16.045808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m17:10:16.052574 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m17:10:16.053085 [info ] [MainThread]: 
[0m17:10:16.053718 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:10:16.054209 [info ] [MainThread]: 
[0m17:10:16.054712 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:10:16.055991 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.087158, "process_in_blocks": "0", "process_kernel_time": 0.377727, "process_mem_max_rss": "136441856", "process_out_blocks": "0", "process_user_time": 3.191521}
[0m17:10:16.056641 [debug] [MainThread]: Command `dbt build` succeeded at 17:10:16.056513 after 4.09 seconds
[0m17:10:16.057099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1091905c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a035f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a03710>]}
[0m17:10:16.057537 [debug] [MainThread]: Flushing usage events
[0m17:10:16.242136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:02:36.690656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f34b170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd3b5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd3b320>]}


============================== 00:02:36.770637 | 685b203e-82ed-4476-90c2-40ddd960da10 ==============================
[0m00:02:36.770637 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:02:36.771587 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'profiles_dir': '/Users/rahulpatil/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:02:37.709658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '685b203e-82ed-4476-90c2-40ddd960da10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e008ec0>]}
[0m00:02:37.781410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '685b203e-82ed-4476-90c2-40ddd960da10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f244d0>]}
[0m00:02:37.782688 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m00:02:38.044995 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:02:38.336845 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:02:38.337828 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/analytics.yml
[0m00:02:38.848739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m00:02:38.865920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '685b203e-82ed-4476-90c2-40ddd960da10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1116a7530>]}
[0m00:02:38.960094 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:02:38.972145 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:02:39.070820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '685b203e-82ed-4476-90c2-40ddd960da10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111220c50>]}
[0m00:02:39.071412 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m00:02:39.073469 [info ] [MainThread]: 
[0m00:02:39.073997 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:02:39.074435 [info ] [MainThread]: 
[0m00:02:39.075100 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:02:39.076056 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m00:02:39.302153 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m00:02:39.302641 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m00:02:39.302997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:02:40.713087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.410 seconds
[0m00:02:40.715776 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m00:02:40.728247 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m00:02:40.728739 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m00:02:40.890479 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.161 seconds
[0m00:02:40.894645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685b203e-82ed-4476-90c2-40ddd960da10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1114168a0>]}
[0m00:02:40.896521 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m00:02:40.897185 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m00:02:40.897842 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m00:02:40.898256 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m00:02:40.912527 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m00:02:41.020299 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m00:02:41.056185 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m00:02:41.060962 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m00:02:41.061588 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m00:02:43.507976 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.446 seconds
[0m00:02:43.552359 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '685b203e-82ed-4476-90c2-40ddd960da10', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfdfe30>]}
[0m00:02:43.553330 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 2.64s]
[0m00:02:43.554130 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m00:02:43.555120 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:02:43.555606 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m00:02:43.556222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m00:02:43.556636 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:02:43.572519 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:02:43.573779 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:02:43.593784 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:02:43.595013 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:02:43.595450 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m00:02:45.032812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.437 seconds
[0m00:02:45.037206 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 1.48s]
[0m00:02:45.038020 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:02:45.038483 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:02:45.038974 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m00:02:45.039565 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m00:02:45.039977 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:02:45.047868 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:02:45.048788 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:02:45.052330 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:02:45.053611 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:02:45.054043 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:02:46.565614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.511 seconds
[0m00:02:46.568052 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 1.53s]
[0m00:02:46.568840 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:02:46.570173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:02:46.570517 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m00:02:46.570872 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m00:02:46.675712 [info ] [MainThread]: 
[0m00:02:46.676313 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 7.60 seconds (7.60s).
[0m00:02:46.677639 [debug] [MainThread]: Command end result
[0m00:02:46.703402 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:02:46.705659 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:02:46.712366 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m00:02:46.712753 [info ] [MainThread]: 
[0m00:02:46.713275 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:02:46.713805 [info ] [MainThread]: 
[0m00:02:46.714286 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:02:46.738876 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 10.380395, "process_in_blocks": "0", "process_kernel_time": 0.630149, "process_mem_max_rss": "137031680", "process_out_blocks": "0", "process_user_time": 3.646756}
[0m00:02:46.739735 [debug] [MainThread]: Command `dbt build` succeeded at 00:02:46.739590 after 10.38 seconds
[0m00:02:46.740193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11142a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127465a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127468a0>]}
[0m00:02:46.740625 [debug] [MainThread]: Flushing usage events
[0m00:02:47.009721 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:06.595785 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c313680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c3133e0>]}


============================== 00:06:06.602114 | ef605419-d66f-4732-a2ee-df4e13eed117 ==============================
[0m00:06:06.602114 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:06:06.602846 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:06:07.016612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ef605419-d66f-4732-a2ee-df4e13eed117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d1ddbe0>]}
[0m00:06:07.091684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ef605419-d66f-4732-a2ee-df4e13eed117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3348f0>]}
[0m00:06:07.092765 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m00:06:07.293271 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:06:07.448775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:06:07.449280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:06:07.455520 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m00:06:07.508018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ef605419-d66f-4732-a2ee-df4e13eed117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d513980>]}
[0m00:06:07.604946 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:06:07.608286 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:06:07.640459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ef605419-d66f-4732-a2ee-df4e13eed117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d9e2ff0>]}
[0m00:06:07.641088 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m00:06:07.643233 [info ] [MainThread]: 
[0m00:06:07.643775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:07.644251 [info ] [MainThread]: 
[0m00:06:07.644970 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:07.645991 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m00:06:07.715192 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m00:06:07.715734 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m00:06:07.716158 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:08.284393 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.568 seconds
[0m00:06:08.287090 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m00:06:08.299663 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m00:06:08.300193 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m00:06:08.410043 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.109 seconds
[0m00:06:08.413852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ef605419-d66f-4732-a2ee-df4e13eed117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e93ce30>]}
[0m00:06:08.415487 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m00:06:08.416168 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m00:06:08.416820 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m00:06:08.417237 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m00:06:08.429183 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m00:06:08.430092 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m00:06:08.469532 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m00:06:08.475958 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m00:06:08.476668 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m00:06:09.760901 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.284 seconds
[0m00:06:09.795987 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ef605419-d66f-4732-a2ee-df4e13eed117', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b749460>]}
[0m00:06:09.797099 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.38s]
[0m00:06:09.797933 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m00:06:09.798956 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:09.799442 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m00:06:09.800045 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m00:06:09.800461 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:09.816555 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:06:09.818215 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:09.839137 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:06:09.840441 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:06:09.840959 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m00:06:11.370854 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.529 seconds
[0m00:06:11.376134 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 1.58s]
[0m00:06:11.377430 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:11.378564 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:11.379168 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m00:06:11.379904 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m00:06:11.380785 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:11.389375 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:06:11.390286 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:11.393789 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:06:11.395311 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:06:11.395927 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:06:11.625251 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.229 seconds
[0m00:06:11.628326 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.25s]
[0m00:06:11.629325 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:11.630812 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:11.631202 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m00:06:11.631581 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m00:06:11.733809 [info ] [MainThread]: 
[0m00:06:11.734449 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 4.09 seconds (4.09s).
[0m00:06:11.735771 [debug] [MainThread]: Command end result
[0m00:06:11.839471 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:06:11.841269 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:06:11.848063 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m00:06:11.848464 [info ] [MainThread]: 
[0m00:06:11.848969 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:11.849499 [info ] [MainThread]: 
[0m00:06:11.850024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:06:11.851317 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 5.3974943, "process_in_blocks": "0", "process_kernel_time": 0.403042, "process_mem_max_rss": "133124096", "process_out_blocks": "0", "process_user_time": 2.88288}
[0m00:06:11.851954 [debug] [MainThread]: Command `dbt build` succeeded at 00:06:11.851829 after 5.40 seconds
[0m00:06:11.852433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a4a7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10afb0b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9e95b0>]}
[0m00:06:11.852863 [debug] [MainThread]: Flushing usage events
[0m00:06:12.059675 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:26.617663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fd04bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110453500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110453290>]}


============================== 00:06:26.623335 | 09d31a5b-f918-42a1-8146-7468c7d7e7e5 ==============================
[0m00:06:26.623335 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:06:26.624112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:06:27.151031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '09d31a5b-f918-42a1-8146-7468c7d7e7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c9ecc0>]}
[0m00:06:27.234710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '09d31a5b-f918-42a1-8146-7468c7d7e7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff773e0>]}
[0m00:06:27.236060 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m00:06:27.435858 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:06:27.591549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:06:27.592430 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/fct_leads.sql
[0m00:06:28.134709 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m00:06:28.151222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '09d31a5b-f918-42a1-8146-7468c7d7e7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f8b800>]}
[0m00:06:28.258554 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:06:28.261760 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:06:28.291934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '09d31a5b-f918-42a1-8146-7468c7d7e7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111f40290>]}
[0m00:06:28.292532 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m00:06:28.294594 [info ] [MainThread]: 
[0m00:06:28.295134 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:28.295583 [info ] [MainThread]: 
[0m00:06:28.296258 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:06:28.297231 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m00:06:28.444514 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m00:06:28.445006 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m00:06:28.445363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:28.953079 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.508 seconds
[0m00:06:28.956574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m00:06:28.969963 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m00:06:28.970469 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m00:06:29.150604 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.180 seconds
[0m00:06:29.154223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '09d31a5b-f918-42a1-8146-7468c7d7e7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104059a0>]}
[0m00:06:29.155568 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m00:06:29.156121 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m00:06:29.156890 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m00:06:29.157686 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m00:06:29.168991 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m00:06:29.169976 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m00:06:29.209775 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m00:06:29.214784 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m00:06:29.215574 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m00:06:30.103593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.887 seconds
[0m00:06:30.138177 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '09d31a5b-f918-42a1-8146-7468c7d7e7e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f88d550>]}
[0m00:06:30.139197 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.98s]
[0m00:06:30.140141 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m00:06:30.141610 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:30.142126 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m00:06:30.142796 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m00:06:30.143223 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:30.158028 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:06:30.159014 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:30.179839 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:06:30.181208 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:06:30.181670 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m00:06:30.371897 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m00:06:30.376236 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 0.23s]
[0m00:06:30.377066 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:06:30.377540 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:30.378040 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m00:06:30.378634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m00:06:30.379055 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:30.386954 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:06:30.388487 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:30.392287 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:06:30.394177 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:06:30.394749 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:06:30.583921 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.189 seconds
[0m00:06:30.586336 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.21s]
[0m00:06:30.587176 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:06:30.588487 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:30.588837 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m00:06:30.589198 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m00:06:30.709298 [info ] [MainThread]: 
[0m00:06:30.709923 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 2.41 seconds (2.41s).
[0m00:06:30.711254 [debug] [MainThread]: Command end result
[0m00:06:30.737678 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:06:30.739749 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:06:30.746441 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m00:06:30.746862 [info ] [MainThread]: 
[0m00:06:30.747383 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:06:30.747868 [info ] [MainThread]: 
[0m00:06:30.748475 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:06:30.749782 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.269151, "process_in_blocks": "0", "process_kernel_time": 0.407217, "process_mem_max_rss": "135020544", "process_out_blocks": "0", "process_user_time": 3.423596}
[0m00:06:30.750459 [debug] [MainThread]: Command `dbt build` succeeded at 00:06:30.750333 after 4.27 seconds
[0m00:06:30.750913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108c27b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d8d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f88ffe0>]}
[0m00:06:30.751334 [debug] [MainThread]: Flushing usage events
[0m00:06:30.935964 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:10:15.767008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd987d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efdf500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efdf290>]}


============================== 00:10:15.773620 | 5e3b9222-bbba-4fab-a894-fc73fb692126 ==============================
[0m00:10:15.773620 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:10:15.774483 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/rahulpatil/.dbt', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select fct_leads', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:10:16.171607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e3b9222-bbba-4fab-a894-fc73fb692126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efdf290>]}
[0m00:10:16.248366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e3b9222-bbba-4fab-a894-fc73fb692126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f22fce0>]}
[0m00:10:16.249415 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m00:10:16.439558 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:10:16.589805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:10:16.590916 [debug] [MainThread]: Partial parsing: updated file: snowflake://models/Analytics/analytics.yml
[0m00:10:17.134640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m00:10:17.151909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e3b9222-bbba-4fab-a894-fc73fb692126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1109782c0>]}
[0m00:10:17.257040 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:10:17.260643 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:10:17.293021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e3b9222-bbba-4fab-a894-fc73fb692126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a7ecf0>]}
[0m00:10:17.293639 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m00:10:17.295752 [info ] [MainThread]: 
[0m00:10:17.296330 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:10:17.296865 [info ] [MainThread]: 
[0m00:10:17.297647 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:10:17.298812 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m00:10:17.447602 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m00:10:17.448089 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m00:10:17.448452 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:10:17.976154 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.528 seconds
[0m00:10:17.978880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m00:10:17.991589 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m00:10:17.992084 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m00:10:18.094165 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.102 seconds
[0m00:10:18.097880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e3b9222-bbba-4fab-a894-fc73fb692126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a67110>]}
[0m00:10:18.099530 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m00:10:18.100164 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m00:10:18.100782 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m00:10:18.101196 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m00:10:18.112988 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m00:10:18.114112 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m00:10:18.154814 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m00:10:18.160386 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m00:10:18.161088 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m00:10:19.546474 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.385 seconds
[0m00:10:19.579852 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e3b9222-bbba-4fab-a894-fc73fb692126', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4254f0>]}
[0m00:10:19.580677 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 1.48s]
[0m00:10:19.581506 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m00:10:19.582583 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:10:19.583113 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m00:10:19.583744 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m00:10:19.584160 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:10:19.601694 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:10:19.602860 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:10:19.627973 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:10:19.629390 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:10:19.629861 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m00:10:19.790122 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.160 seconds
[0m00:10:19.794737 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 0.21s]
[0m00:10:19.795687 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:10:19.796176 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:10:19.796716 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m00:10:19.797331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m00:10:19.797745 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:10:19.805820 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:10:19.809441 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:10:19.812587 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:10:19.813853 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:10:19.814290 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:10:19.978773 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m00:10:19.981167 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.18s]
[0m00:10:19.981980 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:10:19.983438 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:10:19.983797 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m00:10:19.984155 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m00:10:20.092547 [info ] [MainThread]: 
[0m00:10:20.093187 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 2.80 seconds (2.80s).
[0m00:10:20.094486 [debug] [MainThread]: Command end result
[0m00:10:20.121143 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:10:20.123324 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:10:20.130637 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m00:10:20.131115 [info ] [MainThread]: 
[0m00:10:20.131640 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:10:20.132132 [info ] [MainThread]: 
[0m00:10:20.132636 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:10:20.134057 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 4.50982, "process_in_blocks": "0", "process_kernel_time": 0.399403, "process_mem_max_rss": "134627328", "process_out_blocks": "0", "process_user_time": 3.377142}
[0m00:10:20.134898 [debug] [MainThread]: Command `dbt build` succeeded at 00:10:20.134751 after 4.51 seconds
[0m00:10:20.135401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10efdf320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dbb3fe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a67830>]}
[0m00:10:20.135845 [debug] [MainThread]: Flushing usage events
[0m00:10:20.338978 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:29:07.593183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c8ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c41b680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c41b3e0>]}


============================== 00:29:07.616656 | 01036c66-3c12-4961-8ae5-07af1087db4a ==============================
[0m00:29:07.616656 [info ] [MainThread]: Running with dbt=1.9.1
[0m00:29:07.617626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/logs', 'version_check': 'True', 'profiles_dir': '/Users/rahulpatil/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select fct_leads', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m00:29:08.092357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01036c66-3c12-4961-8ae5-07af1087db4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6e4e00>]}
[0m00:29:08.168375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01036c66-3c12-4961-8ae5-07af1087db4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c492390>]}
[0m00:29:08.169690 [info ] [MainThread]: Registered adapter: snowflake=1.9.0
[0m00:29:08.369399 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m00:29:08.528925 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:29:08.529404 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:29:08.535322 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.snowflake.example
[0m00:29:08.589084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01036c66-3c12-4961-8ae5-07af1087db4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d61fe00>]}
[0m00:29:08.683354 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:29:08.686625 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:29:08.716655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01036c66-3c12-4961-8ae5-07af1087db4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da9f8f0>]}
[0m00:29:08.717278 [info ] [MainThread]: Found 1 model, 2 data tests, 4 sources, 468 macros
[0m00:29:08.719348 [info ] [MainThread]: 
[0m00:29:08.719853 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:29:08.720295 [info ] [MainThread]: 
[0m00:29:08.720975 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m00:29:08.721978 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_DBT_TEST'
[0m00:29:08.789486 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST"
[0m00:29:08.789969 [debug] [ThreadPool]: On list_DBT_TEST: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST"} */
show terse schemas in database DBT_TEST
    limit 10000
[0m00:29:08.790328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:29:09.399113 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.609 seconds
[0m00:29:09.401768 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_DBT_TEST, now list_DBT_TEST_STG)
[0m00:29:09.413103 [debug] [ThreadPool]: Using snowflake connection "list_DBT_TEST_STG"
[0m00:29:09.413512 [debug] [ThreadPool]: On list_DBT_TEST_STG: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "connection_name": "list_DBT_TEST_STG"} */
show objects in DBT_TEST.STG limit 10000;
[0m00:29:09.524008 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.110 seconds
[0m00:29:09.527697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01036c66-3c12-4961-8ae5-07af1087db4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eaf4dd0>]}
[0m00:29:09.529073 [debug] [Thread-1 (]: Began running node model.snowflake.fct_leads
[0m00:29:09.529634 [info ] [Thread-1 (]: 1 of 3 START sql table model STG.fct_leads ..................................... [RUN]
[0m00:29:09.530234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_DBT_TEST_STG, now model.snowflake.fct_leads)
[0m00:29:09.530645 [debug] [Thread-1 (]: Began compiling node model.snowflake.fct_leads
[0m00:29:09.542093 [debug] [Thread-1 (]: Writing injected SQL for node "model.snowflake.fct_leads"
[0m00:29:09.543914 [debug] [Thread-1 (]: Began executing node model.snowflake.fct_leads
[0m00:29:09.582024 [debug] [Thread-1 (]: Writing runtime sql for node "model.snowflake.fct_leads"
[0m00:29:09.586695 [debug] [Thread-1 (]: Using snowflake connection "model.snowflake.fct_leads"
[0m00:29:09.587266 [debug] [Thread-1 (]: On model.snowflake.fct_leads: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "model.snowflake.fct_leads"} */
create or replace transient table DBT_TEST.STG.fct_leads
         as
        (

WITH leads AS (
    SELECT
        id AS provider_id,
        first_name,
        last_name,
        company,
        street AS address1,
        city,
        state,
        postal_code AS zip,
        country,
        email,
        CASE 
            WHEN Is_converted IN ('true', '1', 'yes', 'Y') THEN TRUE
            ELSE FALSE
        END AS is_converted,
        Status, 
        TO_TIMESTAMP(created_date, 'MM/DD/YY HH24:MI') as created_date,
        TO_TIMESTAMP(last_modified_date , 'MM/DD/YY HH24:MI')as last_modified_date,
        last_activity_date,
        last_viewed_date, 
        capacity_c,
        lead_source,
        title,
        outreach_stage_c AS curriculum_type,
        lead_source_last_updated_c AS certificate_expiration_date,
        website,
        brightwheel_school_uuid_c
    FROM "DBT_TEST".stg.stg_salesforce_leads
     WHERE country NOT LIKE '[0-9]%' -- Exclude invalid country values with numbers
),

source_s1 AS (
    SELECT
        Name AS company,
        ADDRESS AS address2,
         state,
         county,
         phone
    FROM "DBT_TEST".stg.stg_source_s1
     WHERE Name IS NOT NULL -- Validate non-null company names
),

source_s2 AS (
    SELECT
        Company AS company,
        TYPELICENSE AS license_number,
        'Accepts Subsidy' AS accepts_financial_aid,
        'Year Round' AS schedule,
        'Star Level' AS facility_type,
        'Total Cap' AS capacity,
        'Monitoring since' AS license_issued,
        'Monitoring since' AS license_renewed,
        'Daytime Hours' AS operating_hours,
        'Star Level' AS star_rating,
        'Min Age' AS min_age,
        'Max Age' AS max_age,
        'Monitoring since' AS compliance_monitoring_date
    FROM "DBT_TEST".stg.stg_source_s2
    WHERE Company IS NOT NULL -- Validate non-null operation IDs
    AND TRY_CAST(capacity AS INT) IS NOT NULL -- Exclude rows where capacity contains non-numeric values
),

source_s3 AS (
    SELECT  
        Operation AS operator,
        'Operation Name' AS company,
        Address AS address1,
        City AS city,
        State AS state,
        Zip AS zip,
        Phone AS phone,
        Capacity AS capacity,
        Status AS license_status,
        IssueDate AS license_issued_date,
        Monitoringfrequency AS compliance_frequency,
        'Audit Date' AS audit_date,
        'Audit Notes' AS audit_notes
    FROM "DBT_TEST".stg.stg_source_s3
    WHERE Operation IS NOT NULL -- Validate non-null operation IDs
)

-- Final Join and Transformation
SELECT
    leads.provider_id,
    leads.first_name,
    leads.last_name,
    leads.company,
    leads.address1,
    source_s1.address2,
    leads.city,
    leads.state,
    leads.zip,
    source_s1.county,
    leads.country,
    leads.email,
    leads.is_converted,
    leads.Status, 
    leads.created_date, 
    leads.last_modified_date, 
    leads.last_activity_date,
    leads.last_viewed_date, 
    leads.capacity_c,
    leads.lead_source,
    leads.curriculum_type,
    source_s2.capacity,
    source_s2.accepts_financial_aid,
    source_s2.schedule,
    source_s3.phone,
    source_s3.operator,
    source_s3.license_status,
    source_s2.license_number,
    source_s2.license_issued,
    source_s2.license_renewed,
    source_s3.license_issued_date,
    source_s3.compliance_frequency,
    source_s2.operating_hours,
    source_s2.star_rating,
    source_s2.compliance_monitoring_date,
    source_s2.facility_type,
    source_s2.min_age,
    source_s2.max_age,
    source_s3.audit_date,
    source_s3.audit_notes,
    leads.certificate_expiration_date,
    leads.website,
    leads.brightwheel_school_uuid_c
FROM leads
LEFT JOIN source_s1
    ON leads.company = source_s1.company
LEFT JOIN source_s2
    ON leads.company = source_s2.company
LEFT JOIN source_s3
    ON leads.company = source_s3.company
WHERE leads.provider_id IS NOT NULL -- Final validation to exclude rows with null provider IDs
        );
[0m00:29:10.452244 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.864 seconds
[0m00:29:10.482369 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01036c66-3c12-4961-8ae5-07af1087db4a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b851670>]}
[0m00:29:10.483103 [info ] [Thread-1 (]: 1 of 3 OK created sql table model STG.fct_leads ................................ [[32mSUCCESS 1[0m in 0.95s]
[0m00:29:10.483900 [debug] [Thread-1 (]: Finished running node model.snowflake.fct_leads
[0m00:29:10.484803 [debug] [Thread-1 (]: Began running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:29:10.485288 [info ] [Thread-1 (]: 2 of 3 START test not_null_fct_leads_provider_id ............................... [RUN]
[0m00:29:10.485950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.snowflake.fct_leads, now test.snowflake.not_null_fct_leads_provider_id.bc48999026)
[0m00:29:10.486505 [debug] [Thread-1 (]: Began compiling node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:29:10.502680 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:29:10.503564 [debug] [Thread-1 (]: Began executing node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:29:10.522870 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:29:10.524091 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.not_null_fct_leads_provider_id.bc48999026"
[0m00:29:10.524535 [debug] [Thread-1 (]: On test.snowflake.not_null_fct_leads_provider_id.bc48999026: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.not_null_fct_leads_provider_id.bc48999026"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select provider_id
from DBT_TEST.STG.fct_leads
where provider_id is null



      
    ) dbt_internal_test
[0m00:29:10.691177 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.166 seconds
[0m00:29:10.696423 [info ] [Thread-1 (]: 2 of 3 PASS not_null_fct_leads_provider_id ..................................... [[32mPASS[0m in 0.21s]
[0m00:29:10.697269 [debug] [Thread-1 (]: Finished running node test.snowflake.not_null_fct_leads_provider_id.bc48999026
[0m00:29:10.697771 [debug] [Thread-1 (]: Began running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:29:10.698219 [info ] [Thread-1 (]: 3 of 3 START test unique_fct_leads_provider_id ................................. [RUN]
[0m00:29:10.698798 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.snowflake.not_null_fct_leads_provider_id.bc48999026, now test.snowflake.unique_fct_leads_provider_id.056bcaf6cd)
[0m00:29:10.699364 [debug] [Thread-1 (]: Began compiling node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:29:10.726937 [debug] [Thread-1 (]: Writing injected SQL for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:29:10.728001 [debug] [Thread-1 (]: Began executing node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:29:10.731281 [debug] [Thread-1 (]: Writing runtime sql for node "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:29:10.732825 [debug] [Thread-1 (]: Using snowflake connection "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"
[0m00:29:10.733350 [debug] [Thread-1 (]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "snowflake", "target_name": "dev", "node_id": "test.snowflake.unique_fct_leads_provider_id.056bcaf6cd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    provider_id as unique_field,
    count(*) as n_records

from DBT_TEST.STG.fct_leads
where provider_id is not null
group by provider_id
having count(*) > 1



      
    ) dbt_internal_test
[0m00:29:10.897361 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.163 seconds
[0m00:29:10.913351 [info ] [Thread-1 (]: 3 of 3 PASS unique_fct_leads_provider_id ....................................... [[32mPASS[0m in 0.21s]
[0m00:29:10.914367 [debug] [Thread-1 (]: Finished running node test.snowflake.unique_fct_leads_provider_id.056bcaf6cd
[0m00:29:10.915711 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:29:10.916116 [debug] [MainThread]: Connection 'test.snowflake.unique_fct_leads_provider_id.056bcaf6cd' was left open.
[0m00:29:10.916508 [debug] [MainThread]: On test.snowflake.unique_fct_leads_provider_id.056bcaf6cd: Close
[0m00:29:11.023029 [info ] [MainThread]: 
[0m00:29:11.023679 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 2.30 seconds (2.30s).
[0m00:29:11.024978 [debug] [MainThread]: Command end result
[0m00:29:11.128700 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/manifest.json
[0m00:29:11.130909 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/semantic_manifest.json
[0m00:29:11.138251 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/rahulpatil/Rahul/Projects/dbt-env/snowflake/target/run_results.json
[0m00:29:11.138787 [info ] [MainThread]: 
[0m00:29:11.139280 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:29:11.139732 [info ] [MainThread]: 
[0m00:29:11.140192 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m00:29:11.176350 [debug] [MainThread]: Resource report: {"command_name": "build", "command_success": true, "command_wall_clock_time": 3.7418685, "process_in_blocks": "0", "process_kernel_time": 0.380315, "process_mem_max_rss": "133054464", "process_out_blocks": "0", "process_user_time": 2.73749}
[0m00:29:11.177127 [debug] [MainThread]: Command `dbt build` succeeded at 00:29:11.177000 after 3.74 seconds
[0m00:29:11.177629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be97230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10df9a6c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1c8ad0>]}
[0m00:29:11.178058 [debug] [MainThread]: Flushing usage events
[0m00:29:11.379907 [debug] [MainThread]: An error was encountered while trying to flush usage events
